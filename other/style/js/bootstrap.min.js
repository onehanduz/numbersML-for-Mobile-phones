/*!
  * Bootstrap v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@popperjs/core")):"function"==typeof define&&define.amd?define(["@popperjs/core"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).bootstrap=e(t.Popper)}(this,(function(t){"use strict";function e(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t)for(const i in t)if("default"!==i){const s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>t[i]})}return e.default=t,Object.freeze(e)}const i=e(t),s=new Map,n={set(t,e,i){s.has(t)||s.set(t,new Map);const n=s.get(t);n.has(e)||0===n.size?n.set(e,i):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`)},get:(t,e)=>s.has(t)&&s.get(t).get(e)||null,remove(t,e){if(!s.has(t))return;const i=s.get(t);i.delete(e),0===i.size&&s.delete(t)}},o="transitionend",r=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,((t,e)=>`#${CSS.escape(e)}`))),t),a=t=>{t.dispatchEvent(new Event(o))},l=t=>!(!t||"object"!=typeof t)&&(void 0!==t.jquery&&(t=t[0]),void 0!==t.nodeType),c=t=>l(t)?t.jquery?t[0]:t:"string"==typeof t&&t.length>0?document.querySelector(r(t)):null,h=t=>{if(!l(t)||0===t.getClientRects().length)return!1;const e="visible"===getComputedStyle(t).getPropertyValue("visibility"),i=t.closest("details:not([open])");if(!i)return e;if(i!==t){const e=t.closest("summary");if(e&&e.parentNode!==i)return!1;if(null===e)return!1}return e},d=t=>!t||t.nodeType!==Node.ELEMENT_NODE||!!t.classList.contains("disabled")||(void 0!==t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled")),u=t=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?u(t.parentNode):null},_=()=>{},g=t=>{t.offsetHeight},f=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,m=[],p=()=>"rtl"===document.documentElement.dir,b=t=>{var e;e=()=>{const e=f();if(e){const i=t.NAME,s=e.fn[i];e.fn[i]=t.jQueryInterface,e.fn[i].Constructor=t,e.fn[i].noConflict=()=>(e.fn[i]=s,t.jQueryInterface)}},"loading"===document.readyState?(m.length||document.addEventListener("DOMContentLoaded",(()=>{for(const t of m)t()})),m.push(e)):e()},v=(t,e=[],i=t)=>"function"==typeof t?t(...e):i,y=(t,e,i=!0)=>{if(!i)return void v(t);const s=(t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:i}=window.getComputedStyle(t);const s=Number.parseFloat(e),n=Number.parseFloat(i);return s||n?(e=e.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(i))):0})(e)+5;let n=!1;const r=({target:i})=>{i===e&&(n=!0,e.removeEventListener(o,r),v(t))};e.addEventListener(o,r),setTimeout((()=>{n||a(e)}),s)},w=(t,e,i,s)=>{const n=t.length;let o=t.indexOf(e);return-1===o?!i&&s?t[n-1]:t[0]:(o+=i?1:-1,s&&(o=(o+n)%n),t[Math.max(0,Math.min(o,n-1))])},A=/[^.]*(?=\..*)\.|.*/,E=/\..*/,C=/::\d+$/,T={};let k=1;const $={mouseenter:"mouseover",mouseleave:"mouseout"},S=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function L(t,e){return e&&`${e}::${k++}`||t.uidEvent||k++}function O(t){const e=L(t);return t.uidEvent=e,T[e]=T[e]||{},T[e]}function I(t,e,i=null){return Object.values(t).find((t=>t.callable===e&&t.delegationSelector===i))}function D(t,e,i){const s="string"==typeof e,n=s?i:e||i;let o=M(t);return S.has(o)||(o=t),[s,n,o]}function N(t,e,i,s,n){if("string"!=typeof e||!t)return;let[o,r,a]=D(e,i,s);if(e in $){const t=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};r=t(r)}const l=O(t),c=l[a]||(l[a]={}),h=I(c,r,o?i:null);if(h)return void(h.oneOff=h.oneOff&&n);const d=L(r,e.replace(A,"")),u=o?function(t,e,i){return function s(n){const o=t.querySelectorAll(e);for(let{target:r}=n;r&&r!==this;r=r.parentNode)for(const a of o)if(a===r)return F(n,{delegateTarget:r}),s.oneOff&&j.off(t,n.type,e,i),i.apply(r,[n])}}(t,i,r):function(t,e){return function i(s){return F(s,{delegateTarget:t}),i.oneOff&&j.off(t,s.type,e),e.apply(t,[s])}}(t,r);u.delegationSelector=o?i:null,u.callable=r,u.oneOff=n,u.uidEvent=d,c[d]=u,t.addEventListener(a,u,o)}function P(t,e,i,s,n){const o=I(e[i],s,n);o&&(t.removeEventListener(i,o,Boolean(n)),delete e[i][o.uidEvent])}function x(t,e,i,s){const n=e[i]||{};for(const[o,r]of Object.entries(n))o.includes(s)&&P(t,e,i,r.callable,r.delegationSelector)}function M(t){return t=t.replace(E,""),$[t]||t}const j={on(t,e,i,s){N(t,e,i,s,!1)},one(t,e,i,s){N(t,e,i,s,!0)},off(t,e,i,s){if("string"!=typeof e||!t)return;const[n,o,r]=D(e,i,s),a=r!==e,l=O(t),c=l[r]||{},h=e.startsWith(".");if(void 0===o){if(h)for(const i of Object.keys(l))x(t,l,i,e.slice(1));for(const[i,s]of Object.entries(c)){const n=i.replace(C,"");a&&!e.includes(n)||P(t,l,r,s.callable,s.delegationSelector)}}else{if(!Object.keys(c).length)return;P(t,l,r,o,n?i:null)}},trigger(t,e,i){if("string"!=typeof e||!t)return null;const s=f();let n=null,o=!0,r=!0,a=!1;e!==M(e)&&s&&(n=s.Event(e,i),s(t).trigger(n),o=!n.isPropagationStopped(),r=!n.isImmediatePropagationStopped(),a=n.isDefaultPrevented());const l=F(new Event(e,{bubbles:o,cancelable:!0}),i);return a&&l.preventDefault(),r&&t.dispatchEvent(l),l.defaultPrevented&&n&&n.preventDefault(),l}};function F(t,e={}){for(const[i,s]of Object.entries(e))try{t[i]=s}catch(e){Object.defineProperty(t,i,{configurable:!0,get:()=>s})}return t}function z(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(e){return t}}function H(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}const B={setDataAttribute(t,e,i){t.setAttribute(`data-bs-${H(e)}`,i)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${H(e)}`)},getDataAttributes(t){if(!t)return{};const e={},i=Object.keys(t.dataset).filter((t=>t.startsWith("bs")&&!t.startsWith("bsConfig")));for(const s of i){let i=s.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1,i.length),e[i]=z(t.dataset[s])}return e},getDataAttribute:(t,e)=>z(t.getAttribute(`data-bs-${H(e)}`))};class q{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const i=l(e)?B.getDataAttribute(e,"config"):{};return{...this.constructor.Default,..."object"==typeof i?i:{},...l(e)?B.getDataAttributes(e):{},..."object"==typeof t?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[s,n]of Object.entries(e)){const e=t[s],o=l(e)?"element":null==(i=e)?`${i}`:Object.prototype.toString.call(i).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(n).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${s}" provided type "${o}" but expected type "${n}".`)}var i}}class W extends q{constructor(t,e){super(),(t=c(t))&&(this._element=t,this._config=this._getConfig(e),n.set(this._element,this.constructor.DATA_KEY,this))}dispose(){n.remove(this._element,this.constructor.DATA_KEY),j.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,i=!0){y(t,e,i)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return n.get(c(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,"object"==typeof e?e:null)}static get VERSION(){return"5.3.2"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const R=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let i=t.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),e=i&&"#"!==i?r(i.trim()):null}return e},K={find:(t,e=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(e,t)),findOne:(t,e=document.documentElement)=>Element.prototype.querySelector.call(e,t),children:(t,e)=>[].concat(...t.children).filter((t=>t.matches(e))),parents(t,e){const i=[];let s=t.parentNode.closest(e);for(;s;)i.push(s),s=s.parentNode.closest(e);return i},prev(t,e){let i=t.previousElementSibling;for(;i;){if(i.matches(e))return[i];i=i.previousElementSibling}return[]},next(t,e){let i=t.nextElementSibling;for(;i;){if(i.matches(e))return[i];i=i.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((t=>`${t}:not([tabindex^="-"])`)).join(",");return this.find(e,t).filter((t=>!d(t)&&h(t)))},getSelectorFromElement(t){const e=R(t);return e&&K.findOne(e)?e:null},getElementFromSelector(t){const e=R(t);return e?K.findOne(e):null},getMultipleElementsFromSelector(t){const e=R(t);return e?K.find(e):[]}},V=(t,e="hide")=>{const i=`click.dismiss${t.EVENT_KEY}`,s=t.NAME;j.on(document,i,`[data-bs-dismiss="${s}"]`,(function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),d(this))return;const n=K.getElementFromSelector(this)||this.closest(`.${s}`);t.getOrCreateInstance(n)[e]()}))},Q=".bs.alert",X=`close${Q}`,Y=`closed${Q}`;class U extends W{static get NAME(){return"alert"}close(){if(j.trigger(this._element,X).defaultPrevented)return;this._element.classList.remove("show");const t=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,t)}_destroyElement(){this._element.remove(),j.trigger(this._element,Y),this.dispose()}static jQueryInterface(t){return this.each((function(){const e=U.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}V(U,"close"),b(U);const G='[data-bs-toggle="button"]';class J extends W{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each((function(){const e=J.getOrCreateInstance(this);"toggle"===t&&e[t]()}))}}j.on(document,"click.bs.button.data-api",G,(t=>{t.preventDefault();const e=t.target.closest(G);J.getOrCreateInstance(e).toggle()})),b(J);const Z=".bs.swipe",tt=`touchstart${Z}`,et=`touchmove${Z}`,it=`touchend${Z}`,st=`pointerdown${Z}`,nt=`pointerup${Z}`,ot={endCallback:null,leftCallback:null,rightCallback:null},rt={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class at extends q{constructor(t,e){super(),this._element=t,t&&at.isSupported()&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return ot}static get DefaultType(){return rt}static get NAME(){return"swipe"}dispose(){j.off(this._element,Z)}_start(t){this._supportPointerEvents?this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX):this._deltaX=t.touches[0].clientX}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),v(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=40)return;const e=t/this._deltaX;this._deltaX=0,e&&v(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(j.on(this._element,st,(t=>this._start(t))),j.on(this._element,nt,(t=>this._end(t))),this._element.classList.add("pointer-event")):(j.on(this._element,tt,(t=>this._start(t))),j.on(this._element,et,(t=>this._move(t))),j.on(this._element,it,(t=>this._end(t))))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&("pen"===t.pointerType||"touch"===t.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const lt=".bs.carousel",ct=".data-api",ht="next",dt="prev",ut="left",_t="right",gt=`slide${lt}`,ft=`slid${lt}`,mt=`keydown${lt}`,pt=`mouseenter${lt}`,bt=`mouseleave${lt}`,vt=`dragstart${lt}`,yt=`load${lt}${ct}`,wt=`click${lt}${ct}`,At="carousel",Et="active",Ct=".active",Tt=".carousel-item",kt=Ct+Tt,$t={ArrowLeft:_t,ArrowRight:ut},St={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Lt={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ot extends W{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=K.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===At&&this.cycle()}static get Default(){return St}static get DefaultType(){return Lt}static get NAME(){return"carousel"}next(){this._slide(ht)}nextWhenVisible(){!document.hidden&&h(this._element)&&this.next()}prev(){this._slide(dt)}pause(){this._isSliding&&a(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval((()=>this.nextWhenVisible()),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?j.one(this._element,ft,(()=>this.cycle())):this.cycle())}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding)return void j.one(this._element,ft,(()=>this.to(t)));const i=this._getItemIndex(this._getActive());if(i===t)return;const s=t>i?ht:dt;this._slide(s,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&j.on(this._element,mt,(t=>this._keydown(t))),"hover"===this._config.pause&&(j.on(this._element,pt,(()=>this.pause())),j.on(this._element,bt,(()=>this._maybeEnableCycle()))),this._config.touch&&at.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const t of K.find(".carousel-item img",this._element))j.on(t,vt,(t=>t.preventDefault()));const t={leftCallback:()=>this._slide(this._directionToOrder(ut)),rightCallback:()=>this._slide(this._directionToOrder(_t)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((()=>this._maybeEnableCycle()),500+this._config.interval))}};this._swipeHelper=new at(this._element,t)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=$t[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=K.findOne(Ct,this._indicatorsElement);e.classList.remove(Et),e.removeAttribute("aria-current");const i=K.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);i&&(i.classList.add(Et),i.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const i=this._getActive(),s=t===ht,n=e||w(this._getItems(),i,s,this._config.wrap);if(n===i)return;const o=this._getItemIndex(n),r=e=>j.trigger(this._element,e,{relatedTarget:n,direction:this._orderToDirection(t),from:this._getItemIndex(i),to:o});if(r(gt).defaultPrevented)return;if(!i||!n)return;const a=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=n;const l=s?"carousel-item-start":"carousel-item-end",c=s?"carousel-item-next":"carousel-item-prev";n.classList.add(c),g(n),i.classList.add(l),n.classList.add(l),this._queueCallback((()=>{n.classList.remove(l,c),n.classList.add(Et),i.classList.remove(Et,c,l),this._isSliding=!1,r(ft)}),i,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return K.findOne(kt,this._element)}_getItems(){return K.find(Tt,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return p()?t===ut?dt:ht:t===ut?ht:dt}_orderToDirection(t){return p()?t===dt?ut:_t:t===dt?_t:ut}static jQueryInterface(t){return this.each((function(){const e=Ot.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}else e.to(t)}))}}j.on(document,wt,"[data-bs-slide], [data-bs-slide-to]",(function(t){const e=K.getElementFromSelector(this);if(!e||!e.classList.contains(At))return;t.preventDefault();const i=Ot.getOrCreateInstance(e),s=this.getAttribute("data-bs-slide-to");return s?(i.to(s),void i._maybeEnableCycle()):"next"===B.getDataAttribute(this,"slide")?(i.next(),void i._maybeEnableCycle()):(i.prev(),void i._maybeEnableCycle())})),j.on(window,yt,(()=>{const t=K.find('[data-bs-ride="carousel"]');for(const e of t)Ot.getOrCreateInstance(e)})),b(Ot);const It=".bs.collapse",Dt=`show${It}`,Nt=`shown${It}`,Pt=`hide${It}`,xt=`hidden${It}`,Mt=`click${It}.data-api`,jt="show",Ft="collapse",zt="collapsing",Ht=`:scope .${Ft} .${Ft}`,Bt='[data-bs-toggle="collapse"]',qt={parent:null,toggle:!0},Wt={parent:"(null|element)",toggle:"boolean"};class Rt extends W{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const i=K.find(Bt);for(const t of i){const e=K.getSelectorFromElement(t),i=K.find(e).filter((t=>t===this._element));null!==e&&i.length&&this._triggerArray.push(t)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return qt}static get DefaultType(){return Wt}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((t=>t!==this._element)).map((t=>Rt.getOrCreateInstance(t,{toggle:!1})))),t.length&&t[0]._isTransitioning)return;if(j.trigger(this._element,Dt).defaultPrevented)return;for(const e of t)e.hide();const e=this._getDimension();this._element.classList.remove(Ft),this._element.classList.add(zt),this._element.style[e]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=`scroll${e[0].toUpperCase()+e.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(zt),this._element.classList.add(Ft,jt),this._element.style[e]="",j.trigger(this._element,Nt)}),this._element,!0),this._element.style[e]=`${this._element[i]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(j.trigger(this._element,Pt).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,g(this._element),this._element.classList.add(zt),this._element.classList.remove(Ft,jt);for(const t of this._triggerArray){const e=K.getElementFromSelector(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0,this._element.style[t]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(zt),this._element.classList.add(Ft),j.trigger(this._element,xt)}),this._element,!0)}_isShown(t=this._element){return t.classList.contains(jt)}_configAfterMerge(t){return t.toggle=Boolean(t.toggle),t.parent=c(t.parent),t}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(Bt);for(const e of t){const t=K.getElementFromSelector(e);t&&this._addAriaAndCollapsedClass([e],this._isShown(t))}}_getFirstLevelChildren(t){const e=K.find(Ht,this._config.parent);return K.find(t,this._config.parent).filter((t=>!e.includes(t)))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const i of t)i.classList.toggle("collapsed",!e),i.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return"string"==typeof t&&/show|hide/.test(t)&&(e.toggle=!1),this.each((function(){const i=Rt.getOrCreateInstance(this,e);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t]()}}))}}j.on(document,Mt,Bt,(function(t){("A"===t.target.tagName||t.delegateTarget&&"A"===t.delegateTarget.tagName)&&t.preventDefault();for(const t of K.getMultipleElementsFromSelector(this))Rt.getOrCreateInstance(t,{toggle:!1}).toggle()})),b(Rt);const Kt="dropdown",Vt=".bs.dropdown",Qt=".data-api",Xt="ArrowUp",Yt="ArrowDown",Ut=`hide${Vt}`,Gt=`hidden${Vt}`,Jt=`show${Vt}`,Zt=`shown${Vt}`,te=`click${Vt}${Qt}`,ee=`keydown${Vt}${Qt}`,ie=`keyup${Vt}${Qt}`,se="show",ne='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',oe=`${ne}.${se}`,re=".dropdown-menu",ae=p()?"top-end":"top-start",le=p()?"top-start":"top-end",ce=p()?"bottom-end":"bottom-start",he=p()?"bottom-start":"bottom-end",de=p()?"left-start":"right-start",ue=p()?"right-start":"left-start",_e={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},ge={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class fe extends W{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=K.next(this._element,re)[0]||K.prev(this._element,re)[0]||K.findOne(re,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return _e}static get DefaultType(){return ge}static get NAME(){return Kt}toggle(){return this._isShown()?this.hide():this.show()}show(){if(d(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!j.trigger(this._element,Jt,t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const t of[].concat(...document.body.children))j.on(t,"mouseover",_);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(se),this._element.classList.add(se),j.trigger(this._element,Zt,t)}}hide(){if(d(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!j.trigger(this._element,Ut,t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))j.off(t,"mouseover",_);this._popper&&this._popper.destroy(),this._menu.classList.remove(se),this._element.classList.remove(se),this._element.setAttribute("aria-expanded","false"),B.removeDataAttribute(this._menu,"popper"),j.trigger(this._element,Gt,t)}}_getConfig(t){if("object"==typeof(t=super._getConfig(t)).reference&&!l(t.reference)&&"function"!=typeof t.reference.getBoundingClientRect)throw new TypeError(`${Kt.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(void 0===i)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let t=this._element;"parent"===this._config.reference?t=this._parent:l(this._config.reference)?t=c(this._config.reference):"object"==typeof this._config.reference&&(t=this._config.reference);const e=this._getPopperConfig();this._popper=i.createPopper(t,this._menu,e)}_isShown(){return this._menu.classList.contains(se)}_getPlacement(){const t=this._parent;if(t.classList.contains("dropend"))return de;if(t.classList.contains("dropstart"))return ue;if(t.classList.contains("dropup-center"))return"top";if(t.classList.contains("dropdown-center"))return"bottom";const e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return t.classList.contains("dropup")?e?le:ae:e?he:ce}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(B.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...v(this._config.popperConfig,[t])}}_selectMenuItem({key:t,target:e}){const i=K.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter((t=>h(t)));i.length&&w(i,e,t===Yt,!i.includes(e)).focus()}static jQueryInterface(t){return this.each((function(){const e=fe.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}static clearMenus(t){if(2===t.button||"keyup"===t.type&&"Tab"!==t.key)return;const e=K.find(oe);for(const i of e){const e=fe.getInstance(i);if(!e||!1===e._config.autoClose)continue;const s=t.composedPath(),n=s.includes(e._menu);if(s.includes(e._element)||"inside"===e._config.autoClose&&!n||"outside"===e._config.autoClose&&n)continue;if(e._menu.contains(t.target)&&("keyup"===t.type&&"Tab"===t.key||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const o={relatedTarget:e._element};"click"===t.type&&(o.clickEvent=t),e._completeHide(o)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),i="Escape"===t.key,s=[Xt,Yt].includes(t.key);if(!s&&!i)return;if(e&&!i)return;t.preventDefault();const n=this.matches(ne)?this:K.prev(this,ne)[0]||K.next(this,ne)[0]||K.findOne(ne,t.delegateTarget.parentNode),o=fe.getOrCreateInstance(n);if(s)return t.stopPropagation(),o.show(),void o._selectMenuItem(t);o._isShown()&&(t.stopPropagation(),o.hide(),n.focus())}}j.on(document,ee,ne,fe.dataApiKeydownHandler),j.on(document,ee,re,fe.dataApiKeydownHandler),j.on(document,te,fe.clearMenus),j.on(document,ie,fe.clearMenus),j.on(document,te,ne,(function(t){t.preventDefault(),fe.getOrCreateInstance(this).toggle()})),b(fe);const me="backdrop",pe="show",be=`mousedown.bs.${me}`,ve={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},ye={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class we extends q{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return ve}static get DefaultType(){return ye}static get NAME(){return me}show(t){if(!this._config.isVisible)return void v(t);this._append();const e=this._getElement();this._config.isAnimated&&g(e),e.classList.add(pe),this._emulateAnimation((()=>{v(t)}))}hide(t){this._config.isVisible?(this._getElement().classList.remove(pe),this._emulateAnimation((()=>{this.dispose(),v(t)}))):v(t)}dispose(){this._isAppended&&(j.off(this._element,be),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add("fade"),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=c(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),j.on(t,be,(()=>{v(this._config.clickCallback)})),this._isAppended=!0}_emulateAnimation(t){y(t,this._getElement(),this._config.isAnimated)}}const Ae=".bs.focustrap",Ee=`focusin${Ae}`,Ce=`keydown.tab${Ae}`,Te="backward",ke={autofocus:!0,trapElement:null},$e={autofocus:"boolean",trapElement:"element"};class Se extends q{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return ke}static get DefaultType(){return $e}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),j.off(document,Ae),j.on(document,Ee,(t=>this._handleFocusin(t))),j.on(document,Ce,(t=>this._handleKeydown(t))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,j.off(document,Ae))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const i=K.focusableChildren(e);0===i.length?e.focus():this._lastTabNavDirection===Te?i[i.length-1].focus():i[0].focus()}_handleKeydown(t){"Tab"===t.key&&(this._lastTabNavDirection=t.shiftKey?Te:"forward")}}const Le=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Oe=".sticky-top",Ie="padding-right",De="margin-right";class Ne{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ie,(e=>e+t)),this._setElementAttributes(Le,Ie,(e=>e+t)),this._setElementAttributes(Oe,De,(e=>e-t))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ie),this._resetElementAttributes(Le,Ie),this._resetElementAttributes(Oe,De)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,i){const s=this.getWidth();this._applyManipulationCallback(t,(t=>{if(t!==this._element&&window.innerWidth>t.clientWidth+s)return;this._saveInitialAttribute(t,e);const n=window.getComputedStyle(t).getPropertyValue(e);t.style.setProperty(e,`${i(Number.parseFloat(n))}px`)}))}_saveInitialAttribute(t,e){const i=t.style.getPropertyValue(e);i&&B.setDataAttribute(t,e,i)}_resetElementAttributes(t,e){this._applyManipulationCallback(t,(t=>{const i=B.getDataAttribute(t,e);null!==i?(B.removeDataAttribute(t,e),t.style.setProperty(e,i)):t.style.removeProperty(e)}))}_applyManipulationCallback(t,e){if(l(t))e(t);else for(const i of K.find(t,this._element))e(i)}}const Pe=".bs.modal",xe=`hide${Pe}`,Me=`hidePrevented${Pe}`,je=`hidden${Pe}`,Fe=`show${Pe}`,ze=`shown${Pe}`,He=`resize${Pe}`,Be=`click.dismiss${Pe}`,qe=`mousedown.dismiss${Pe}`,We=`keydown.dismiss${Pe}`,Re=`click${Pe}.data-api`,Ke="modal-open",Ve="show",Qe="modal-static",Xe={backdrop:!0,focus:!0,keyboard:!0},Ye={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Ue extends W{constructor(t,e){super(t,e),this._dialog=K.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Ne,this._addEventListeners()}static get Default(){return Xe}static get DefaultType(){return Ye}static get NAME(){return"modal"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||j.trigger(this._element,Fe,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Ke),this._adjustDialog(),this._backdrop.show((()=>this._showElement(t))))}hide(){this._isShown&&!this._isTransitioning&&(j.trigger(this._element,xe).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Ve),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated())))}dispose(){j.off(window,Pe),j.off(this._dialog,Pe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new we({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Se({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=K.findOne(".modal-body",this._dialog);e&&(e.scrollTop=0),g(this._element),this._element.classList.add(Ve),this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,j.trigger(this._element,ze,{relatedTarget:t})}),this._dialog,this._isAnimated())}_addEventListeners(){j.on(this._element,We,(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())})),j.on(window,He,(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),j.on(this._element,qe,(t=>{j.one(this._element,Be,(e=>{this._element===t.target&&this._element===e.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(Ke),this._resetAdjustments(),this._scrollBar.reset(),j.trigger(this._element,je)}))}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(j.trigger(this._element,Me).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._element.style.overflowY;"hidden"===e||this._element.classList.contains(Qe)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Qe),this._queueCallback((()=>{this._element.classList.remove(Qe),this._queueCallback((()=>{this._element.style.overflowY=e}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),i=e>0;if(i&&!t){const t=p()?"paddingLeft":"paddingRight";this._element.style[t]=`${e}px`}if(!i&&t){const t=p()?"paddingRight":"paddingLeft";this._element.style[t]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each((function(){const i=Ue.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t](e)}}))}}j.on(document,Re,'[data-bs-toggle="modal"]',(function(t){const e=K.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),j.one(e,Fe,(t=>{t.defaultPrevented||j.one(e,je,(()=>{h(this)&&this.focus()}))}));const i=K.findOne(".modal.show");i&&Ue.getInstance(i).hide(),Ue.getOrCreateInstance(e).toggle(this)})),V(Ue),b(Ue);const Ge=".bs.offcanvas",Je=".data-api",Ze=`load${Ge}${Je}`,ti="show",ei="showing",ii="hiding",si=".offcanvas.show",ni=`show${Ge}`,oi=`shown${Ge}`,ri=`hide${Ge}`,ai=`hidePrevented${Ge}`,li=`hidden${Ge}`,ci=`resize${Ge}`,hi=`click${Ge}${Je}`,di=`keydown.dismiss${Ge}`,ui={backdrop:!0,keyboard:!0,scroll:!1},_i={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class gi extends W{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return ui}static get DefaultType(){return _i}static get NAME(){return"offcanvas"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||j.trigger(this._element,ni,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new Ne).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(ei),this._queueCallback((()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(ti),this._element.classList.remove(ei),j.trigger(this._element,oi,{relatedTarget:t})}),this._element,!0))}hide(){this._isShown&&(j.trigger(this._element,ri).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(ii),this._backdrop.hide(),this._queueCallback((()=>{this._element.classList.remove(ti,ii),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new Ne).reset(),j.trigger(this._element,li)}),this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=Boolean(this._config.backdrop);return new we({className:"offcanvas-backdrop",isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?()=>{"static"!==this._config.backdrop?this.hide():j.trigger(this._element,ai)}:null})}_initializeFocusTrap(){return new Se({trapElement:this._element})}_addEventListeners(){j.on(this._element,di,(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():j.trigger(this._element,ai))}))}static jQueryInterface(t){return this.each((function(){const e=gi.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}j.on(document,hi,'[data-bs-toggle="offcanvas"]',(function(t){const e=K.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),d(this))return;j.one(e,li,(()=>{h(this)&&this.focus()}));const i=K.findOne(si);i&&i!==e&&gi.getInstance(i).hide(),gi.getOrCreateInstance(e).toggle(this)})),j.on(window,Ze,(()=>{for(const t of K.find(si))gi.getOrCreateInstance(t).show()})),j.on(window,ci,(()=>{for(const t of K.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(t).position&&gi.getOrCreateInstance(t).hide()})),V(gi),b(gi);const fi={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},mi=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),pi=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,bi=(t,e)=>{const i=t.nodeName.toLowerCase();return e.includes(i)?!mi.has(i)||Boolean(pi.test(t.nodeValue)):e.filter((t=>t instanceof RegExp)).some((t=>t.test(i)))},vi={allowList:fi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},yi={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},wi={entry:"(string|element|function|null)",selector:"(string|element)"};class Ai extends q{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return vi}static get DefaultType(){return yi}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map((t=>this._resolvePossibleFunction(t))).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[e,i]of Object.entries(this._config.content))this._setContent(t,i,e);const e=t.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&e.classList.add(...i.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,i]of Object.entries(t))super._typeCheckConfig({selector:e,entry:i},wi)}_setContent(t,e,i){const s=K.findOne(i,t);s&&((e=this._resolvePossibleFunction(e))?l(e)?this._putElementInTemplate(c(e),s):this._config.html?s.innerHTML=this._maybeSanitize(e):s.textContent=e:s.remove())}_maybeSanitize(t){return this._config.sanitize?function(t,e,i){if(!t.length)return t;if(i&&"function"==typeof i)return i(t);const s=(new window.DOMParser).parseFromString(t,"text/html"),n=[].concat(...s.body.querySelectorAll("*"));for(const t of n){const i=t.nodeName.toLowerCase();if(!Object.keys(e).includes(i)){t.remove();continue}const s=[].concat(...t.attributes),n=[].concat(e["*"]||[],e[i]||[]);for(const e of s)bi(e,n)||t.removeAttribute(e.nodeName)}return s.body.innerHTML}(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return v(t,[this])}_putElementInTemplate(t,e){if(this._config.html)return e.innerHTML="",void e.append(t);e.textContent=t.textContent}}const Ei=new Set(["sanitize","allowList","sanitizeFn"]),Ci="fade",Ti="show",ki=".modal",$i="hide.bs.modal",Si="hover",Li="focus",Oi={AUTO:"auto",TOP:"top",RIGHT:p()?"left":"right",BOTTOM:"bottom",LEFT:p()?"right":"left"},Ii={allowList:fi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Di={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Ni extends W{constructor(t,e){if(void 0===i)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(t,e),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Ii}static get DefaultType(){return Di}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),j.off(this._element.closest(ki),$i,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const t=j.trigger(this._element,this.constructor.eventName("show")),e=(u(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!e)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:s}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(s.append(i),j.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(i),i.classList.add(Ti),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))j.on(t,"mouseover",_);this._queueCallback((()=>{j.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1}),this.tip,this._isAnimated())}hide(){if(this._isShown()&&!j.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Ti),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))j.off(t,"mouseover",_);this._activeTrigger.click=!1,this._activeTrigger[Li]=!1,this._activeTrigger[Si]=!1,this._isHovered=null,this._queueCallback((()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),j.trigger(this._element,this.constructor.eventName("hidden")))}),this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(Ci,Ti),e.classList.add(`bs-${this.constructor.NAME}-auto`);const i=(t=>{do{t+=Math.floor(1e6*Math.random())}while(document.getElementById(t));return t})(this.constructor.NAME).toString();return e.setAttribute("id",i),this._isAnimated()&&e.classList.add(Ci),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new Ai({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ci)}_isShown(){return this.tip&&this.tip.classList.contains(Ti)}_createPopper(t){const e=v(this._config.placement,[this,t,this._element]),s=Oi[e.toUpperCase()];return i.createPopper(this._element,t,this._getPopperConfig(s))}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(t){return v(t,[this._element])}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:t=>{this._getTipElement().setAttribute("data-popper-placement",t.state.placement)}}]};return{...e,...v(this._config.popperConfig,[e])}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if("click"===e)j.on(this._element,this.constructor.eventName("click"),this._config.selector,(t=>{this._initializeOnDelegatedTarget(t).toggle()}));else if("manual"!==e){const t=e===Si?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),i=e===Si?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");j.on(this._element,t,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusin"===t.type?Li:Si]=!0,e._enter()})),j.on(this._element,i,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusout"===t.type?Li:Si]=e._element.contains(t.relatedTarget),e._leave()}))}this._hideModalHandler=()=>{this._element&&this.hide()},j.on(this._element.closest(ki),$i,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout((()=>{this._isHovered&&this.show()}),this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout((()=>{this._isHovered||this.hide()}),this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=B.getDataAttributes(this._element);for(const t of Object.keys(e))Ei.has(t)&&delete e[t];return t={...e,..."object"==typeof t&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=!1===t.container?document.body:c(t.container),"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const[e,i]of Object.entries(this._config))this.constructor.Default[e]!==i&&(t[e]=i);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each((function(){const e=Ni.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}b(Ni);const Pi={...Ni.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},xi={...Ni.DefaultType,content:"(null|string|element|function)"};class Mi extends Ni{static get Default(){return Pi}static get DefaultType(){return xi}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each((function(){const e=Mi.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}b(Mi);const ji=".bs.scrollspy",Fi=`activate${ji}`,zi=`click${ji}`,Hi=`load${ji}.data-api`,Bi="active",qi="[href]",Wi=".nav-link",Ri=`${Wi}, .nav-item > ${Wi}, .list-group-item`,Ki={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Vi={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Qi extends W{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Ki}static get DefaultType(){return Vi}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=c(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,"string"==typeof t.threshold&&(t.threshold=t.threshold.split(",").map((t=>Number.parseFloat(t)))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(j.off(this._config.target,zi),j.on(this._config.target,zi,qi,(t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const i=this._rootElement||window,s=e.offsetTop-this._element.offsetTop;if(i.scrollTo)return void i.scrollTo({top:s,behavior:"smooth"});i.scrollTop=s}})))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver((t=>this._observerCallback(t)),t)}_observerCallback(t){const e=t=>this._targetLinks.get(`#${t.target.id}`),i=t=>{this._previousScrollData.visibleEntryTop=t.target.offsetTop,this._process(e(t))},s=(this._rootElement||document.documentElement).scrollTop,n=s>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=s;for(const o of t){if(!o.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(o));continue}const t=o.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(n&&t){if(i(o),!s)return}else n||t||i(o)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=K.find(qi,this._config.target);for(const e of t){if(!e.hash||d(e))continue;const t=K.findOne(decodeURI(e.hash),this._element);h(t)&&(this._targetLinks.set(decodeURI(e.hash),e),this._observableSections.set(e.hash,t))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(Bi),this._activateParents(t),j.trigger(this._element,Fi,{relatedTarget:t}))}_activateParents(t){if(t.classList.contains("dropdown-item"))K.findOne(".dropdown-toggle",t.closest(".dropdown")).classList.add(Bi);else for(const e of K.parents(t,".nav, .list-group"))for(const t of K.prev(e,Ri))t.classList.add(Bi)}_clearActiveClass(t){t.classList.remove(Bi);const e=K.find(`${qi}.${Bi}`,t);for(const t of e)t.classList.remove(Bi)}static jQueryInterface(t){return this.each((function(){const e=Qi.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}j.on(window,Hi,(()=>{for(const t of K.find('[data-bs-spy="scroll"]'))Qi.getOrCreateInstance(t)})),b(Qi);const Xi=".bs.tab",Yi=`hide${Xi}`,Ui=`hidden${Xi}`,Gi=`show${Xi}`,Ji=`shown${Xi}`,Zi=`click${Xi}`,ts=`keydown${Xi}`,es=`load${Xi}`,is="ArrowLeft",ss="ArrowRight",ns="ArrowUp",os="ArrowDown",rs="Home",as="End",ls="active",cs="fade",hs="show",ds=".dropdown-toggle",us=`:not(${ds})`,_s='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',gs=`.nav-link${us}, .list-group-item${us}, [role="tab"]${us}, ${_s}`,fs=`.${ls}[data-bs-toggle="tab"], .${ls}[data-bs-toggle="pill"], .${ls}[data-bs-toggle="list"]`;class ms extends W{constructor(t){super(t),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),j.on(this._element,ts,(t=>this._keydown(t))))}static get NAME(){return"tab"}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),i=e?j.trigger(e,Yi,{relatedTarget:t}):null;j.trigger(t,Gi,{relatedTarget:e}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){t&&(t.classList.add(ls),this._activate(K.getElementFromSelector(t)),this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),j.trigger(t,Ji,{relatedTarget:e})):t.classList.add(hs)}),t,t.classList.contains(cs)))}_deactivate(t,e){t&&(t.classList.remove(ls),t.blur(),this._deactivate(K.getElementFromSelector(t)),this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),j.trigger(t,Ui,{relatedTarget:e})):t.classList.remove(hs)}),t,t.classList.contains(cs)))}_keydown(t){if(![is,ss,ns,os,rs,as].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=this._getChildren().filter((t=>!d(t)));let i;if([rs,as].includes(t.key))i=e[t.key===rs?0:e.length-1];else{const s=[ss,os].includes(t.key);i=w(e,t.target,s,!0)}i&&(i.focus({preventScroll:!0}),ms.getOrCreateInstance(i).show())}_getChildren(){return K.find(gs,this._parent)}_getActiveElem(){return this._getChildren().find((t=>this._elemIsActive(t)))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const t of e)this._setInitialAttributesOnChild(t)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),i=this._getOuterElement(t);t.setAttribute("aria-selected",e),i!==t&&this._setAttributeIfNotExists(i,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=K.getElementFromSelector(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,e){const i=this._getOuterElement(t);if(!i.classList.contains("dropdown"))return;const s=(t,s)=>{const n=K.findOne(t,i);n&&n.classList.toggle(s,e)};s(ds,ls),s(".dropdown-menu",hs),i.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,i){t.hasAttribute(e)||t.setAttribute(e,i)}_elemIsActive(t){return t.classList.contains(ls)}_getInnerElement(t){return t.matches(gs)?t:K.findOne(gs,t)}_getOuterElement(t){return t.closest(".nav-item, .list-group-item")||t}static jQueryInterface(t){return this.each((function(){const e=ms.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}j.on(document,Zi,_s,(function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),d(this)||ms.getOrCreateInstance(this).show()})),j.on(window,es,(()=>{for(const t of K.find(fs))ms.getOrCreateInstance(t)})),b(ms);const ps=".bs.toast",bs=`mouseover${ps}`,vs=`mouseout${ps}`,ys=`focusin${ps}`,ws=`focusout${ps}`,As=`hide${ps}`,Es=`hidden${ps}`,Cs=`show${ps}`,Ts=`shown${ps}`,ks="hide",$s="show",Ss="showing",Ls={animation:"boolean",autohide:"boolean",delay:"number"},Os={animation:!0,autohide:!0,delay:5e3};class Is extends W{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Os}static get DefaultType(){return Ls}static get NAME(){return"toast"}show(){j.trigger(this._element,Cs).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(ks),g(this._element),this._element.classList.add($s,Ss),this._queueCallback((()=>{this._element.classList.remove(Ss),j.trigger(this._element,Ts),this._maybeScheduleHide()}),this._element,this._config.animation))}hide(){this.isShown()&&(j.trigger(this._element,As).defaultPrevented||(this._element.classList.add(Ss),this._queueCallback((()=>{this._element.classList.add(ks),this._element.classList.remove(Ss,$s),j.trigger(this._element,Es)}),this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove($s),super.dispose()}isShown(){return this._element.classList.contains($s)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":this._hasMouseInteraction=e;break;case"focusin":case"focusout":this._hasKeyboardInteraction=e}if(e)return void this._clearTimeout();const i=t.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){j.on(this._element,bs,(t=>this._onInteraction(t,!0))),j.on(this._element,vs,(t=>this._onInteraction(t,!1))),j.on(this._element,ys,(t=>this._onInteraction(t,!0))),j.on(this._element,ws,(t=>this._onInteraction(t,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each((function(){const e=Is.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}return V(Is),b(Is),{Alert:U,Button:J,Carousel:Ot,Collapse:Rt,Dropdown:fe,Modal:Ue,Offcanvas:gi,Popover:Mi,ScrollSpy:Qi,Tab:ms,Toast:Is,Tooltip:Ni}}));
//# sourceMappingURL=bootstrap.min.js.map
"use strict";
angular.module("myApp", ["firebase", "ngRoute", "myApp.access", "myApp.account", "myApp.affiliate", "myApp.championship-admin-competitors", "myApp.championship-admin-config", "myApp.championship-admin-matches", "myApp.championship-admin-seeding", "myApp.championship-best-scores", "myApp.championship-compete", "myApp.championship-competitors", "myApp.championship-finals", "myApp.championship-groups", "myApp.championship-matches", "myApp.championship-overview", "myApp.championship-qualifiers", "myApp.championship-scheduling", "myApp.championship-scores", "myApp.championship-seeding", "myApp.championship-sponsors", "myApp.championships", "myApp.compete", "myApp.compete-cards", "myApp.compete-images", "myApp.compete-international", "myApp.compete-names", "myApp.compete-numbers", "myApp.compete-words", "myApp.contact", "myApp.data", "myApp.home", "myApp.leaderboard", "myApp.league", "myApp.league-register", "myApp.performance", "myApp.qualify", "myApp.signin", "myApp.train", "myApp.train-cards", "myApp.train-images", "myApp.train-international", "myApp.train-names", "myApp.train-numbers", "myApp.train-words", "myApp.view-cards", "myApp.view-images", "myApp.view-international", "myApp.view-names", "myApp.view-numbers", "myApp.view-table", "myApp.view-words", "myApp.world-rankings", "myApp.world-tour"]).config(["$locationProvider", "$routeProvider", function(e, a) {
    e.hashPrefix("!"),
    a.otherwise({
        redirectTo: "/home"
    })
}
]).run(["$location", "$rootScope", "$window", function(e, a, t) {
    a.$on("$routeChangeSuccess", function() {
        gtag("config", "UA-19857446-11", {
            page_path: e.path(),
            anonymize_ip: !0
        }),
        gtag("config", "G-NG5FD80ZD8", {
            page_path: e.path(),
            anonymize_ip: !0
        })
    })
}
]);
var site = "memoryleague";
"memoryleague.com" === window.location.hostname && (site = "memoryleague"),
"memoryleaguekids.com" === window.location.hostname && (site = "memoryleaguekids");
var countryNames = {
    ad: "Andorra",
    ae: "U.A.E.",
    af: "Afghanistan",
    ag: "Antigua",
    ai: "Anguilla",
    al: "Albania",
    am: "Armenia",
    an: "Netherlands Antilles",
    ao: "Angola",
    ar: "Argentina",
    as: "American Samoa",
    at: "Austria",
    au: "Australia",
    aw: "Aruba",
    ax: "Aland Islands",
    az: "Azerbaijan",
    ba: "Bosnia",
    bb: "Barbados",
    bd: "Bangladesh",
    be: "Belgium",
    bf: "Burkina Faso",
    bg: "Bulgaria",
    bh: "Bahrain",
    bi: "Burundi",
    bj: "Benin",
    bm: "Bermuda",
    bn: "Brunei",
    bo: "Bolivia",
    br: "Brazil",
    bs: "Bahamas",
    bt: "Bhutan",
    bv: "Bouvet Island",
    bw: "Botswana",
    by: "Belarus",
    bz: "Belize",
    ca: "Canada",
    cc: "Cocos Islands",
    cd: "Congo",
    cf: "Central African Republic",
    cg: "Congo Brazzaville",
    ch: "Switzerland",
    ci: "Cote Divoire",
    ck: "Cook Islands",
    cl: "Chile",
    cm: "Cameroon",
    cn: "China",
    co: "Colombia",
    cr: "Costa Rica",
    cs: "Serbia",
    cu: "Cuba",
    cv: "Cape Verde",
    cx: "Christmas Island",
    cy: "Cyprus",
    cz: "Czech Republic",
    de: "Germany",
    dj: "Djibouti",
    dk: "Denmark",
    dm: "Dominica",
    do: "Dominican Republic",
    dz: "Algeria",
    ec: "Ecuador",
    ee: "Estonia",
    eg: "Egypt",
    eh: "Western Sahara",
    er: "Eritrea",
    es: "Spain",
    et: "Ethiopia",
    eu: "European Union",
    fi: "Finland",
    fj: "Fiji",
    fk: "Falkland Islands",
    fm: "Micronesia",
    fo: "Faroe Islands",
    fr: "France",
    ga: "Gabon",
    gb: "United Kingdom",
    "gb uk": "United Kingdom",
    "gb eng": "England",
    "gb sct": "Scotland",
    "gb wls": "Wales",
    gd: "Grenada",
    ge: "Georgia",
    gf: "French Guiana",
    gh: "Ghana",
    gi: "Gibraltar",
    gl: "Greenland",
    gm: "Gambia",
    gn: "Guinea",
    gp: "Guadeloupe",
    gq: "Equatorial Guinea",
    gr: "Greece",
    gs: "Sandwich Islands",
    gt: "Guatemala",
    gu: "Guam",
    gw: "Guinea-Bissau",
    gy: "Guyana",
    hk: "Hong Kong",
    hm: "Heard Island",
    hn: "Honduras",
    hr: "Croatia",
    ht: "Haiti",
    hu: "Hungary",
    id: "Indonesia",
    ie: "Ireland",
    il: "Israel",
    in: "India",
    io: "Indian Ocean Territory",
    iq: "Iraq",
    ir: "Iran",
    is: "Iceland",
    it: "Italy",
    jm: "Jamaica",
    jo: "Jordan",
    jp: "Japan",
    ke: "Kenya",
    kg: "Kyrgyzstan",
    kh: "Cambodia",
    ki: "Kiribati",
    km: "Comoros",
    kn: "Saint Kitts And Nevis",
    kp: "North Korea",
    kr: "South Korea",
    kw: "Kuwait",
    ky: "Cayman Islands",
    kz: "Kazakhstan",
    la: "Laos",
    lb: "Lebanon",
    lc: "Saint Lucia",
    li: "Liechtenstein",
    lk: "Sri Lanka",
    lr: "Liberia",
    ls: "Lesotho",
    lt: "Lithuania",
    lu: "Luxembourg",
    lv: "Latvia",
    ly: "Libya",
    ma: "Morocco",
    mc: "Monaco",
    md: "Moldova",
    me: "Montenegro",
    mg: "Madagascar",
    mh: "Marshall Islands",
    mk: "Macedonia",
    ml: "Mali",
    mm: "Myanmar",
    mn: "Mongolia",
    mo: "Macau",
    mp: "Northern Mariana Islands",
    mq: "Martinique",
    mr: "Mauritania",
    ms: "Montserrat",
    mt: "Malta",
    mu: "Mauritius",
    mv: "Maldives",
    mw: "Malawi",
    mx: "Mexico",
    my: "Malaysia",
    mz: "Mozambique",
    na: "Namibia",
    nc: "New Caledonia",
    ne: "Niger",
    nf: "Norfolk Island",
    ng: "Nigeria",
    ni: "Nicaragua",
    nl: "Netherlands",
    no: "Norway",
    np: "Nepal",
    nr: "Nauru",
    nu: "Niue",
    nz: "New Zealand",
    om: "Oman",
    pa: "Panama",
    pe: "Peru",
    pf: "French Polynesia",
    pg: "New Guinea",
    ph: "Philippines",
    pk: "Pakistan",
    pl: "Poland",
    pm: "Saint Pierre",
    pn: "Pitcairn Islands",
    pr: "Puerto Rico",
    ps: "Palestine",
    pt: "Portugal",
    pw: "Palau",
    py: "Paraguay",
    qa: "Qatar",
    re: "Reunion",
    ro: "Romania",
    rs: "Serbia",
    ru: "Russia",
    rw: "Rwanda",
    sa: "Saudi Arabia",
    sb: "Solomon Islands",
    sc: "Seychelles",
    sd: "Sudan",
    se: "Sweden",
    sg: "Singapore",
    sh: "Saint Helena",
    si: "Slovenia",
    sj: "Jan Mayen",
    sk: "Slovakia",
    sl: "Sierra Leone",
    sm: "San Marino",
    sn: "Senegal",
    so: "Somalia",
    sr: "Suriname",
    st: "Sao Tome",
    sv: "El Salvador",
    sy: "Syria",
    sz: "Swaziland",
    tc: "Caicos Islands",
    td: "Chad",
    tf: "French Territories",
    tg: "Togo",
    th: "Thailand",
    tj: "Tajikistan",
    tk: "Tokelau",
    tl: "Timorleste",
    tm: "Turkmenistan",
    tn: "Tunisia",
    to: "Tonga",
    tr: "Turkey",
    tt: "Trinidad",
    tv: "Tuvalu",
    tw: "Taiwan",
    tz: "Tanzania",
    ua: "Ukraine",
    ug: "Uganda",
    um: "Us Minor Islands",
    us: "United States",
    uy: "Uruguay",
    uz: "Uzbekistan",
    va: "Vatican City",
    vc: "Saint Vincent",
    ve: "Venezuela",
    vg: "British Virgin Islands",
    vi: "US Virgin Islands",
    vn: "Vietnam",
    vu: "Vanuatu",
    wf: "Wallis And Futuna",
    ws: "Samoa",
    ye: "Yemen",
    yt: "Mayotte",
    za: "South Africa",
    zm: "Zambia",
    zw: "Zimbabwe"
};
angular.module("myApp.access", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/access", {
        templateUrl: "access/access.html",
        controller: "AccessCtrl"
    })
}
]).controller("AccessCtrl", ["$rootScope", "$scope", "$window", function(e, a, t) {
    var r;
    (window.myscope = a).waiting = !1,
    a.grantAccess = function() {
        a.waiting = !0,
        a.$$phase || a.$apply(),
        r = firebase.database().ref("pending").push({
            emails: a.emails,
            hours: a.hours,
            requestType: "access",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        firebase.database().ref("pending/" + r.key).on("value", function(e) {
            e.val() && e.val().done && (firebase.database().ref("pending/" + r.key).off(),
            r.remove(),
            a.results = e.val().results,
            a.waiting = !1,
            a.$$phase || a.$apply())
        })
    }
}
]),
angular.module("myApp.account", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/account", {
        templateUrl: "account/account.html",
        controller: "AccountCtrl"
    })
}
]).controller("AccountCtrl", ["$rootScope", "$scope", "$window", function(s, o, e) {
    window.myscope = o,
    $(".ui.checkbox").checkbox(),
    $(".ui.dropdown.country").dropdown({
        onChange: function() {
            "success" !== o.messageClass && "error" !== o.messageClass || (o.messageClass = ""),
            o.status = "",
            o.$$phase || o.$apply()
        }
    }),
    o.now = new Date,
    o.site = window.site,
    function e() {
        o.user && o.user.prefs ? (o.tempUser = {
            email: o.user.email,
            displayName: o.user.displayName
        },
        $(".ui.dropdown.country").dropdown("set selected", o.user.flag || ""),
        o.$$phase || o.$apply()) : setTimeout(e, 1e3)
    }(),
    o.displayNameDisabled = function() {
        return !o.user || !(!o.user.lastNameChange || o.user.lastNameChange < Date.now() - 5184e6)
    }
    ,
    o.userId = function() {
        return firebase.auth().currentUser ? firebase.auth().currentUser.uid : ""
    }
    ,
    o.encodedEmail = function() {
        return o.user && o.user.emailLower ? encodeURIComponent(o.user.emailLower) : ""
    }
    ,
    o.emailChange = function() {
        o.messageClass = "warning",
        o.status = ""
    }
    ,
    o.displayNameChange = function() {
        "success" !== o.messageClass && "error" !== o.messageClass || (o.messageClass = ""),
        o.status = ""
    }
    ,
    o.termsClick = function() {
        o.termsAccepted = !o.termsAccepted,
        "success" !== o.messageClass && "error" !== o.messageClass || (o.messageClass = "")
    }
    ,
    o.saveClick = function() {
        var e, t, r;
        o.status = "Saving",
        o.messageClass = "",
        r = o.user.termsAccepted,
        e = $(".country").dropdown("get value"),
        t = firebase.database().ref("pending").push({
            displayName: o.tempUser.displayName,
            email: o.tempUser.email,
            flag: e,
            requestType: "account",
            source: o.user.source || "",
            termsAccepted: o.user.termsAccepted || o.termsAccepted,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        firebase.database().ref("pending/" + t.key).on("value", function(e) {
            var a;
            e.exists() && (!1 !== (a = e.val().done) && !0 !== a || (firebase.database().ref("pending/" + t.key).off(),
            t.remove(),
            a ? (!r && o.termsAccepted && (o.user.termsAccepted = !0,
            $(".ui.modal.new").modal("setting", {
                onApprove: function() {}
            }).modal("show")),
            o.user.termsAccepted = o.user.termsAccepted || o.termsAccepted,
            o.user.email = o.tempUser.email,
            o.user.displayName = o.tempUser.displayName,
            s.user.email = o.user.email,
            s.user.displayName = o.user.displayName,
            s.user.termsAccepted = o.user.termsAccepted,
            o.messageClass = "success") : (o.messageClass = "error",
            o.errorMessage = "failed",
            o.errorReason = e.val().errorReason || ""),
            o.status = "Done",
            o.$$phase || o.$apply()))
        })
    }
    ,
    o.showTerms = function(e) {
        $(".ui.modal.terms").modal("setting", {
            onApprove: function() {}
        }).modal("show"),
        e.stopPropagation()
    }
    ,
    o.showPrivacy = function(e) {
        $(".ui.modal.privacy").modal("setting", {
            onApprove: function() {}
        }).modal("show"),
        e.stopPropagation()
    }
    ,
    o.$on("$locationChangeStart", function(e) {
        o.user && !o.user.termsAccepted && (e.preventDefault(),
        o.messageClass = "error",
        o.errorMessage = "terms")
    }),
    o.$on("$destroy", function() {
        $(".ui.modal.new").modal("hide"),
        $(".ui.modal.terms").remove(),
        $(".ui.modal.privacy").remove(),
        $(".ui.modal.new").remove()
    })
}
]),
angular.module("myApp.affiliate", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/affiliate", {
        templateUrl: "affiliate/affiliate.html",
        controller: "AffiliateCtrl"
    })
}
]).controller("AffiliateCtrl", ["$location", "$rootScope", "$scope", "$window", function(a, e, i, t) {
    window.myscope = i,
    function e() {
        i.user ? firebase.database().ref("affiliates/" + firebase.auth().currentUser.uid + "/affiliateIds").once("value", function(e) {
            return e.val() ? (i.affiliateIds = Object.keys(e.val()),
            i.affiliateId = i.affiliateIds[0],
            i.initMonths()) : a.path("home"),
            void (i.$$phase || i.$apply())
        }) : setTimeout(e, 2e3)
    }(),
    i.initMonths = function() {
        var a, t, r = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], s = parseInt(i.month, 10), e = new Date, o = 100 * e.getFullYear() + (e.getMonth() + 1);
        firebase.database().ref("affiliateIds/" + i.affiliateId + "/startMonth").once("value", function(e) {
            for (t = e.val(),
            a = o,
            i.months = []; t <= a; )
                i.months.push({
                    label: r[(a - 1) % 100] + " " + Math.floor(a / 100).toString(),
                    value: a.toString()
                }),
                --a % 100 == 0 && (a -= 88);
            (!s || s < t) && (i.month = o.toString()),
            i.$$phase || i.$apply()
        })
    }
    ,
    i.viewReport = function() {
        var a;
        i.generatingReport = !0,
        a = firebase.database().ref("pending").push({
            affiliateId: i.affiliateId,
            month: i.month,
            requestType: "affiliateReport",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        firebase.database().ref("pending/" + a.key + "/report").on("value", function(e) {
            e.val() && (i.generatingReport = !1,
            a.remove(),
            i.reportData = e.val(),
            i.$$phase || i.$apply())
        })
    }
}
]),
angular.module("myApp.championship-admin-competitors", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/admin/competitors", {
        templateUrl: "championship-admin-competitors/championship-admin-competitors.html",
        controller: "ChampionshipAdminCompetitorsCtrl"
    })
}
]).controller("ChampionshipAdminCompetitorsCtrl", ["$location", "$rootScope", "$routeParams", "$scope", "$window", function(a, e, t, s, r) {
    var o, i, n;
    (window.myscope = s).championshipId = t.championshipId,
    window.championshipAdminTab = "competitors",
    function e() {
        s.user ? s.user.championshipAdmin && s.user.championshipAdmin[s.championshipId] || (a.path("championships/" + s.championshipId + "/overview"),
        s.$$phase || s.$apply()) : setTimeout(e, 2e3)
    }(),
    firebase.database().ref("championships/" + s.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (s.championshipTitle = e.val().title,
        s.eventNames = e.val().eventNames,
        s.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        s.hasCompetitors = e.val().hasCompetitors,
        s.hasFinals = e.val().hasFinals,
        s.hasGroups = e.val().hasGroups,
        s.hasQualifiers = e.val().hasQualifiers,
        s.hasSeeding = e.val().hasSeeding,
        s.hasScores = e.val().hasScores,
        s.hasSponsors = e.val().hasSponsors,
        s.showBestScores = e.val().showBestScores,
        s.showMatches = e.val().showMatches,
        s.viewMatches = e.val().viewMatches,
        s.$$phase || s.$apply())
    }),
    firebase.database().ref("championships/" + s.championshipId + "/competitors").on("value", function(e) {
        o = e.val() || {},
        function() {
            var e, a;
            for (s.competitors = [],
            a = Object.keys(o),
            e = 0; e < a.length; e++)
                s.competitors.push(o[a[e]]),
                s.competitors[s.competitors.length - 1].userId = a[e];
            s.competitors.sort(function(e, a) {
                return !e.seed || e.seed > a.seed ? 1 : -1
            })
        }(),
        s.competitorsLoaded = !0,
        s.$$phase || s.$apply()
    }),
    firebase.database().ref("championships/" + s.championshipId + "/matchesSummary").limitToFirst(1).on("value", function(e) {
        n = e.exists(),
        s.$$phase || s.$apply()
    }),
    s.addCompetitor = function() {
        var a;
        s.saveEnabled ? alert("Please save your changes before adding a competitor.") : (a = firebase.database().ref("addCompetitor").push({
            championshipId: s.championshipId,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid,
            username: s.addCompetitorUsername.toLowerCase()
        }),
        s.addingCompetitor = !0,
        firebase.database().ref("addCompetitor/" + a.key).on("value", function(e) {
            e = e.val();
            e && e.done && (firebase.database().ref("addCompetitor/" + a.key).off(),
            a.remove(),
            s.addingCompetitor = !1,
            e.returnUserId ? s.addCompetitorUsername = "" : $(".ui.modal.noCompetitor").modal("setting", {
                onApprove: function() {}
            }).modal("show"),
            s.$$phase || s.$apply())
        }))
    }
    ,
    s.deleteCompetitor = function(e) {
        s.saveEnabled ? alert("Please save your changes before deleting a competitor.") : window.confirm("Are you sure you want to delete the competitor " + e.name + "?") && firebase.database().ref("championships/" + s.championshipId + "/competitors/" + e.userId).remove()
    }
    ,
    s.createMatchesEnabled = function() {
        var e, a, t, r;
        if (!s.competitors || !s.competitors.length || n || i || s.saveEnabled)
            return !1;
        for (e = !0,
        a = {},
        r = 0; r < s.competitors.length; r++) {
            if (!s.competitors[r].group) {
                e = !1;
                break
            }
            a[s.competitors[r].group] ? a[s.competitors[r].group]++ : a[s.competitors[r].group] = 1
        }
        for (t = Object.keys(a),
        r = 0; r < t.length; r++)
            if (4 !== a[t[r]]) {
                e = !1;
                break
            }
        return e
    }
    ,
    s.createMatchesClick = function() {
        i = !0,
        firebase.database().ref("createChampionshipMatches/" + s.championshipId).set(!0),
        s.$$phase || s.$apply()
    }
    ,
    s.enableSave = function() {
        s.saveEnabled = !0,
        s.$$phase || s.$apply()
    }
    ,
    s.saveClick = function() {
        for (var e = angular.copy(s.competitors), a = {}, t = 0; t < e.length; t++)
            a[e[t].userId] = e[t],
            a[e[t].userId].name = (a[e[t].userId].firstName + " " + a[e[t].userId].lastName).trim(),
            e[t].seed && (a[e[t].userId].seed = parseInt(e[t].seed, 10));
        firebase.database().ref("championships/" + s.championshipId + "/competitors").set(a),
        s.saveEnabled = !1,
        s.$$phase || s.$apply()
    }
    ,
    s.$on("$destroy", function() {
        $(".ui.modal.noCompetitor").modal("hide"),
        $(".ui.modal.noCompetitor").remove()
    })
}
]),
angular.module("myApp.championship-admin-config", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/admin/config", {
        templateUrl: "championship-admin-config/championship-admin-config.html",
        controller: "ChampionshipAdminConfigCtrl"
    })
}
]).controller("ChampionshipAdminConfigCtrl", ["$location", "$rootScope", "$routeParams", "$scope", "$window", function(a, e, t, r, s) {
    (window.myscope = r).championshipId = t.championshipId,
    window.championshipAdminTab = "config",
    function e() {
        r.user ? r.user.championshipAdmin[r.championshipId] || (a.path("championships/" + r.championshipId + "/overview"),
        r.$$phase || r.$apply()) : setTimeout(e, 2e3)
    }(),
    firebase.database().ref("championships/" + r.championshipId + "/commonConfig").on("value", function(e) {
        r.commonConfigLoaded = !0,
        e.exists() && (r.championshipTitle = e.val().title,
        r.eventNames = e.val().eventNames,
        r.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        r.hasCompetitors = e.val().hasCompetitors,
        r.hasFinals = e.val().hasFinals,
        r.hasGroups = e.val().hasGroups,
        r.hasQualifiers = e.val().hasQualifiers,
        r.hasSeeding = e.val().hasSeeding,
        r.hasScores = e.val().hasScores,
        r.hasSponsors = e.val().hasSponsors,
        r.showBestScores = e.val().showBestScores,
        r.showMatches = e.val().showMatches,
        r.viewMatches = e.val().viewMatches,
        r.$$phase || r.$apply())
    }),
    firebase.database().ref("championships/" + r.championshipId + "/config").on("value", function(e) {
        r.configLoaded = !0,
        e.exists() && (r.config = e.val(),
        r.$$phase || r.$apply())
    }),
    firebase.database().ref("championships/" + r.championshipId + "/overviewHTML").on("value", function(e) {
        r.overviewHtmlLoaded = !0,
        e.exists() && (r.overviewHTML = e.val(),
        r.$$phase || r.$apply())
    }),
    firebase.database().ref("championshipsPrivate/" + r.championshipId + "/imagesSet").on("value", function(e) {
        r.imagesSet = e.val() || 0,
        r.$$phase || r.$apply()
    }),
    firebase.database().ref("championshipsPrivate/" + r.championshipId + "/namesSet").on("value", function(e) {
        r.namesSet = e.val() || 0,
        r.$$phase || r.$apply()
    }),
    r.saveClick = function() {
        var e, a, t = parseInt(r.config.tables, 10);
        1 <= t && t <= 100 ? (e = parseInt(r.imagesSet, 10),
        isNaN(e) ? alert("Invalid images set!") : (a = parseInt(r.namesSet, 10),
        isNaN(a) ? alert("Invalid names set!") : (firebase.database().ref("championships/" + r.championshipId + "/commonConfig").update({
            title: r.championshipTitle
        }),
        firebase.database().ref("championships/" + r.championshipId + "/config").update({
            tables: t
        }),
        firebase.database().ref("championships/" + r.championshipId + "/overviewHTML").set(r.overviewHTML),
        firebase.database().ref("championshipsPrivate/" + r.championshipId + "/imagesSet").set(e),
        firebase.database().ref("championshipsPrivate/" + r.championshipId + "/namesSet").set(a),
        r.saveEnabled = !1,
        r.$$phase || r.$apply()))) : alert("Invalid number of tables!")
    }
}
]),
angular.module("myApp.championship-admin-matches", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/admin/games", {
        templateUrl: "championship-admin-matches/championship-admin-matches.html",
        controller: "ChampionshipAdminMatchesCtrl"
    }),
    e.when("/championships/:championshipId/admin/matches", {
        templateUrl: "championship-admin-matches/championship-admin-matches.html",
        controller: "ChampionshipAdminMatchesCtrl"
    })
}
]).controller("ChampionshipAdminMatchesCtrl", ["$location", "$rootScope", "$routeParams", "$scope", "$window", function(a, e, t, i, r) {
    var n, c;
    (window.myscope = i).championshipId = t.championshipId,
    i.matchesSummary = [],
    i.matchStart = window.championshipAdminMatchStart || "1",
    window.championshipAdminTab = "matches",
    function e() {
        i.user ? i.user.championshipAdmin[i.championshipId] || (a.path("championships/" + i.championshipId + "/overview"),
        i.$$phase || i.$apply()) : setTimeout(e, 2e3)
    }(),
    firebase.database().ref("championships/" + i.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (i.championshipTitle = e.val().title,
        i.eventNames = e.val().eventNames,
        i.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        i.hasCompetitors = e.val().hasCompetitors,
        i.hasFinals = e.val().hasFinals,
        i.hasGroups = e.val().hasGroups,
        i.hasQualifiers = e.val().hasQualifiers,
        i.hasSeeding = e.val().hasSeeding,
        i.hasScores = e.val().hasScores,
        i.hasSponsors = e.val().hasSponsors,
        i.showBestScores = e.val().showBestScores,
        i.showMatches = e.val().showMatches,
        i.viewMatches = e.val().viewMatches,
        i.$$phase || i.$apply())
    }),
    firebase.database().ref("championships/" + i.championshipId + "/config/tables").once("value", function(e) {
        i.tables = e.val() || 1,
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("championshipsPrivate/" + i.championshipId + "/imagesSet").on("value", function(e) {
        n = e.val() || 0
    }),
    firebase.database().ref("championshipsPrivate/" + i.championshipId + "/namesSet").on("value", function(e) {
        c = e.val() || 0
    }),
    firebase.database().ref("championships/" + i.championshipId + "/competitors").on("value", function(e) {
        i.competitors = e.val() || {},
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("championships/" + i.championshipId + "/matchesSummary").on("child_added", function(e) {
        i.matchesSummary.push(e.val()),
        i.matchesSummary[i.matchesSummary.length - 1].key = e.key,
        i.matchesSummary.sort(function(e, a) {
            return e.key > a.key ? 1 : -1
        }),
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("championships/" + i.championshipId + "/matchesSummary").on("child_changed", function(e) {
        for (var a = 0; a < i.matchesSummary.length; a++)
            if (i.matchesSummary[a].key === e.key) {
                i.matchesSummary[a] = e.val(),
                i.matchesSummary[a].key = e.key,
                i.$$phase || i.$apply();
                break
            }
    }),
    firebase.database().ref("championships/" + i.championshipId + "/matchesSummary").on("child_removed", function(e) {
        for (var a = 0; a < i.matchesSummary.length; a++)
            if (i.matchesSummary[a].key === e.key) {
                i.matchesSummary.splice(a, 1),
                i.$$phase || i.$apply();
                break
            }
    }),
    i.matchStartChange = function() {
        parseInt(i.matchStart, 10) && (window.championshipAdminMatchStart = i.matchStart)
    }
    ,
    i.showMatch = function(e) {
        var a = parseInt(i.matchStart, 10);
        return !!a && (a <= e + 1 && e + 1 < a + 100)
    }
    ,
    i.showOpen = function(e) {
        var a;
        if (!i.matchesSummary || !i.matchesSummary[e])
            return !1;
        if ("Completed" === i.matchesSummary[e].status || "Surprise" === i.matchesSummary[e].eventName || "-1" === i.matchesSummary[e].eventName || "-1" === i.matchesSummary[e].competitors[0].competitorId || "-1" === i.matchesSummary[e].competitors[1].competitorId)
            return !1;
        for (a = 0; a < i.matchesSummary.length; a += 1) {
            if ("In Progress" === i.matchesSummary[a].status)
                return !1;
            if (a != e && i.matchesSummary[a].open && (i.matchesSummary[a].competitors[0].competitorId === i.matchesSummary[e].competitors[0].competitorId || i.matchesSummary[a].competitors[0].competitorId === i.matchesSummary[e].competitors[1].competitorId || i.matchesSummary[a].competitors[1].competitorId === i.matchesSummary[e].competitors[0].competitorId || i.matchesSummary[a].competitors[1].competitorId === i.matchesSummary[e].competitors[1].competitorId || i.matchesSummary[a].tableNum === i.matchesSummary[e].tableNum))
                return !1
        }
        return !0
    }
    ,
    i.showStart = function() {
        var e, a, t;
        if (!i.matchesSummary || !i.matchesSummary.length)
            return !1;
        for (t = !(e = !0),
        a = 0; a < i.matchesSummary.length; a += 1)
            if (i.matchesSummary[a].open && (t = !0,
            "Ready" !== i.matchesSummary[a].competitors[0].status || "Ready" !== i.matchesSummary[a].competitors[1].status)) {
                e = !1;
                break
            }
        return t && e
    }
    ,
    i.tableNumChanged = function(e, a) {
        firebase.database().ref("championships/" + i.championshipId + "/matchesSummary/" + e + "/tableNum").set(a)
    }
    ,
    i.eventChanged = function(e, a) {
        firebase.database().ref("championships/" + i.championshipId + "/matchesSummary/" + e + "/eventName").set(a)
    }
    ,
    i.openClick = function(e) {
        var a = i.matchesSummary[e].key;
        firebase.database().ref("prepareChampionshipMatch").push({
            championshipId: i.championshipId,
            matchKey: a,
            open: i.matchesSummary[e].open
        }),
        i.$$phase || i.$apply()
    }
    ,
    i.startClick = function() {
        for (var e, a = [], t = [], r = !1, s = !1, o = 0; o < i.matchesSummary.length; o += 1)
            i.matchesSummary[o].open && (e = i.matchesSummary[o].matchUrl,
            a.push({
                matchId: e.substr(e.indexOf("/") + 1),
                matchKey: i.matchesSummary[o].key
            }),
            t.push(i.matchesSummary[o].competitors[0].competitorId),
            t.push(i.matchesSummary[o].competitors[1].competitorId),
            "Images" === i.matchesSummary[o].eventName && (r = !0),
            "International Names" !== i.matchesSummary[o].eventName && "Names" !== i.matchesSummary[o].eventName || (s = !0));
        a.length && (firebase.database().ref("startChampionshipMatches").push({
            championshipId: i.championshipId,
            matches: a,
            userIds: t
        }),
        r && -1 !== n && firebase.database().ref("championshipsPrivate/" + i.championshipId + "/imagesSet").set(n + 1),
        s && -1 !== c && firebase.database().ref("championshipsPrivate/" + i.championshipId + "/namesSet").set(c + 1))
    }
    ,
    i.winner = function(e) {
        switch (e.result) {
        case "-1":
            return "";
        case "0":
        case "1":
            return i.competitors[e.competitors[parseInt(e.result, 10)].competitorId] ? i.competitors[e.competitors[parseInt(e.result, 10)].competitorId].shortName : "";
        case "2":
            return "Draw"
        }
    }
    ,
    i.winnerChanged = function(e) {
        var a = i.matchesSummary[e].key;
        firebase.database().ref("championships/" + i.championshipId + "/matchesSummary/" + a).update({
            result: i.matchesSummary[e].result,
            status: "-1" === i.matchesSummary[e].result ? "Not Started" : "Completed"
        })
    }
}
]),
angular.module("myApp.championship-admin-seeding", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/admin/seeding", {
        templateUrl: "championship-admin-seeding/championship-admin-seeding.html",
        controller: "ChampionshipAdminSeedingCtrl"
    })
}
]).controller("ChampionshipAdminSeedingCtrl", ["$location", "$rootScope", "$routeParams", "$scope", "$window", function(a, e, t, l, r) {
    var o;
    function p(e, a, t) {
        var r;
        switch (e) {
        case "Cards":
            r = 52;
            break;
        case "Images":
        case "Names":
            r = 30;
            break;
        case "Numbers":
            r = 80;
            break;
        case "Words":
            r = 50
        }
        return a === r ? 60 * a / t : a
    }
    function s() {
        var e, a, t, r, s;
        for (l.competitors = [],
        a = ["Cards", "Images", "Names", "Numbers", "Words"],
        s = Object.keys(l.competitorsObj),
        t = 0; t < s.length; t++)
            e = l.competitorsObj[s[t]],
            l.competitors.push(e),
            l.competitors[l.competitors.length - 1].competitorId = s[t],
            l.competitors[l.competitors.length - 1].seedings = {},
            a.forEach(function(e) {
                if (o && o[e])
                    for (r = 0; r < o[e].length; r++)
                        o[e][r].competitorId === s[t] && (l.competitors[l.competitors.length - 1].seedings[e] = o[e][r])
            });
        l.competitors.sort(function(e, a) {
            return e.name > a.name ? 1 : -1
        }),
        l.competitorsReady = !0
    }
    (window.myscope = l).championshipId = t.championshipId,
    window.championshipAdminTab = "seeding",
    function e() {
        l.user ? l.user.championshipAdmin[l.championshipId] || (a.path("championships/" + l.championshipId + "/overview"),
        l.$$phase || l.$apply()) : setTimeout(e, 2e3)
    }(),
    firebase.database().ref("championships/" + l.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (l.championshipTitle = e.val().title,
        l.eventNames = e.val().eventNames,
        l.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        l.hasCompetitors = e.val().hasCompetitors,
        l.hasFinals = e.val().hasFinals,
        l.hasGroups = e.val().hasGroups,
        l.hasQualifiers = e.val().hasQualifiers,
        l.hasSeeding = e.val().hasSeeding,
        l.hasScores = e.val().hasScores,
        l.hasSponsors = e.val().hasSponsors,
        l.showBestScores = e.val().showBestScores,
        l.showMatches = e.val().showMatches,
        l.viewMatches = e.val().viewMatches,
        l.$$phase || l.$apply())
    }),
    firebase.database().ref("championships/" + l.championshipId + "/competitors").on("value", function(e) {
        l.competitorsObj = e.val() || {},
        s(),
        l.$$phase || l.$apply()
    }),
    firebase.database().ref("championships/" + l.championshipId + "/seedings").on("value", function(e) {
        o = e.val() || {},
        s(),
        l.$$phase || l.$apply()
    }),
    $(".menu .item").tab(),
    l.setSeedsEnabled = function() {
        var a, t;
        if (!l.competitors || !l.eventNames || l.saveEnabled)
            return !1;
        for (a = !0,
        t = 0; t < l.competitors.length; t++)
            l.eventNames.forEach(function(e) {
                l.competitors[t].seedings && l.competitors[t].seedings[e] && l.competitors[t].seedings[e].memoTime || (a = !1)
            });
        return a
    }
    ,
    l.setSeedsClick = function() {
        for (var e = 0; e < o.total.length; e++)
            firebase.database().ref("championships/" + l.championshipId + "/competitors/" + o.total[e].competitorId).update({
                seed: e + 1
            });
        alert("The seeds have been set!")
    }
    ,
    l.enableSave = function() {
        l.saveEnabled = !0,
        l.$$phase || l.$apply()
    }
    ,
    l.saveClick = function() {
        var a, t, r, s, o, i, n, e = ["Cards", "Images", "Names", "Numbers", "Words"], c = {}, m = !1;
        if (e.forEach(function(e) {
            for (c[e] = [],
            r = 0; r < l.competitors.length; r++) {
                if (l.competitors[r].seedings[e] && (l.competitors[r].seedings[e].score || l.competitors[r].seedings[e].memoTime)) {
                    if (!(i = parseInt(l.competitors[r].seedings[e].score, 10)) && 0 !== i) {
                        alert("Invalid " + e + " data for " + l.competitors[r].name),
                        m = !0;
                        break
                    }
                    if (!(s = parseFloat(l.competitors[r].seedings[e].memoTime))) {
                        alert("Invalid " + e + " data for " + l.competitors[r].name),
                        m = !0;
                        break
                    }
                }
                l.competitors[r].seedings[e] && l.competitors[r].seedings[e].memoTime && parseFloat(l.competitors[r].seedings[e].memoTime) && c[e].push({
                    competitorId: l.competitors[r].competitorId,
                    memoTime: s,
                    score: i
                })
            }
            if (c[e].length)
                for (c[e].sort(function(e, a) {
                    return e.score > a.score || e.score === a.score && e.memoTime < a.memoTime ? -1 : 1
                }),
                a = p(e, c[e][0].score, c[e][0].memoTime),
                r = 0; r < c[e].length; r++)
                    n = p(e, c[e][r].score, c[e][r].memoTime),
                    c[e][r].points = 100 * n / a,
                    c[e][r].points = Math.round(100 * c[e][r].points) / 100,
                    0 === r ? c[e][r].rank = 1 : c[e][r].points === c[e][r - 1].points ? c[e][r].rank = c[e][r - 1].rank : c[e][r].rank = r + 1
        }),
        !m) {
            for (o = {},
            e.forEach(function(e) {
                for (r = 0; r < c[e].length; r++)
                    t = c[e][r].competitorId,
                    o[t] || (o[t] = 0),
                    o[t] += c[e][r].points
            }),
            c.total = [],
            Object.keys(o).forEach(function(e) {
                c.total.push({
                    competitorId: e,
                    points: o[e]
                })
            }),
            c.total.sort(function(e, a) {
                return a.points - e.points
            }),
            r = 0; r < c.total.length; r++)
                0 === r ? c.total[r].rank = 1 : c.total[r].points === c.total[r - 1].points ? c.total[r].rank = c.total[r - 1].rank : c.total[r].rank = r + 1;
            firebase.database().ref("championships/" + l.championshipId + "/seedings").set(c),
            l.saveEnabled = !1,
            l.$$phase || l.$apply()
        }
    }
}
]),
angular.module("myApp.championship-best-scores", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/bestscores", {
        templateUrl: "championship-best-scores/championship-best-scores.html",
        controller: "ChampionshipBestScoresCtrl"
    })
}
]).controller("ChampionshipBestScoresCtrl", ["$rootScope", "$routeParams", "$scope", "$window", function(e, a, t, r) {
    (window.myscope = t).adminTab = window.championshipAdminTab || "config",
    t.championshipId = a.championshipId,
    firebase.database().ref("championships/" + t.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (t.championshipTitle = e.val().title,
        t.eventNames = e.val().eventNames,
        t.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        t.hasCompetitors = e.val().hasCompetitors,
        t.hasFinals = e.val().hasFinals,
        t.hasGroups = e.val().hasGroups,
        t.hasQualifiers = e.val().hasQualifiers,
        t.hasSeeding = e.val().hasSeeding,
        t.hasScores = e.val().hasScores,
        t.hasSponsors = e.val().hasSponsors,
        t.showBestScores = e.val().showBestScores,
        t.showMatches = e.val().showMatches,
        t.viewMatches = e.val().viewMatches,
        t.$$phase || t.$apply())
    }),
    firebase.database().ref("championships/" + t.championshipId + "/competitors").on("value", function(e) {
        t.competitors = e.val(),
        t.$$phase || t.$apply()
    }),
    firebase.database().ref("championships/" + t.championshipId + "/bestScores").on("value", function(e) {
        t.bestScores = e.val() || {},
        t.$$phase || t.$apply()
    }),
    firebase.database().ref("championships/" + t.championshipId + "/previousWorldRecords").on("value", function(e) {
        t.previousWorldRecords = e.val(),
        t.$$phase || t.$apply()
    }),
    $(".menu .item").tab(),
    t.competitorClick = function(e) {
        t.competitor = t.competitors[e],
        $(".ui.modal.competitor").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    t.$on("$destroy", function() {
        $(".ui.modal.competitor").modal("hide"),
        $(".ui.modal.competitor").remove()
    })
}
]),
angular.module("myApp.championship-compete", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/compete", {
        templateUrl: "championship-compete/championship-compete.html",
        controller: "ChampionshipCompeteCtrl"
    })
}
]).controller("ChampionshipCompeteCtrl", ["$location", "$rootScope", "$routeParams", "$scope", "$window", function(t, e, a, r, s) {
    var o;
    (window.myscope = r).championshipId = a.championshipId,
    firebase.database().ref("championships/" + r.championshipId + "/commonConfig/title").on("value", function(e) {
        e.exists() && (r.championshipTitle = e.val(),
        r.$$phase || r.$apply())
    }),
    r.submitCode = function() {
        r.code && (o = firebase.database().ref("competeCode").push({
            championshipId: r.championshipId,
            code: r.code,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        r.status = "checking",
        r.$$phase || r.$apply(),
        firebase.database().ref("competeCode/" + o.key).on("value", function(e) {
            var a = e.val();
            a && a.done && (firebase.database().ref("competeCode/" + o.key).off(),
            o.remove(),
            a.token ? firebase.auth().signInWithCustomToken(a.token).catch(function(e) {
                console.log(e)
            }).then(function() {
                t.path(a.matchUrl)
            }) : (r.status = "",
            r.$$phase || r.$apply()))
        }))
    }
    ,
    r.$on("$destroy", function() {
        o && (firebase.database().ref("competeCode/" + o.key).off(),
        o = null)
    })
}
]),
angular.module("myApp.championship-competitors", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/competitors", {
        templateUrl: "championship-competitors/championship-competitors.html",
        controller: "ChampionshipCompetitorsCtrl"
    })
}
]).controller("ChampionshipCompetitorsCtrl", ["$compile", "$rootScope", "$routeParams", "$scope", "$window", function(e, a, t, r, s) {
    var o;
    (window.myscope = r).adminTab = window.championshipAdminTab || "config",
    r.championshipId = t.championshipId,
    firebase.database().ref("championships/" + r.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (r.championshipTitle = e.val().title,
        r.eventNames = e.val().eventNames,
        r.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        r.hasCompetitors = e.val().hasCompetitors,
        r.hasFinals = e.val().hasFinals,
        r.hasGroups = e.val().hasGroups,
        r.hasQualifiers = e.val().hasQualifiers,
        r.hasSeeding = e.val().hasSeeding,
        r.hasScores = e.val().hasScores,
        r.hasSponsors = e.val().hasSponsors,
        r.showBestScores = e.val().showBestScores,
        r.showMatches = e.val().showMatches,
        r.viewMatches = e.val().viewMatches,
        r.$$phase || r.$apply())
    }),
    firebase.database().ref("championships/" + r.championshipId + "/competitors").on("value", function(e) {
        o = e.val() || {},
        function() {
            var e, a;
            for (r.competitors = [],
            a = Object.keys(o),
            e = 0; e < a.length; e++)
                r.competitors.push(o[a[e]]),
                r.competitors[r.competitors.length - 1].competitorId = a[e];
            r.competitors.sort(function(e, a) {
                return e.name < a.name ? -1 : (e.name,
                a.name,
                1)
            })
        }(),
        r.$$phase || r.$apply()
    }),
    r.competitorClick = function(e) {
        r.competitor = e,
        $(".ui.modal.competitor").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    r.$on("$destroy", function() {
        $(".ui.modal.competitor").modal("hide"),
        $(".ui.modal.competitor").remove()
    })
}
]),
angular.module("myApp.championship-finals", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/finals", {
        templateUrl: "championship-finals/championship-finals.html",
        controller: "ChampionshipFinalsCtrl"
    })
}
]).directive("ngXlinkHref", function() {
    return {
        priority: 99,
        restrict: "A",
        link: function(e, a, t) {
            t.$observe("ngXlinkHref", function(e) {
                e && "/" !== e.slice(-1) && t.$set("xlink:href", e)
            })
        }
    }
}).controller("ChampionshipFinalsCtrl", ["$location", "$rootScope", "$routeParams", "$scope", "$window", function(a, r, e, s, t) {
    (window.myscope = s).adminTab = window.championshipAdminTab || "config",
    s.championshipId = e.championshipId,
    firebase.database().ref("championships/" + s.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (s.championshipTitle = e.val().title,
        s.eventNames = e.val().eventNames,
        s.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        s.hasCompetitors = e.val().hasCompetitors,
        s.hasFinals = e.val().hasFinals,
        s.hasGroups = e.val().hasGroups,
        s.hasQualifiers = e.val().hasQualifiers,
        s.hasSeeding = e.val().hasSeeding,
        s.hasScores = e.val().hasScores,
        s.hasSponsors = e.val().hasSponsors,
        s.showBestScores = e.val().showBestScores,
        s.showMatches = e.val().showMatches,
        s.viewMatches = e.val().viewMatches,
        s.$$phase || s.$apply())
    }),
    firebase.database().ref("championships/" + s.championshipId + "/config/finals").on("value", function(e) {
        s.bestOf = e.val().bestOf,
        s.finalsCount = e.val().finalsCount,
        s.thirdPlace = e.val().thirdPlace,
        s.consolationThirdPlace = e.val().consolationThirdPlace,
        s.$$phase || s.$apply()
    }),
    firebase.database().ref("championships/" + s.championshipId + "/competitors").on("value", function(e) {
        s.competitors = e.val() || {},
        s.$$phase || s.$apply()
    }),
    firebase.database().ref("championships/" + s.championshipId + "/finals").on("value", function(e) {
        s.finals = e.val() || {},
        s.$$phase || s.$apply()
    }),
    function e() {
        r.user ? function() {
            var e, a, t = r.user.upcomingMatches;
            if (t)
                for (a = Object.keys(t),
                e = 0; e < a.length; e++)
                    t[a[e]].championshipId === s.championshipId && (s.showScheduling = !0,
                    s.$$phase || s.$apply())
        }() : setTimeout(e, 1e3)
    }(),
    $(".menu .item").tab(),
    s.competitorClick = function(e) {
        e && (s.competitor = s.competitors[e],
        $(".ui.modal.competitor").modal("setting", {
            onApprove: function() {}
        }).modal("show"))
    }
    ,
    s.finalsClick = function(e) {
        a.path("/championships/" + s.championshipId + "/games/" + e)
    }
    ,
    s.updateScore = function(e, a) {
        var t = window.prompt("Enter score:", 0);
        !t && "0" !== t || (t = t.replace(",", "."),
        isNaN(t) || (t = parseFloat(t),
        firebase.database().ref("championships/" + s.championshipId + "/finals/" + e + "/" + a).set(t)))
    }
    ,
    s.$on("$destroy", function() {
        $(".ui.modal.competitor").modal("hide"),
        $(".ui.modal.competitor").remove()
    })
}
]),
angular.module("myApp.championship-groups", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/groups", {
        templateUrl: "championship-groups/championship-groups.html",
        controller: "ChampionshipGroupsCtrl"
    })
}
]).directive("contenteditable", function() {
    return {
        restrict: "A",
        require: "ngModel",
        link: function(a, e, t, r) {
            function s() {
                r.$setViewValue(e.html())
            }
            r.$render = function() {
                e.html(r.$viewValue)
            }
            ,
            e.bind("keydown", function(e) {
                13 !== e.which && 27 !== e.which || (e.target.blur(),
                e.preventDefault())
            }),
            e.bind("blur keyup change", function(e) {
                a.$apply(s)
            })
        }
    }
}).controller("ChampionshipGroupsCtrl", ["$compile", "$rootScope", "$routeParams", "$scope", "$window", function(e, a, t, s, r) {
    var o;
    window.myscope = s;
    var i = {};
    s.adminTab = window.championshipAdminTab || "config",
    s.championshipId = t.championshipId,
    s.groups = [],
    firebase.database().ref("championships/" + s.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (s.championshipTitle = e.val().title,
        s.eventNames = e.val().eventNames,
        s.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        s.hasCompetitors = e.val().hasCompetitors,
        s.hasFinals = e.val().hasFinals,
        s.hasGroups = e.val().hasGroups,
        s.hasQualifiers = e.val().hasQualifiers,
        s.hasSeeding = e.val().hasSeeding,
        s.hasScores = e.val().hasScores,
        s.hasSponsors = e.val().hasSponsors,
        s.showBestScores = e.val().showBestScores,
        s.showMatches = e.val().showMatches,
        s.viewMatches = e.val().viewMatches,
        s.$$phase || s.$apply())
    }),
    firebase.database().ref("championships/" + s.championshipId + "/competitors").on("value", function(e) {
        o = e.val() || {},
        function() {
            var e, a, t;
            for (s.competitors = [],
            e = {},
            t = Object.keys(o),
            a = 0; a < t.length; a++)
                s.competitors.push(o[t[a]]),
                s.competitors[s.competitors.length - 1].competitorId = t[a],
                s.competitors[s.competitors.length - 1].group && (e[s.competitors[s.competitors.length - 1].group] = !0);
            s.groups = Object.keys(e),
            s.groups.sort(function(e, a) {
                return a < e ? 1 : -1
            }),
            s.competitors.sort(function(e, a) {
                return e.groupResults.sortIndex < a.groupResults.sortIndex ? -1 : e.groupResults.sortIndex > a.groupResults.sortIndex || e.groupResults.points < a.groupResults.points ? 1 : e.groupResults.points > a.groupResults.points ? -1 : e.groupResults.percentRecall < a.groupResults.percentRecall ? 1 : e.groupResults.percentRecall > a.groupResults.percentRecall ? -1 : e.groupResults.gamesWon < a.groupResults.gamesWon ? 1 : e.groupResults.gamesWon > a.groupResults.gamesWon || e.seed < a.seed ? -1 : e.seed > a.seed ? 1 : e.name < a.name ? -1 : (e.name,
                a.name,
                1)
            })
        }(),
        s.$$phase || s.$apply()
    }),
    "japan2023" === s.championshipId && firebase.database().ref("championships/japan2023/playoffs").on("value", function(e) {
        s.playoffs = e.val() || [],
        s.$$phase || s.$apply()
    }),
    s.position = function(e) {
        var a, t, r;
        if (!s.competitors)
            return 0;
        if (!(a = e.competitorId) && 0 !== a)
            return 0;
        for (r = 1,
        t = 0; t < s.competitors.length; t += 1)
            s.competitors[t].competitorId !== a && s.competitors[t].group === e.group && (s.competitors[t].groupResults.points > e.groupResults.points || s.competitors[t].groupResults.points === e.groupResults.points && s.competitors[t].groupResults.percentRecall > e.groupResults.percentRecall || s.competitors[t].groupResults.points === e.groupResults.points && s.competitors[t].groupResults.percentRecall === e.groupResults.percentRecall && s.competitors[t].groupResults.gamesWon > e.groupResults.gamesWon) && (r += 1);
        return r
    }
    ,
    s.fieldFocus = function(e) {
        s.origValue = parseFloat(e)
    }
    ,
    s.fieldBlur = function(e, a, t, r) {
        r = r.toString().replace(/<\/?[^>]+(>|$)/g, "");
        (r = parseFloat(r)) !== s.origValue && (isNaN(r) ? e.target.innerHTML = s.origValue : i[a.competitorId + "/groupResults/" + t] = r),
        s.dataChanged = !0
    }
    ,
    s.save = function() {
        console.log(i),
        firebase.database().ref("championships/" + s.championshipId + "/competitors").update(i),
        i = {},
        s.dataChanged = !1
    }
    ,
    s.competitorClick = function(e) {
        s.competitor = e,
        $(".ui.modal.competitor").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.competitorClickById = function(e) {
        s.competitor = o[e],
        $(".ui.modal.competitor").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.updatePlayoffsScore = function(e) {
        var a = window.prompt("Enter score:", 0);
        !a && "0" !== a || (a = a.replace(",", "."),
        isNaN(a) || (a = parseFloat(a),
        firebase.database().ref("championships/" + s.championshipId + "/playoffs/" + e + "/wins").set(a)))
    }
    ,
    s.$on("$destroy", function() {
        $(".ui.modal.competitor").modal("hide"),
        $(".ui.modal.competitor").remove()
    })
}
]),
angular.module("myApp.championship-matches", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/games", {
        templateUrl: "championship-matches/championship-matches.html",
        controller: "ChampionshipMatchesCtrl"
    }),
    e.when("/championships/:championshipId/games/:matchSearch", {
        templateUrl: "championship-matches/championship-matches.html",
        controller: "ChampionshipMatchesCtrl"
    }),
    e.when("/championships/:championshipId/matches", {
        templateUrl: "championship-matches/championship-matches.html",
        controller: "ChampionshipMatchesCtrl"
    }),
    e.when("/championships/:championshipId/matches/:matchSearch", {
        templateUrl: "championship-matches/championship-matches.html",
        controller: "ChampionshipMatchesCtrl"
    })
}
]).controller("ChampionshipMatchesCtrl", ["$rootScope", "$routeParams", "$scope", "$window", function(e, a, o, t) {
    (window.myscope = o).adminTab = window.championshipAdminTab || "config",
    o.championshipId = a.championshipId,
    o.matchSearch = a.matchSearch || "",
    o.matches = [],
    firebase.database().ref("championships/" + o.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (o.championshipTitle = e.val().title,
        o.eventNames = e.val().eventNames,
        o.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        o.hasCompetitors = e.val().hasCompetitors,
        o.hasFinals = e.val().hasFinals,
        o.hasGroups = e.val().hasGroups,
        o.hasQualifiers = e.val().hasQualifiers,
        o.hasSeeding = e.val().hasSeeding,
        o.hasScores = e.val().hasScores,
        o.hasSponsors = e.val().hasSponsors,
        o.showBestScores = e.val().showBestScores,
        o.showMatches = e.val().showMatches,
        o.viewMatches = e.val().viewMatches,
        o.$$phase || o.$apply())
    }),
    firebase.database().ref("championships/" + o.championshipId + "/competitors").on("value", function(e) {
        o.competitors = e.val(),
        o.$$phase || o.$apply()
    }),
    firebase.database().ref("championships/" + o.championshipId + "/matchesSummary").on("value", function(e) {
        var a, t, r = e.val() || {}, s = Object.keys(r);
        for (o.matches = [],
        a = 0; a < s.length; a++)
            (t = r[s[a]]).matchId = s[a],
            o.matches.push(t);
        o.matchesLoaded = !0,
        o.$$phase || o.$apply()
    }),
    o.showMatch = function(e) {
        var a, t;
        if (!(o.competitors && o.competitors[e.competitors[0].competitorId] && o.competitors[e.competitors[0].competitorId].name && o.competitors[e.competitors[1].competitorId] && o.competitors[e.competitors[1].competitorId].name))
            return !1;
        if ("d1" !== e.matchId.substring(0, 2) && "m" !== e.matchId.substring(0, 1) && "Not Started" === e.status)
            return !1;
        if (!o.matchSearch)
            return !0;
        for (t = o.matchSearch.toLowerCase().replace(" vs ", " ").replace(" - ", " ").replace("group ", "group").split(" "),
        a = 0; a < t.length; a += 1)
            if (-1 === e.matchType.toLowerCase().indexOf(t[a].replace("group", "group ")) && -1 === (e.surprise ? "Surprise" : e.eventName).toLowerCase().indexOf(t[a]) && -1 === o.competitors[e.competitors[0].competitorId].name.toLowerCase().indexOf(t[a]) && -1 === o.competitors[e.competitors[1].competitorId].name.toLowerCase().indexOf(t[a]))
                return !1;
        return !0
    }
    ,
    o.competitorClick = function(e) {
        o.competitor = o.competitors[e],
        $(".ui.modal.competitor").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    o.$on("$destroy", function() {
        $(".ui.modal.competitor").modal("hide"),
        $(".ui.modal.competitor").remove()
    })
}
]),
angular.module("myApp.championship-overview", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/overview", {
        templateUrl: "championship-overview/championship-overview.html",
        controller: "ChampionshipOverviewCtrl"
    })
}
]).controller("ChampionshipOverviewCtrl", ["$rootScope", "$routeParams", "$sce", "$scope", "$window", function(r, e, a, s, t) {
    (window.myscope = s).adminTab = window.championshipAdminTab || "config",
    s.championshipId = e.championshipId,
    firebase.database().ref("championships/" + s.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (s.championshipTitle = e.val().title,
        s.eventNames = e.val().eventNames,
        s.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        s.hasCompetitors = e.val().hasCompetitors,
        s.hasFinals = e.val().hasFinals,
        s.hasGroups = e.val().hasGroups,
        s.hasQualifiers = e.val().hasQualifiers,
        s.hasSeeding = e.val().hasSeeding,
        s.hasScores = e.val().hasScores,
        s.hasSponsors = e.val().hasSponsors,
        s.showBestScores = e.val().showBestScores,
        s.showMatches = e.val().showMatches,
        s.$$phase || s.$apply())
    }),
    firebase.database().ref("championships/" + s.championshipId + "/overviewHTML").on("value", function(e) {
        s.overviewHTML = a.trustAsHtml(e.val()),
        s.$$phase || s.$apply()
    }),
    function e() {
        r.user ? function() {
            var e, a, t = r.user.upcomingMatches;
            if (t)
                for (a = Object.keys(t),
                e = 0; e < a.length; e++)
                    t[a[e]].championshipId === s.championshipId && (s.showScheduling = !0,
                    s.$$phase || s.$apply())
        }() : setTimeout(e, 1e3)
    }()
}
]),
angular.module("myApp.championship-qualifiers", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/qualifiers", {
        templateUrl: "championship-qualifiers/championship-qualifiers.html",
        controller: "ChampionshipQualifiersCtrl"
    })
}
]).controller("ChampionshipQualifiersCtrl", ["$compile", "$rootScope", "$routeParams", "$sce", "$scope", "$window", function(a, r, e, t, s, o) {
    var i;
    (window.myscope = s).adminTab = window.championshipAdminTab || "config",
    s.championshipId = e.championshipId,
    firebase.database().ref("championships/" + s.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (s.championshipTitle = e.val().title,
        s.eventNames = e.val().eventNames,
        s.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        s.hasCompetitors = e.val().hasCompetitors,
        s.hasFinals = e.val().hasFinals,
        s.hasGroups = e.val().hasGroups,
        s.hasQualifiers = e.val().hasQualifiers,
        s.hasSeeding = e.val().hasSeeding,
        s.hasScores = e.val().hasScores,
        s.hasSponsors = e.val().hasSponsors,
        s.showBestScores = e.val().showBestScores,
        s.showMatches = e.val().showMatches,
        s.viewMatches = e.val().viewMatches,
        s.$$phase || s.$apply())
    }),
    firebase.database().ref("championships/" + s.championshipId + "/competitors").on("value", function(e) {
        i = e.val() || {},
        s.competitorsObj = i,
        function() {
            var e, a;
            for (s.competitors = [],
            a = Object.keys(i),
            e = 0; e < a.length; e++)
                s.competitors.push(i[a[e]]),
                s.competitors[s.competitors.length - 1].userId = a[e];
            s.competitors.sort(function(e, a) {
                return !e.seed || e.seed > a.seed ? 1 : -1
            })
        }(),
        s.competitorsLoaded = !0,
        s.$$phase || s.$apply()
    }),
    firebase.database().ref("championships/" + s.championshipId + "/qualifiers").on("value", function(e) {
        e.exists() && (s.qualifiers = e.val(),
        $("#qualifiersHtml").html(""),
        e = $(s.qualifiers.html).appendTo("#qualifiersHtml"),
        a(e)(s),
        s.$$phase || s.$apply())
    }),
    function e() {
        r.user ? function() {
            var e, a, t = r.user.upcomingMatches;
            if (t)
                for (a = Object.keys(t),
                e = 0; e < a.length; e++)
                    t[a[e]].championshipId === s.championshipId && (s.showScheduling = !0,
                    s.$$phase || s.$apply())
        }() : setTimeout(e, 1e3)
    }(),
    $(".menu .item").tab(),
    s.competitorClick = function(e) {
        s.competitor = s.competitors[e],
        $(".ui.modal.competitor").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.competitorClick2 = function(e) {
        s.competitor = i[e],
        $(".ui.modal.competitor").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.$on("$destroy", function() {
        $(".ui.modal.competitor").modal("hide"),
        $(".ui.modal.competitor").remove()
    })
}
]),
angular.module("myApp.championship-scheduling", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/scheduling", {
        templateUrl: "championship-scheduling/championship-scheduling.html",
        controller: "ChampionshipSchedulingCtrl"
    })
}
]).controller("ChampionshipSchedulingCtrl", ["$compile", "$location", "$rootScope", "$routeParams", "$sce", "$scope", "$window", function(e, a, s, t, r, i, o) {
    var n, c, m, l, p, u, h, d, f;
    function g(e) {
        return e.getFullYear() + "-" + (e.getMonth() + 1 < 10 ? "0" : "") + (e.getMonth() + 1) + "-" + (e.getDate() < 10 ? "0" : "") + e.getDate() + " " + (e.getHours() < 10 ? "0" : "") + e.getHours() + ":" + (e.getMinutes() < 10 ? "0" : "") + e.getMinutes()
    }
    function b() {
        var e, a, t, r;
        if (d = firebase.auth().currentUser.uid,
        r = s.user.upcomingMatches)
            for (t = Object.keys(r),
            e = 0; e < t.length; e++)
                r[a = t[e]].championshipId === i.championshipId && (m = r[a].opponentId,
                u = "scheduledSlamMatches/",
                u += d < m ? d + "/" + m : m + "/" + d,
                i.discussionUrl = r[a].discussionUrl,
                i.round = r[a].round,
                l = r[a].expiry,
                p = r[a].fromTime,
                i.competitorsObj[m] && i.competitorsObj[d] && (i.opponentFlag = i.competitorsObj[m].flag || "",
                i.opponentName = (i.competitorsObj[m].firstName + " " + i.competitorsObj[m].lastName).trim(),
                i.selfFlag = i.competitorsObj[d].flag || "",
                f = (i.competitorsObj[d].firstName + " " + i.competitorsObj[d].lastName).trim(),
                i.chooser = r[a].chooserId === d ? "self" : "opponent",
                i.players = [{
                    id: d,
                    name: s.user.displayName
                }, {
                    id: m,
                    name: i.opponentName
                }],
                i.players.sort(function(e, a) {
                    return e.name < a.name ? -1 : 1
                }),
                function() {
                    var e = Math.max(p, (new Date).getTime());
                    for (e = 60 * Math.floor(e / 1e3 / 60 / 60) * 60 * 1e3; e < l; )
                        i.hours.push({
                            dateWeekday: new Date(e).toLocaleString([], {
                                weekday: "long"
                            }),
                            dateDate: new Date(e).toLocaleString([], {
                                month: "short",
                                day: "numeric"
                            }),
                            dateTime: new Date(e).toLocaleString([], {
                                hour: "numeric",
                                minute: "numeric"
                            }),
                            timestamp: e
                        }),
                        e += 36e5;
                    c && w()
                }(),
                y(d),
                y(m),
                function() {
                    var a, t;
                    a = firebase.database().ref("pending").push({
                        requestType: "getDisplayName",
                        timestamp: firebase.database.ServerValue.TIMESTAMP,
                        userId: d,
                        targetUserId: m
                    }),
                    firebase.database().ref("pending/" + a.key).on("value", function(e) {
                        (t = e.val()) && t.done && (firebase.database().ref("pending/" + a.key).off(),
                        a.remove(),
                        i.opponentMLName = t.returnDisplayName,
                        i.$$phase || i.$apply())
                    }),
                    firebase.database().ref("users/" + m + "/displayName").once("value", function(e) {
                        e.exists() && (i.opponentMLName = e.val(),
                        i.$$phase || i.$apply())
                    })
                }(),
                function() {
                    var a;
                    firebase.database().ref(u).once("value", function(e) {
                        e.exists() && e.val().timestamp && (h = e.val().timestamp,
                        a = new Date(h),
                        i.schedule = g(a),
                        i.$$phase || i.$apply())
                    })
                }()))
    }
    function v() {
        s.user ? b() : setTimeout(v, 1e3)
    }
    function w() {
        for (var e, a = Object.keys(c), t = 0; t < a.length; t++)
            for (e = 0; e < i.hours.length; e++)
                if (i.hours[e].timestamp === parseInt(a[t], 10)) {
                    i.hours.splice(e, 1);
                    break
                }
    }
    function y(a) {
        var t, r, s, o;
        firebase.database().ref("availability/" + i.championshipId + "/" + a).once("value", function(e) {
            if (e.exists())
                for (t = e.val(),
                s = Object.keys(t),
                o = 0; o < s.length; o++)
                    r = t[s[o]],
                    i.availability[a] || (i.availability[a] = {}),
                    i.availability[a]["t" + r.timestamp] = s[o];
            i.ready = !0,
            i.$$phase || i.$apply()
        })
    }
    (window.myscope = i).modalId = "m" + (new Date).getTime(),
    i.adminTab = window.championshipAdminTab || "config",
    i.championshipId = t.championshipId,
    i.availability = {},
    i.hours = [],
    i.schedule = "",
    firebase.database().ref("championships/" + i.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (i.championshipTitle = e.val().title,
        i.eventNames = e.val().eventNames,
        i.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        i.hasCompetitors = e.val().hasCompetitors,
        i.hasFinals = e.val().hasFinals,
        i.hasGroups = e.val().hasGroups,
        i.hasQualifiers = e.val().hasQualifiers,
        i.hasSeeding = e.val().hasSeeding,
        i.hasScores = e.val().hasScores,
        i.hasSponsors = e.val().hasSponsors,
        i.showBestScores = e.val().showBestScores,
        i.showMatches = e.val().showMatches,
        i.viewMatches = e.val().viewMatches,
        i.$$phase || i.$apply())
    }),
    firebase.database().ref("championships/" + i.championshipId + "/competitors").on("value", function(e) {
        n = e.val() || {},
        i.competitorsObj = n,
        i.competitorsLoaded = !0,
        i.$$phase || i.$apply(),
        v()
    }),
    firebase.database().ref("excludedHours").once("value", function(e) {
        c = e.val() || {},
        i.hours.length && w()
    }),
    i.availabilityClick = function(e, a) {
        var t;
        e === d && (i.availability[e] || (i.availability[e] = {}),
        i.availability[e]["t" + a.timestamp] ? (firebase.database().ref("availability/" + i.championshipId + "/" + e + "/" + i.availability[e]["t" + a.timestamp]).remove(),
        delete i.availability[e]["t" + a.timestamp]) : ((t = firebase.database().ref("availability/" + i.championshipId + "/" + e).push()).set({
            timestamp: a.timestamp
        }),
        i.availability[e]["t" + a.timestamp] = t.key),
        i.$$phase || i.$apply())
    }
    ,
    i.competitorClick = function() {
        var a, t, e = m;
        $(".ui.modal.competitorModal").modal("show"),
        i.competitorData = {
            flag: i.opponentFlag,
            id: e,
            name: i.opponentMLName
        },
        i.competitorLoading = !0,
        i.$$phase || i.$apply(),
        t = a = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            i.competitorData.ratings = e.val(),
            a = !0,
            t && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            i.competitorData.recentBest = e.val(),
            t = !0,
            a && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        })
    }
    ,
    i.challenge = function(e) {
        $(".ui.modal.competitorModal").modal("hide"),
        a.path("/compete/" + e + "/" + encodeURIComponent(i.competitorData.name)),
        i.$$phase || i.$apply()
    }
    ,
    i.scheduleBlur = function() {
        var e;
        firebase.auth().currentUser && m && u && (i.schedule = i.schedule.replace(/<\/?[^>]+(>|$)/g, ""),
        e = i.schedule.length === "yyyy-mm-dd hh:mm".length && "-" === i.schedule.charAt(4) && "-" === i.schedule.charAt(7) && " " === i.schedule.charAt(10) && ":" === i.schedule.charAt(13) ? new Date(i.schedule) : new Date(""),
        isNaN(e.getTime()) ? "" === i.schedule ? (firebase.database().ref(u).remove(),
        firebase.database().ref("pending").push({
            requestType: "updateScheduledMatches",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: d
        })) : h ? (e = new Date(h),
        i.schedule = g(e)) : i.schedule = "" : (e = Date.UTC(e.getUTCFullYear(), e.getUTCMonth(), e.getUTCDate(), e.getUTCHours(), e.getUTCMinutes(), 0),
        firebase.database().ref(u).set({
            competitorId1: "self" === i.chooser ? d : m,
            competitorId2: "self" === i.chooser ? m : d,
            flag1: "self" === i.chooser ? i.selfFlag : i.opponentFlag,
            flag2: "self" === i.chooser ? i.opponentFlag : i.selfFlag,
            matchDescription: "African-European Open Qualifiers - Round " + i.round,
            name1: "self" === i.chooser ? f : i.opponentName,
            name2: "self" === i.chooser ? i.opponentName : f,
            timestamp: e
        }),
        firebase.database().ref("pending").push({
            requestType: "updateScheduledMatches",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: d
        })))
    }
    ,
    $(".menu .item").tab(),
    i.$on("$destroy", function() {
        $(".ui.modal.competitorModal." + i.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + i.modalId).remove()
    })
}
]),
angular.module("myApp.championship-scores", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/scores", {
        templateUrl: "championship-scores/championship-scores.html",
        controller: "ChampionshipScoresCtrl"
    })
}
]).controller("ChampionshipScoresCtrl", ["$rootScope", "$routeParams", "$sce", "$scope", "$timeout", "$window", function(e, a, t, i, r, s) {
    var o, n, c, m;
    function l(e) {
        $(".highlight" + e).transition("stop all").transition({
            animation: "highlightGlow",
            duration: "10s"
        })
    }
    function p(e) {
        var a, t, r = e.eventName;
        for (m[r].push(e),
        function(e) {
            var a, t, r, s, o;
            for (i.usamcq[e] = [],
            o = {},
            r = 0; r < m[e].length; r++)
                o[(s = m[e][r]).competitorId] || (o[s.competitorId] = {
                    competitorId: s.competitorId
                }),
                o[s.competitorId]["score" + s.attempt] = s.score,
                o[s.competitorId]["memoTime" + s.attempt] = s.memoTime;
            for (a = Object.keys(o),
            r = 0; r < a.length; r++)
                (t = o[a[r]]).bestScore = Math.max(t.score1 || 0, t.score2 || 0),
                !t.score2 && 0 !== t.score2 || t.score1 > t.score2 || t.score1 == t.score2 && t.memoTime1 < t.memoTime2 ? t.bestMemoTime = t.memoTime1 : t.bestMemoTime = t.memoTime2,
                i.usamcq[e].push(t);
            for (i.usamcq[e].sort(function(e, a) {
                return e.bestScore > a.bestScore ? -1 : a.bestScore > e.bestScore ? 1 : e.bestMemoTime - a.bestMemoTime
            }),
            r = 0; r < i.usamcq[e].length; r++)
                0 === r || i.usamcq[e][r].bestScore < i.usamcq[e][r - 1].bestScore || i.usamcq[e][r].bestMemoTime > i.usamcq[e][r - 1].bestMemoTime ? i.usamcq[e][r].rank = r + 1 : i.usamcq[e][r].rank = i.usamcq[e][r - 1].rank;
            i.$$phase || i.$apply()
        }(r),
        a = 0; a < i.usamcq[r].length; a++)
            if (i.usamcq[r][a].competitorId === e.competitorId) {
                t = a;
                break
            }
        t < i.usamcq[r].length && (c++,
        n[r].push({
            attempt: e.attempt,
            bestFlag: i.usamcq[r][t].bestScore === e.score && i.usamcq[r][t].bestMemoTime === e.memoTime,
            competitorId: e.competitorId,
            highlightCounter: c,
            timestamp: Date.now()
        }),
        o && function(e) {
            var a, t, r;
            for (n[e] = n[e].filter(function(e) {
                return Date.now() - e.timestamp < 1e4
            }),
            a = 0; a < n[e].length; a++)
                for (r = n[e][a],
                t = 0; t < i.usamcq[e].length; t++)
                    if (i.usamcq[e][t].competitorId === r.competitorId) {
                        i.usamcq[e][t]["trial" + r.attempt + "Class"] = "highlight" + r.highlightCounter,
                        r.bestFlag && (i.usamcq[e][t].bestClass = "highlight" + r.highlightCounter);
                        break
                    }
        }(r),
        i.$$phase || i.$apply(),
        o && setTimeout(l, 1, c))
    }
    window.myscope = i,
    c = 0,
    n = {
        Images: [],
        Names: [],
        Numbers: []
    },
    i.usamcq = {
        Images: [],
        Names: [],
        Numbers: []
    },
    m = {
        Images: [],
        Names: [],
        Numbers: []
    },
    i.adminTab = window.championshipAdminTab || "config",
    i.championshipId = a.championshipId,
    firebase.database().ref("championships/" + i.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (i.championshipTitle = e.val().title,
        i.eventNames = e.val().eventNames,
        i.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        i.hasCompetitors = e.val().hasCompetitors,
        i.hasFinals = e.val().hasFinals,
        i.hasGroups = e.val().hasGroups,
        i.hasQualifiers = e.val().hasQualifiers,
        i.hasSeeding = e.val().hasSeeding,
        i.hasScores = e.val().hasScores,
        i.hasSponsors = e.val().hasSponsors,
        i.showBestScores = e.val().showBestScores,
        i.showMatches = e.val().showMatches,
        i.viewMatches = e.val().viewMatches,
        i.$$phase || i.$apply())
    }),
    firebase.database().ref("championships/" + i.championshipId + "/competitors").on("value", function(e) {
        e.exists() && (i.competitors = e.val(),
        i.$$phase || i.$apply())
    }),
    firebase.database().ref("championships/" + i.championshipId + "/scores").on("child_added", function(e) {
        p(e.val())
    }),
    firebase.database().ref("championships/" + i.championshipId + "/scores").on("child_changed", function(e) {
        p(e.val())
    }),
    $(".menu .item").tab({
        onVisible: function(e) {
            $("td").transition("stop all")
        }
    }),
    r(function() {
        o = !0
    }, 5e3)
}
]),
angular.module("myApp.championship-seeding", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/seeding", {
        templateUrl: "championship-seeding/championship-seeding.html",
        controller: "ChampionshipSeedingCtrl"
    })
}
]).controller("ChampionshipSeedingCtrl", ["$compile", "$rootScope", "$routeParams", "$sce", "$scope", "$window", function(a, e, t, r, s, o) {
    (window.myscope = s).adminTab = window.championshipAdminTab || "config",
    s.championshipId = t.championshipId,
    firebase.database().ref("championships/" + s.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (s.championshipTitle = e.val().title,
        s.eventNames = e.val().eventNames,
        s.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        s.hasCompetitors = e.val().hasCompetitors,
        s.hasFinals = e.val().hasFinals,
        s.hasGroups = e.val().hasGroups,
        s.hasQualifiers = e.val().hasQualifiers,
        s.hasSeeding = e.val().hasSeeding,
        s.hasScores = e.val().hasScores,
        s.hasSponsors = e.val().hasSponsors,
        s.showBestScores = e.val().showBestScores,
        s.showMatches = e.val().showMatches,
        s.viewMatches = e.val().viewMatches,
        s.$$phase || s.$apply())
    }),
    firebase.database().ref("championships/" + s.championshipId + "/competitors").on("value", function(e) {
        s.competitors = e.val(),
        s.$$phase || s.$apply()
    }),
    firebase.database().ref("championships/" + s.championshipId + "/seedings").on("value", function(e) {
        s.seedings = e.val() || {},
        $("#seedingsHtml").html("");
        e = $(s.seedings.html).appendTo("#seedingsHtml");
        a(e)(s),
        s.$$phase || s.$apply()
    }),
    $(".menu .item").tab(),
    s.competitorClick = function(e) {
        s.competitor = s.competitors[e],
        $(".ui.modal.competitor").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.$on("$destroy", function() {
        $(".ui.modal.competitor").modal("hide"),
        $(".ui.modal.competitor").remove()
    })
}
]),
angular.module("myApp.championship-sponsors", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships/:championshipId/sponsors", {
        templateUrl: "championship-sponsors/championship-sponsors.html",
        controller: "ChampionshipSponsorsCtrl"
    })
}
]).controller("ChampionshipSponsorsCtrl", ["$rootScope", "$routeParams", "$scope", "$window", function(e, a, t, r) {
    (window.myscope = t).adminTab = window.championshipAdminTab || "config",
    t.championshipId = a.championshipId,
    firebase.database().ref("championships/" + t.championshipId + "/commonConfig").on("value", function(e) {
        e.exists() && (t.championshipTitle = e.val().title,
        t.eventNames = e.val().eventNames,
        t.finalsTabLabel = e.val().finalsTabLabel || "Finals",
        t.hasCompetitors = e.val().hasCompetitors,
        t.hasFinals = e.val().hasFinals,
        t.hasGroups = e.val().hasGroups,
        t.hasQualifiers = e.val().hasQualifiers,
        t.hasSeeding = e.val().hasSeeding,
        t.hasScores = e.val().hasScores,
        t.hasSponsors = e.val().hasSponsors,
        t.showBestScores = e.val().showBestScores,
        t.showMatches = e.val().showMatches,
        t.viewMatches = e.val().viewMatches,
        t.$$phase || t.$apply())
    }),
    firebase.database().ref("championships/" + t.championshipId + "/competitors").on("value", function(e) {
        t.competitors = e.val(),
        t.$$phase || t.$apply()
    }),
    firebase.database().ref("championships/" + t.championshipId + "/bestScores").on("value", function(e) {
        t.bestScores = e.val() || {},
        t.$$phase || t.$apply()
    }),
    firebase.database().ref("championships/" + t.championshipId + "/previousWorldRecords").on("value", function(e) {
        t.previousWorldRecords = e.val(),
        t.$$phase || t.$apply()
    }),
    $(".menu .item").tab(),
    t.competitorClick = function(e) {
        t.competitor = t.competitors[e],
        $(".ui.modal.competitor").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    t.$on("$destroy", function() {
        $(".ui.modal.competitor").modal("hide"),
        $(".ui.modal.competitor").remove()
    })
}
]),
angular.module("myApp.championships", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/championships", {
        templateUrl: "championships/championships.html",
        controller: "ChampionshipsCtrl"
    })
}
]).controller("ChampionshipsCtrl", ["$compile", "$location", "$rootScope", "$scope", "$window", function(e, a, t, r, s) {
    (window.myscope = r).goToChampionship = function(e) {
        a.path("championships/" + e + "/overview")
    }
}
]),
angular.module("myApp.compete", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/compete", {
        templateUrl: "compete/compete.html",
        controller: "CompeteCtrl"
    }),
    e.when("/compete/:eventName/:opponentName", {
        templateUrl: "compete/compete.html",
        controller: "CompeteCtrl"
    })
}
]).controller("CompeteCtrl", ["$scope", "$location", "$rootScope", "$routeParams", "$timeout", function(o, i, n, e, c) {
    var m, t, l, p, u;
    function a() {
        o.cardsSelected = !1,
        o.imagesSelected = !1,
        o.internationalSelected = !1,
        o.namesSelected = !1,
        o.numbersSelected = !1,
        o.wordsSelected = !1
    }
    switch (window.myscope = o,
    m = new Audio("bell2.mp3"),
    $(".ui.checkbox").checkbox(),
    o.countryNames = countryNames,
    o.highLevel = 6,
    o.now = Date.now(),
    function e() {
        o.user || (o.showSignin ? (i.path("home"),
        o.$$phase || o.$apply()) : setTimeout(e, 1e3))
    }(),
    a(),
    e.opponentName && (o.opponent = "Specific",
    o.opponentUsername = decodeURIComponent(e.opponentName)),
    e.eventName) {
    case "Cards":
        o.cardsSelected = !0;
        break;
    case "Images":
        o.imagesSelected = !0;
        break;
    case "International Names":
        o.internationalSelected = !0;
        break;
    case "Names":
        o.namesSelected = !0;
        break;
    case "Numbers":
        o.numbersSelected = !0;
        break;
    case "Words":
        o.wordsSelected = !0
    }
    function r() {
        var e, a, t = {
            requestType: "prefs",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        };
        if (o.cardsSelected) {
            for (e = o.prefs.cardsGroups.split(" "),
            a = 0; a < e.length; a += 1)
                if ("1" !== e[a] && "2" !== e[a] && "3" !== e[a] && "4" !== e[a] && "5" !== e[a] && "6" !== e[a] && "7" !== e[a] && "8" !== e[a])
                    return alert("Invalid Groups value for Cards - groups must be between 1 and 8"),
                    !1;
            t.cardsDirection = o.prefs.cardsDirection,
            t.cardsGroups = o.prefs.cardsGroups,
            t.cardsHideTimer = o.prefs.cardsHideTimer,
            t.cardsSpacing = o.prefs.cardsSpacing,
            t.cardsStyle = o.prefs.cardsStyle,
            t.cardsSuits = o.prefs.cardsSuits,
            t.cardsValues = o.prefs.cardsValues
        }
        if (o.imagesSelected) {
            for (e = o.prefs.imagesGroups.split(" "),
            a = 0; a < e.length; a += 1)
                if ("1" !== e[a] && "2" !== e[a] && "3" !== e[a] && "4" !== e[a] && "5" !== e[a])
                    return alert("Invalid Groups value for Images - groups must be between 1 and 5"),
                    !1;
            t.imagesGroups = o.prefs.imagesGroups,
            t.imagesHideTimer = o.prefs.imagesHideTimer
        }
        if (o.internationalSelected && (t.internationalScript = o.prefs.internationalScript,
        t.internationalHideTimer = o.prefs.internationalHideTimer),
        o.namesSelected && (t.namesLanguage = o.prefs.namesLanguage,
        t.namesHideTimer = o.prefs.namesHideTimer),
        o.numbersSelected) {
            if ("3,2,3" !== o.prefs.numbersGroups)
                for (e = o.prefs.numbersGroups.split(" "),
                a = 0; a < e.length; a += 1)
                    if ("1" !== e[a] && "2" !== e[a] && "3" !== e[a] && "4" !== e[a] && "5" !== e[a] && "6" !== e[a] && "7" !== e[a] && "8" !== e[a] || "1" === o.prefs.numbersGroups)
                        return alert("Invalid Groups value for Numbers - groups must be between 2 and 8"),
                        !1;
            t.numbersGroups = o.prefs.numbersGroups,
            t.numbersHideTimer = o.prefs.numbersHideTimer
        }
        if (o.wordsSelected) {
            for (e = o.prefs.wordsGroups.split(" "),
            a = 0; a < e.length; a += 1)
                if ("1" !== e[a] && "2" !== e[a] && "3" !== e[a] && "4" !== e[a] && "5" !== e[a])
                    return alert("Invalid Groups value for Words - groups must be between 1 and 5"),
                    !1;
            t.wordsHideTimer = o.prefs.wordsHideTimer,
            t.wordsLanguage = o.prefs.wordsLanguage,
            t.wordsGroups = o.prefs.wordsGroups
        }
        firebase.database().ref("pending").push(t),
        o.prefs.cardsStyle !== n.user.prefs.cardsStyle && function() {
            var e;
            switch (o.prefs.cardsStyle) {
            case "Arabic":
                for (e = 0; e < 52; e += 1)
                    (new Image).src = "images/cards/arabic/a_card" + e + ".png";
                break;
            case "German":
                for (e = 0; e < 52; e += 1)
                    (new Image).src = "images/cards/german/g_card" + e + ".png";
                break;
            case "English":
                for (e = 0; e < 52; e += 1)
                    (new Image).src = "images/cards/english/card" + e + ".svg"
            }
        }()
    }
    function h() {
        u && (u.update({
            timestamp: firebase.database.ServerValue.TIMESTAMP
        }),
        p = c(h, 2e3))
    }
    function s() {
        var a, t, r, s;
        o.cardsSelected && (t = "Cards"),
        o.imagesSelected && (t = "Images"),
        o.internationalSelected && (t = "International Names"),
        o.namesSelected && (t = "Names"),
        o.numbersSelected && (t = "Numbers"),
        o.wordsSelected && (t = "Words"),
        (r = {})[t] = n.user.ratings[t],
        s = firebase.database().ref("pending").push({
            requestType: "getUser",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid,
            username: o.opponentUsername.toLowerCase()
        }),
        o.status = "checking",
        firebase.database().ref("pending/" + s.key).on("value", function(e) {
            var e = e.val();
            if (e && e.done) {
                if (firebase.database().ref("pending/" + s.key).off(),
                s.remove(),
                !(e = e.returnUserId))
                    return o.status = "",
                    o.$$phase || o.$apply(),
                    void $(".ui.modal.notfound").modal("setting", {
                        onApprove: function() {}
                    }).modal("show");
                a = {
                    challengerId: firebase.auth().currentUser.uid,
                    eventName: t,
                    name: n.user.displayName,
                    noComment: !!n.user.noComment,
                    prefs: n.user.prefs,
                    ratings: r,
                    timestamp: firebase.database.ServerValue.TIMESTAMP
                },
                n.user.flag && (a.flag = n.user.flag),
                u = firebase.database().ref("challenges/" + e).push(a),
                o.status = "waiting",
                p = c(h, 2e3),
                u.child("matchUrl").on("value", function(e) {
                    e = e.val();
                    e && (u.child("matchUrl").off(),
                    m.play(),
                    i.path(e))
                })
            }
        })
    }
    o.friendlyOnly = !1,
    o.ratingOnly = !1,
    o.status = "",
    o.cardsHideTimerClick = function() {
        o.prefs.cardsHideTimer = !o.prefs.cardsHideTimer
    }
    ,
    o.imagesHideTimerClick = function() {
        o.prefs.imagesHideTimer = !o.prefs.imagesHideTimer
    }
    ,
    o.internationalHideTimerClick = function() {
        o.prefs.internationalHideTimer = !o.prefs.internationalHideTimer
    }
    ,
    o.namesHideTimerClick = function() {
        o.prefs.namesHideTimer = !o.prefs.namesHideTimer
    }
    ,
    o.numbersHideTimerClick = function() {
        o.prefs.numbersHideTimer = !o.prefs.numbersHideTimer
    }
    ,
    o.wordsHideTimerClick = function() {
        o.prefs.wordsHideTimer = !o.prefs.wordsHideTimer
    }
    ,
    o.showPreferences = function() {
        n.user && (o.prefs = {
            cardsDirection: n.user.prefs.cardsDirection,
            cardsGroups: n.user.prefs.cardsGroups,
            cardsHideTimer: n.user.prefs.cardsHideTimer || !1,
            cardsSpacing: n.user.prefs.cardsSpacing || "regular",
            cardsStyle: n.user.prefs.cardsStyle,
            cardsSuits: n.user.prefs.cardsSuits,
            cardsValues: n.user.prefs.cardsValues,
            imagesGroups: n.user.prefs.imagesGroups || "1",
            imagesHideTimer: n.user.prefs.imagesHideTimer || !1,
            internationalHideTimer: n.user.prefs.internationalHideTimer || !1,
            internationalScript: n.user.prefs.internationalScript,
            namesHideTimer: n.user.prefs.namesHideTimer || !1,
            namesLanguage: n.user.prefs.namesLanguage,
            numbersGroups: n.user.prefs.numbersGroups,
            numbersHideTimer: n.user.prefs.numbersHideTimer || !1,
            wordsHideTimer: n.user.prefs.wordsHideTimer || !1,
            wordsLanguage: n.user.prefs.wordsLanguage,
            wordsGroups: n.user.prefs.wordsGroups
        },
        $(".ui.modal.competepreferences").modal({
            onApprove: r
        }).modal("show").modal("refresh"))
    }
    ,
    o.friendlyOnlyClick = function() {
        $("#ratingOnly").checkbox("uncheck"),
        o.ratingOnly = !1,
        o.friendlyOnly = !o.friendlyOnly
    }
    ,
    o.ratingOnlyClick = function() {
        $("#friendlyOnly").checkbox("uncheck"),
        o.friendlyOnly = !1,
        o.ratingOnly = !o.ratingOnly
    }
    ,
    function e() {
        if (o.user) {
            if (o.user.championshipMatchUrl)
                return i.path(o.user.championshipMatchUrl),
                void (o.$$phase || o.$apply());
            firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
                l = e.val(),
                firebase.database().ref("challenges/" + firebase.auth().currentUser.uid).on("value", function(e) {
                    var a, t, r, s;
                    if (o.challenges = [],
                    e.val())
                        for (t = e.val(),
                        s = Object.keys(t),
                        r = 0; r < s.length; r += 1)
                            (a = t[s[r]]).timestamp - l > Date.now() - 5e3 && (a.key = s[r],
                            o.challenges.push(a));
                    o.$$phase || o.$apply()
                })
            })
        } else
            setTimeout(e, 2e3)
    }(),
    o.acceptChallenge = function(e) {
        var a;
        o.hideAccept || (o.hideAccept = !0,
        (a = {})[e.eventName] = n.user.ratings[e.eventName],
        firebase.database().ref("pending").push({
            challengeKey: e.key,
            requestType: "challenge",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid,
            users: [{
                flag: e.flag || "",
                id: e.challengerId,
                name: e.name,
                noComment: !!e.noComment,
                prefs: e.prefs,
                ratings: e.ratings
            }, {
                flag: n.user.flag || "",
                id: firebase.auth().currentUser.uid,
                name: n.user.displayName,
                noComment: !!n.user.noComment,
                prefs: n.user.prefs,
                ratings: a
            }]
        }),
        (t = firebase.database().ref("challenges/" + firebase.auth().currentUser.uid + "/" + e.key)).child("matchUrl").on("value", function(e) {
            e = e.val();
            e && (t.off(),
            m.play(),
            i.path(e),
            o.$$phase || o.$apply())
        }))
    }
    ,
    o.randomClick = function() {
        o.opponent = "Random"
    }
    ,
    o.specificClick = function() {
        var e, a, t, r;
        for (o.opponent = "Specific",
        a = ["cards", "images", "international", "names", "numbers", "words"],
        t = 0; t < a.length; t++)
            e = a[t],
            r ? o[e + "Selected"] = !1 : o[e + "Selected"] && (r = !0)
    }
    ,
    o.eventClick = function(e) {
        e = "International Names" === e ? "internationalSelected" : e.toLowerCase() + "Selected";
        "Specific" !== o.opponent || o[e] || a(),
        o[e] = !o[e]
    }
    ,
    o.compete = function() {
        ("Random" === o.opponent ? function() {
            for (var e, a, t = {
                friendlyOnly: o.friendlyOnly,
                ratingOnly: o.ratingOnly,
                user: {
                    id: firebase.auth().currentUser.uid,
                    name: n.user.displayName,
                    noComment: !!n.user.noComment,
                    prefs: {},
                    ratings: {}
                },
                timestamp: firebase.database.ServerValue.TIMESTAMP
            }, r = ["Cards", "Images", "International Names", "Names", "Numbers", "Words"], s = 0; s < r.length; s++)
                a = "International Names" === (e = r[s]) ? "internationalSelected" : e.toLowerCase() + "Selected",
                o[a] && (t[a] = o[a],
                t.user.ratings[e] = n.user.ratings[e],
                0 === n.user.ratings[e].rating && n.user.ratings[e].base + n.user.ratings[e].wins !== 0 && (t.user.ratings[e].rating = n.user.ratings[e].base));
            o.cardsSelected && (t.user.prefs.cardsDirection = n.user.prefs.cardsDirection,
            t.user.prefs.cardsGroups = n.user.prefs.cardsGroups,
            t.user.prefs.cardsRecall = n.user.prefs.cardsRecall,
            t.user.prefs.cardsSpacing = n.user.prefs.cardsSpacing || "regular",
            t.user.prefs.cardsStyle = n.user.prefs.cardsStyle),
            o.imagesSelected && (t.user.prefs.imagesGroups = n.user.prefs.imagesGroups || "1"),
            o.internationalSelected && (t.user.prefs.internationalScript = n.user.prefs.internationalScript),
            o.namesSelected && (t.user.prefs.namesLanguage = n.user.prefs.namesLanguage),
            o.numbersSelected && (t.user.prefs.numbersGroups = n.user.prefs.numbersGroups),
            o.wordsSelected && (t.user.prefs.wordsGroups = n.user.prefs.wordsGroups,
            t.user.prefs.wordsLanguage = n.user.prefs.wordsLanguage),
            n.user.flag && (t.user.flag = n.user.flag),
            u = firebase.database().ref("waitingToCompete").push(t),
            o.status = "waiting",
            p = c(h, 2e3),
            u.child("matchUrl").on("value", function(e) {
                e = e.val();
                e && (m.play(),
                i.path(e))
            })
        }
        : s)()
    }
    ,
    o.cancel = function() {
        u && (u.remove(),
        u = null),
        p && c.cancel(p),
        o.status = ""
    }
    ,
    o.showInstructions = function() {
        $(".ui.modal.instructions").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    o.closeInstructions = function() {
        $(".ui.modal.instructions").modal("hide")
    }
    ,
    o.$on("$destroy", function() {
        o.cancel(),
        $(".ui.modal.instructions").remove(),
        $(".ui.modal.notfound").remove(),
        $(".ui.modal.competepreferences").remove()
    })
}
]),
angular.module("myApp.compete-cards", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/compete-cards/:matchId", {
        templateUrl: "compete-cards/compete-cards.html",
        controller: "CompeteCardsCtrl"
    })
}
]).controller("CompeteCardsCtrl", ["$location", "$rootScope", "$routeParams", "$sce", "$scope", "$timeout", "$window", function(a, o, e, t, i, r, s) {
    window.myscope = i;
    var n, c, m, l, p, u, h, d, f, g, b, v, w, y, C, T, M, I, S, R, k = 20, N = 60, A = 10, D = 240;
    function P() {
        i.match.championshipId || i.self || "Ready" !== i.match.competitors[0].status || "Ready" !== i.match.competitors[1].status || firebase.database().ref("pending").push({
            matchId: l,
            requestType: "start",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    function U() {
        alert("This game has been reset. Please leave the game and return to the Home page.")
    }
    function L() {
        i.setReady(!1)
    }
    function _(e) {
        i.trial.memoCursor = e,
        u.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + l + "/competitors/" + i.self + "/memoCursor").set(u.shift())
        }, 1e3 * y)
    }
    function x() {
        Date.now() - m < 500 ? i.stopMemo(m) : m = Date.now()
    }
    function F() {
        firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + l).push({
            focus: !1,
            phase: i.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function V() {
        firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + l).push({
            focus: !0,
            phase: i.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function E(e) {
        "Memo" === i.phase && function(e) {
            switch (e.which) {
            case 13:
                i.stopMemo(),
                e.preventDefault();
                break;
            case 32:
            case 38:
            case 87:
                i.memoReturn(),
                i.$$phase || i.$apply(),
                e.preventDefault();
                break;
            case 37:
            case 65:
                i.memoPrev(),
                i.$$phase || i.$apply(),
                e.preventDefault();
                break;
            case 39:
            case 68:
                i.memoNext(),
                i.$$phase || i.$apply(),
                e.preventDefault()
            }
        }(e)
    }
    function H(e) {
        "Recall" === i.phase && function(e) {
            if (!i.match.orderedRecall)
                switch (e.which) {
                case 43:
                case 61:
                    G(i.trial.recallCursor),
                    i.$$phase || i.$apply(),
                    e.preventDefault();
                    break;
                case 45:
                    W(i.trial.recallCursor),
                    i.$$phase || i.$apply(),
                    e.preventDefault()
                }
        }(e)
    }
    function B(e, a) {
        i.trial.recall[e] = a,
        w.push({
            item: e,
            recall: a
        }),
        setTimeout(function() {
            var e = w.shift();
            firebase.database().ref("matches/" + l + "/competitors/" + i.self + "/recall/" + e.item).set(e.recall)
        }, 1e3 * y)
    }
    function q() {
        var e, a, t, r;
        if (!o.user)
            return -1;
        for (t = [],
        a = 0; a < i.trial.items; a += 1)
            t[a] = !1;
        for (e = 0; e < 52; e += 1)
            i.trial.recall[e] < 52 && (t[i.trial.recall[e]] = !0);
        for (a = 0; a < i.trial.items; a += 1)
            if (!t[r = "LTR" === o.user.prefs.cardsDirection ? (i.trial.recallCursor + a + 1) % i.trial.items : (i.trial.recallCursor - a - 1 + i.trial.items) % i.trial.items])
                return r;
        return -1
    }
    function G(e) {
        var a;
        if ("LTR" === o.user.prefs.cardsDirection)
            for (a = 0; a < 52; a += 1)
                i.trial.recall[a] < 52 && i.trial.recall[a] >= e && (i.trial.recall[a] === i.trial.items - 1 ? B(a, o.user.prefs.cardsRecall[a]) : B(a, i.trial.recall[a] + 1));
        else
            for (a = 0; a < 52; a += 1)
                i.trial.recall[a] < 52 && i.trial.recall[a] <= e && (0 === i.trial.recall[a] ? B(a, o.user.prefs.cardsRecall[a]) : B(a, i.trial.recall[a] - 1))
    }
    function W(e) {
        var a, t = !1;
        if ("LTR" === o.user.prefs.cardsDirection)
            for (a = 0; a < 52; a += 1)
                i.trial.recall[a] < 52 && i.trial.recall[a] > e && (i.trial.recall[a] === i.trial.recallCursor + 1 && (t = !0),
                B(a, i.trial.recall[a] - 1));
        else
            for (a = 0; a < 52; a += 1)
                i.trial.recall[a] < 52 && i.trial.recall[a] < e && (i.trial.recall[a] === i.trial.recallCursor - 1 && (t = !0),
                B(a, i.trial.recall[a] + 1));
        t && i.setRecallCursor(q())
    }
    function O(e) {
        setTimeout(function() {
            n || (firebase.database().ref("pending").push({
                matchId: l,
                recall: i.trial.recall,
                requestType: "endCompete",
                self: i.self,
                solo: i.match.solo || !1,
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                userId: firebase.auth().currentUser.uid
            }),
            firebase.database().ref("matches/" + l + "/competitors/" + i.self + "/status").set("Finished"),
            i.match.competitors[i.self].status = "Finished",
            n = !0),
            e && (T = !0,
            a.path("view-cards/" + l),
            i.$$phase || i.$apply())
        }, 1e3 * y)
    }
    function z() {
        var e = (Date.now() - M) / 1e3;
        if (c ? c = !1 : g && (2 < e - g || e - g < 0) && (M += 1e3 * (e - g - 1),
        e = (Date.now() - M) / 1e3),
        (g = e) < k && (i.phase = "PreMemo",
        C = k - e),
        k <= e && e < k + i.match.competitors[i.self].memoTime && (i.phase = "Memo",
        C = k + N - e),
        e >= k + i.match.competitors[i.self].memoTime && e < k + N + A && ("PreRecall" !== i.phase && (i.phase = "PreRecall",
        $("body, .wrapper").removeClass("opponentFinished")),
        C = k + N + A - e),
        k + N + A <= e && e < k + N + A + D && ("Recall" !== i.phase && "Finished" !== i.phase && (i.phase = "Recall",
        i.showFinished = !1,
        i.touch = !!s.mlTouch,
        r(function() {
            i.showFinished = !0
        }, 2e3)),
        C = k + N + A + D - e),
        k + N + A + D < e)
            return i.phase = "Finished",
            i.$$phase || i.$apply(),
            void O(!0);
        i.timerMin = Math.floor(Math.round(C) / 60),
        e = Math.round(C) % 60,
        i.timerSec = (e < 10 ? "0" : "") + e,
        i.timerWarning = ("Memo" === i.phase || "Recall" === i.phase) && Math.round(C) < 10,
        R = r(z, 1e3)
    }
    m = 0,
    l = e.matchId,
    u = [],
    d = [10, 11, 12, 23, 24, 25, 36, 37, 38, 49, 50, 51],
    v = [],
    w = [],
    y = 0,
    i.comments = [],
    i.countryNames = countryNames,
    i.modalId = "m" + (new Date).getTime(),
    i.site = window.site,
    i.competitorClick = function(e, a, t) {
        var r, s;
        $(".ui.modal.competitorModal").modal("show"),
        i.competitorData = {
            flag: t,
            id: e,
            name: a
        },
        i.competitorLoading = !0,
        i.$$phase || i.$apply(),
        s = r = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            i.competitorData.ratings = e.val(),
            r = !0,
            s && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            i.competitorData.recentBest = e.val(),
            s = !0,
            r && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        })
    }
    ,
    firebase.database().ref("league/current/seasonText").once("value", function(e) {
        i.seasonText = e.val(),
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("matches/" + l).once("value", function(e) {
        return i.match = e.val(),
        i.match.competitors[0].userId === firebase.auth().currentUser.uid && (i.self = 0),
        i.match.competitors[1].userId === firebase.auth().currentUser.uid && (i.self = 1),
        0 !== i.self && 1 !== i.self || "Finished" === i.match.competitors[i.self].status && !i.match.championshipId || i.match.endTime ? (T = !0,
        a.path("view-cards/" + l),
        void (i.$$phase || i.$apply())) : (i.opponent = 1 - i.self,
        i.trial = i.match.competitors[i.self],
        function(e) {
            var a, t, r;
            function s() {
                --t || (i.imagesLoaded = !0,
                i.$$phase || i.$apply())
            }
            for (r = [],
            t = 52,
            a = 0; a < 52; a += 1)
                switch (r[a] = new Image,
                r[a].onload = s,
                e) {
                case "Arabic":
                    r[a].src = "images/cards/arabic/a_card" + a + ".png";
                    break;
                case "English":
                    r[a].src = "images/cards/english/card" + a + ".svg";
                    break;
                case "FourColor":
                    r[a].src = "images/cards/four-color/card" + a + ".svg";
                    break;
                case "German":
                    r[a].src = "images/cards/german/g_card" + a + ".png";
                    break;
                case "Swapped":
                    r[a].src = "images/cards/swapped/card" + a + ".svg"
                }
        }(i.trial.cardsStyle),
        i.match.championshipId && (firebase.database().ref("championships/" + i.match.championshipId + "/commonConfig/title").once("value", function(e) {
            i.championshipTitle = e.val() || ""
        }),
        "remote" !== i.match.championshipId.substring(0, 6) && "japan2020" !== i.match.championshipId && (y = 0)),
        (p = firebase.database().ref("matches/" + l + "/competitors/" + i.opponent + "/matchType")).on("value", function(e) {
            i.match.competitors[i.opponent].matchType = e.val(),
            i.setReady(!1),
            i.$$phase || i.$apply()
        }),
        (S = firebase.database().ref("matches/" + l + "/competitors/" + i.opponent + "/status")).on("value", function(e) {
            i.match.competitors[i.opponent].status = e.val(),
            P(),
            "Finished" === i.match.competitors[0].status && "Finished" === i.match.competitors[1].status && (T = !0,
            a.path("view-cards/" + l),
            i.$$phase || i.$apply()),
            i.$$phase || i.$apply()
        }),
        (h = firebase.database().ref("matches/" + l + "/competitors/" + i.opponent + "/memoTimeRT")).on("value", function(e) {
            e = e.val();
            "Memo" === i.phase && e < N && $("body, .wrapper").addClass("opponentFinished")
        }),
        void (-999 === i.match.startTime ? U() : i.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            M = i.match.startTime - e,
            z()
        }) : (i.phase = "Splash",
        i.$$phase || i.$apply(),
        (I = firebase.database().ref("matches/" + l + "/startTime")).on("value", function(e) {
            -999 === e.val() && U(),
            0 < e.val() && (M = Date.now(),
            z())
        }),
        (f = firebase.database().ref("prematchComments/" + l)).on("child_added", function(e) {
            var a = document.getElementById("comments");
            i.comments.push(e.val()),
            a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
                a.scrollTop = a.scrollHeight
            }, 0),
            i.$$phase || i.$apply()
        }))))
    }),
    i.matchTypeClick = function(e) {
        "" === i.match.competitors[i.self].status && (i.match.competitors[i.self].matchType = e,
        firebase.database().ref("matches/" + l + "/competitors/" + i.self + "/matchType").set(e),
        i.setReady(!1))
    }
    ,
    i.setReady = function(e) {
        i.match.competitors[i.self].status = e ? "Ready" : "",
        firebase.database().ref("matches/" + l + "/competitors/" + i.self + "/status").set(e ? "Ready" : ""),
        i.match.championshipId && firebase.database().ref("championships/" + i.match.championshipId + "/matchesSummary/" + i.match.matchKey + "/competitors/" + i.self + "/status").set(e ? "Ready" : ""),
        i.readyHide = e ? "readyHide" : "",
        e && !i.match.championshipId && (b = r(L, 2e4)),
        P()
    }
    ,
    i.stopMemo = function(e) {
        e = e || Date.now(),
        i.trial.memoTime = Math.round((e - M) / 10) / 100 - k,
        i.trial.memoTime > N && (i.trial.memoTime = N),
        i.trial.memoTime < N && (firebase.database().ref("matches/" + l + "/competitors/" + i.self + "/memoTimeRT").set(i.trial.memoTime),
        setTimeout(function() {
            firebase.database().ref("matches/" + l + "/competitors/" + i.self + "/memoTime").set(i.trial.memoTime)
        }, 1e3 * y)),
        i.phase = "PreRecall",
        e = k + N + A - (e - M) / 1e3,
        i.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        i.timerSec = (e < 10 ? "0" : "") + e,
        i.$$phase || i.$apply(),
        $("body, .wrapper").removeClass("opponentFinished")
    }
    ,
    i.memoPrev = function() {
        "LTR" === o.user.prefs.cardsDirection ? 0 < i.trial.memoCursor && _(i.trial.memoCursor - 1) : i.trial.memoCursor < i.trial.info.groups.length - 1 && _(i.trial.memoCursor + 1)
    }
    ,
    i.memoNext = function() {
        "LTR" === o.user.prefs.cardsDirection ? i.trial.memoCursor === i.trial.info.groups.length - 1 ? x() : _(i.trial.memoCursor + 1) : 0 === i.trial.memoCursor ? x() : _(i.trial.memoCursor - 1)
    }
    ,
    i.memoReturn = function() {
        "LTR" === o.user.prefs.cardsDirection ? _(0) : _(i.trial.info.groups.length - 1)
    }
    ,
    i.shiftLeftClick = function() {
        W(i.trial.recallCursor)
    }
    ,
    i.shiftRightClick = function() {
        G(i.trial.recallCursor)
    }
    ,
    $(document).keydown(E),
    $(document).keypress(H),
    $(window).blur(F),
    $(window).focus(V),
    i.memoClassPosition = function(e) {
        var a;
        return "Memo" === i.phase && o.user ? (i.trial.info.cards[e].groupNum === i.trial.memoCursor ? (a = "cardsMemoPos" + i.trial.info.cards[e].posInGroup,
        "compact" === o.user.prefs.cardsSpacing && (a += "Compact")) : a = "cardsMemoPos" + (52 + i.trial.memo[e] - i.trial.info.groups[i.trial.memoCursor].start - i.trial.info.groups[i.trial.memoCursor].size),
        a) : ""
    }
    ,
    i.memoClassCard = function(e) {
        var a, t;
        if ("Memo" !== i.phase || !o.user)
            return "";
        switch (i.trial.cardsStyle) {
        case "Arabic":
            a = i.match.single ? "cardsMemo_a card" + e % 13 + "_a" : i.match.red ? ((t = e) < 13 && (t += 13),
            39 <= t && (t -= 13),
            "cardsMemo_a card" + t + "_a") : i.match.aoo2022s2 ? 1 === e || 24 === e || 32 === e || 47 === e || 51 === e ? "cardsMemo_a card" + e + "_a" : "cardsMemo_a card21_a" : i.match.pictureCards ? "cardsMemo_a card" + d[e % 12] + "_a" : "cardsMemo_a card" + e + "_a";
            break;
        case "English":
            a = i.match.single ? "cardsMemo_e card" + e % 13 + "_e" : i.match.red ? ((t = e) < 13 && (t += 13),
            39 <= t && (t -= 13),
            "cardsMemo_e card" + t + "_e") : i.match.aoo2022s2 ? 1 === e || 24 === e || 32 === e || 47 === e || 51 === e ? "cardsMemo_e card" + e + "_e" : "cardsMemo_e card21_e" : i.match.pictureCards ? "cardsMemo_e card" + d[e % 12] + "_e" : "cardsMemo_e card" + e + "_e";
            break;
        case "FourColor":
            a = i.match.single ? "cardsMemo_f card" + e % 13 + "_f" : i.match.red ? ((t = e) < 13 && (t += 13),
            39 <= t && (t -= 13),
            "cardsMemo_f card" + t + "_f") : i.match.aoo2022s2 ? 1 === e || 24 === e || 32 === e || 47 === e || 51 === e ? "cardsMemo_f card" + e + "_f" : "cardsMemo_f card21_f" : i.match.pictureCards ? "cardsMemo_f card" + d[e % 12] + "_f" : "cardsMemo_f card" + e + "_f";
            break;
        case "German":
            a = i.match.single ? "cardsMemo_g card" + e % 13 + "_g" : i.match.red ? ((t = e) < 13 && (t += 13),
            39 <= t && (t -= 13),
            "cardsMemo_g card" + t + "_g") : i.match.aoo2022s2 ? 1 === e || 24 === e || 32 === e || 47 === e || 51 === e ? "cardsMemo_g card" + e + "_g" : "cardsMemo_g card21_g" : i.match.pictureCards ? "cardsMemo_g card" + d[e % 12] + "_g" : "cardsMemo_g card" + e + "_g";
            break;
        case "Swapped":
            a = "cardsMemo_s card" + e + "_s"
        }
        return i.match.shake && (a += " cardShake" + e),
        a
    }
    ,
    i.recallBoxClick = function(e) {
        i.match.orderedRecall || i.setRecallCursor(e)
    }
    ,
    i.setRecallCursor = function(e) {
        for (var a = 0; a < 52; a++)
            if (i.trial.recall[a] === e)
                return;
        i.trial.recallCursor = e,
        v.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + l + "/competitors/" + i.self + "/recallCursor").set(v.shift())
        }, 1e3 * y)
    }
    ,
    i.boxNum = function(e) {
        return "Recall" === i.phase && o.user ? "LTR" === o.user.prefs.cardsDirection ? e + 1 : i.trial.items - e : ""
    }
    ,
    i.recallClass = function(e) {
        var a, t;
        if ("Recall" !== i.phase || !o.user)
            return "";
        switch (i.trial.cardsStyle) {
        case "Arabic":
            a = i.match.single ? "cardsRecall_a card" + e % 13 + "_a" : i.match.red ? ((t = e) < 13 && (t += 13),
            39 <= t && (t -= 13),
            "cardsRecall_a card" + t + "_a") : i.match.aoo2022s2 ? 1 === e || 24 === e || 32 === e || 47 === e || 51 === e ? "cardsRecall_a card" + e + "_a" : "cardsRecall_a card21_a" : i.match.pictureCards ? "cardsRecall_a card" + d[e % 12] + "_a" : "cardsRecall_a card" + e + "_a";
            break;
        case "English":
            a = i.match.single ? "cardsRecall_e card" + e % 13 + "_e" : i.match.red ? ((t = e) < 13 && (t += 13),
            39 <= t && (t -= 13),
            "cardsRecall_e card" + t + "_e") : i.match.aoo2022s2 ? 1 === e || 24 === e || 32 === e || 47 === e || 51 === e ? "cardsRecall_e card" + e + "_e" : "cardsRecall_e card21_e" : i.match.pictureCards ? "cardsRecall_e card" + d[e % 12] + "_e" : "cardsRecall_e card" + e + "_e";
            break;
        case "FourColor":
            a = i.match.single ? "cardsRecall_f card" + e % 13 + "_f" : i.match.red ? ((t = e) < 13 && (t += 13),
            39 <= t && (t -= 13),
            "cardsRecall_f card" + t + "_f") : i.match.aoo2022s2 ? 1 === e || 24 === e || 32 === e || 47 === e || 51 === e ? "cardsRecall_f card" + e + "_f" : "cardsRecall_f card21_f" : i.match.pictureCards ? "cardsRecall_f card" + d[e % 12] + "_f" : "cardsRecall_f card" + e + "_f";
            break;
        case "German":
            a = i.match.single ? "cardsRecall_g card" + e % 13 + "_g" : i.match.red ? ((t = e) < 13 && (t += 13),
            39 <= t && (t -= 13),
            "cardsRecall_g card" + t + "_g") : i.match.aoo2022s2 ? 1 === e || 24 === e || 32 === e || 47 === e || 51 === e ? "cardsRecall_g card" + e + "_g" : "cardsRecall_g card21_g" : i.match.pictureCards ? "cardsRecall_g card" + d[e % 12] + "_g" : "cardsRecall_g card" + e + "_g";
            break;
        case "Swapped":
            a = "cardsRecall_s card" + e + "_s"
        }
        return a += " cardsRecallPos" + i.trial.recall[e],
        i.match.shake && (a += " cardShake" + e),
        a
    }
    ,
    i.boxWidth = function(e) {
        var a;
        if ("Recall" !== i.phase && "Completed" !== i.phase || !o.user)
            return "";
        switch (i.match.competitors[e].cardsStyle) {
        case "Arabic":
            a = "cardsBoxWidth_a";
            break;
        case "English":
            a = "cardsBoxWidth_e";
            break;
        case "FourColor":
            a = "cardsBoxWidth_f";
            break;
        case "German":
            a = "cardsBoxWidth_g";
            break;
        case "Swapped":
            a = "cardsBoxWidth_s"
        }
        return a
    }
    ,
    i.cardClick = function(e) {
        var a;
        51 < i.trial.recall[e] ? -1 !== i.trial.recallCursor && (B(e, i.trial.recallCursor),
        i.setRecallCursor(q())) : i.match.orderedRecall || (a = i.trial.recall[e],
        B(e, i.trial.origRecall[e]),
        i.setRecallCursor(a))
    }
    ,
    i.numClick = function(e) {
        i.match.orderedRecall || (G(e),
        i.setRecallCursor(e))
    }
    ,
    i.resultsClass = function(e, a) {
        var t, r, s;
        if ("Completed" !== i.phase || !o.user)
            return "";
        switch (i.match.competitors[e].cardsStyle) {
        case "Arabic":
            t = "cardsResults_a card" + a + "_a";
            break;
        case "English":
            t = "cardsResults_e card" + a + "_e";
            break;
        case "FourColor":
            t = "cardsResults_f card" + a + "_f";
            break;
        case "German":
            t = "cardsResults_g card" + a + "_g";
            break;
        case "Swapped":
            t = "cardsResults_s card" + a + "_s"
        }
        return t += " " + (r = e,
        s = a,
        51 < i.match.competitors[r].recall[s] ? "" : i.match.competitors[r].memo[s] === i.match.competitors[r].recall[s] ? "cardsCorrect" : "cardsIncorrect"),
        t += " cardsRecallPos" + i.match.competitors[e].recall[a]
    }
    ,
    i.originalCard = function(e, a) {
        var t, r, s;
        if ("Completed" !== i.phase)
            return "";
        for (t = 0; t < 52 && i.match.competitors[e].memo[t] !== a; t += 1)
            ;
        return r = 12 < t ? "♦" : "♣",
        25 < t && (r = "♥"),
        38 < t && (r = "♠"),
        1 === (s = t % 13 + 1) && (s = "A"),
        11 === s && (s = "German" === i.match.competitors[e].cardsStyle ? "B" : "J"),
        12 === s && (s = "German" === i.match.competitors[e].cardsStyle ? "D" : "Q"),
        13 === s && (s = "K"),
        s + r
    }
    ,
    i.originalCardColor = function(e, a) {
        var t;
        if ("Completed" !== i.phase)
            return "";
        for (t = 0; t < 52; t += 1)
            if (i.match.competitors[e].memo[t] === a)
                return 12 < t && t < 39 ? "cardsRed" : "cardsBlack"
    }
    ,
    i.finishedRecallClick = function() {
        i.phase = "Finished",
        i.$$phase || i.$apply(),
        i.match.championshipId && "pao" !== i.match.championshipId.substring(0, 3) && "aoo" !== i.match.championshipId.substring(0, 3) && "aeo" !== i.match.championshipId.substring(0, 3) && "world" !== i.match.championshipId.substring(0, 5) ? O(!1) : O(!0)
    }
    ,
    i.continueClick = function() {
        a.path("compete")
    }
    ,
    i.$on("$locationChangeStart", function(e) {
        i.phase && !T && (c = !0,
        confirm("Are you sure you want to exit the game?") || e.preventDefault())
    }),
    i.sendClick = function() {
        i.comment.trim() && (firebase.database().ref("prematchComments/" + l).push({
            author: i.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: i.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        }),
        i.comment = "",
        i.$$phase || i.$apply())
    }
    ,
    i.$on("$destroy", function() {
        $(".ui.modal.competitorModal." + i.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + i.modalId).remove(),
        r.cancel(b),
        r.cancel(R),
        i.match && i.match.competitors && i.match.competitors[i.self] && "Ready" === i.match.competitors[i.self].status && i.setReady(!1),
        $(document).off("keydown", E),
        $(document).off("keypress", H),
        $(window).off("blur", F),
        $(window).off("focus", V),
        $("body, .wrapper").removeClass("opponentFinished"),
        p && p.off(),
        h && h.off(),
        f && f.off(),
        I && I.off(),
        S && S.off()
    })
}
]),
angular.module("myApp.compete-images", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/compete-images/:matchId", {
        templateUrl: "compete-images/compete-images.html",
        controller: "CompeteImagesCtrl"
    })
}
]).controller("CompeteImagesCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(o, e, a, i, t) {
    window.myscope = i;
    var r, s, n, c, m, l, p, u, h, d, f, g, b, v, w, y, C, T, M, I = 30, S = 20, R = 60, k = 10, N = 240;
    function A() {
        i.match.championshipId || i.self || "Ready" !== i.match.competitors[0].status || "Ready" !== i.match.competitors[1].status || firebase.database().ref("pending").push({
            matchId: c,
            requestType: "start",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    function D() {
        alert("This game has been reset. Please leave the game and return to the Home page.")
    }
    function P() {
        i.setReady(!1)
    }
    function U(e) {
        i.trial.memoCursor = e,
        l.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/memoCursor").set(l.shift())
        }, 1e3 * b)
    }
    function L(e) {
        switch (e.which) {
        case 43:
        case 61:
            B(i.trial.recallCursor),
            i.$$phase || i.$apply(),
            e.preventDefault();
            break;
        case 45:
            !function(e) {
                var a, t;
                for (t = !1,
                a = 0; a < i.trial.memo.length; a += 1)
                    i.trial.recall[a] < I && i.trial.recall[a] > e && (i.trial.recall[a] === i.trial.recallCursor + 1 && (t = !0),
                    E(a, i.trial.recall[a] - 1));
                t && i.setRecallCursor(H())
            }(i.trial.recallCursor),
            i.$$phase || i.$apply(),
            e.preventDefault()
        }
    }
    function _() {
        firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + c).push({
            focus: !1,
            phase: i.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function x() {
        firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + c).push({
            focus: !0,
            phase: i.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function F(e) {
        "Memo" === i.phase && function(e) {
            switch (e.which) {
            case 13:
                i.stopMemo(),
                e.preventDefault();
                break;
            case 32:
            case 38:
            case 87:
                i.memoReturn(),
                i.$$phase || i.$apply(),
                e.preventDefault();
                break;
            case 37:
            case 65:
                i.memoPrev(),
                i.$$phase || i.$apply(),
                e.preventDefault();
                break;
            case 39:
            case 68:
                i.memoNext(),
                i.$$phase || i.$apply(),
                e.preventDefault()
            }
        }(e)
    }
    function V(e) {
        "Recall" === i.phase && L(e)
    }
    function E(e, a) {
        i.trial.recall[e] = a,
        g.push({
            item: e,
            recall: a
        }),
        setTimeout(function() {
            var e = g.shift();
            firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/recall/" + e.item).set(e.recall)
        }, 1e3 * b)
    }
    function H() {
        for (var e, a = [], t = 0; t < i.trial.memo.length; t += 1)
            a[t] = !1;
        for (t = 0; t < i.trial.memo.length; t += 1)
            i.trial.recall[t] < I && (a[i.trial.recall[t]] = !0);
        for (t = 0; t < i.trial.memo.length; t += 1)
            if (!a[e = (i.trial.recallCursor + t + 1) % i.trial.memo.length])
                return e;
        return -1
    }
    function B(e) {
        for (var a = 0; a < i.trial.memo.length; a += 1)
            i.trial.recall[a] < I && i.trial.recall[a] >= e && (i.trial.recall[a] === i.trial.memo.length - 1 ? E(a, i.trial.origRecall[a]) : E(a, i.trial.recall[a] + 1))
    }
    function q(e) {
        setTimeout(function() {
            r || (firebase.database().ref("pending").push({
                matchId: c,
                recall: i.trial.recall,
                requestType: "endCompete",
                self: i.self,
                solo: i.match.solo || !1,
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                userId: firebase.auth().currentUser.uid
            }),
            firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/status").set("Finished"),
            i.match.competitors[i.self].status = "Finished",
            r = !0),
            e && (w = !0,
            o.path("view-images/" + c),
            i.$$phase || i.$apply())
        }, 1e3 * b)
    }
    function G() {
        var e = (Date.now() - y) / 1e3;
        if (s ? s = !1 : h && (2 < e - h || e - h < 0) && (y += 1e3 * (e - h - 1),
        e = (Date.now() - y) / 1e3),
        (h = e) < S && (i.phase = "PreMemo",
        v = S - e),
        S <= e && e < S + i.match.competitors[i.self].memoTime && (i.phase = "Memo",
        v = S + R - e),
        e >= S + i.match.competitors[i.self].memoTime && e < S + R + k && ("PreRecall" !== i.phase && (i.phase = "PreRecall",
        $("body, .wrapper").removeClass("opponentFinished")),
        v = S + R + k - e),
        S + R + k <= e && e < S + R + k + N && ("Recall" !== i.phase && "Finished" !== i.phase && (i.phase = "Recall",
        i.showFinished = !1,
        t(function() {
            i.showFinished = !0
        }, 2e3)),
        v = S + R + k + N - e),
        S + R + k + N < e)
            return i.phase = "Finished",
            i.$$phase || i.$apply(),
            void q(!0);
        i.timerMin = Math.floor(Math.round(v) / 60),
        e = Math.round(v) % 60,
        i.timerSec = (e < 10 ? "0" : "") + e,
        i.timerWarning = ("Memo" === i.phase || "Recall" === i.phase) && Math.round(v) < 10,
        M = t(G, 1e3)
    }
    n = 0,
    c = e.matchId,
    l = [],
    f = [],
    g = [],
    b = 0,
    i.comments = [],
    i.countryNames = countryNames,
    i.modalId = "m" + (new Date).getTime(),
    i.site = window.site,
    i.urls = {},
    i.competitorClick = function(e, a, t) {
        var r, s;
        $(".ui.modal.competitorModal").modal("show"),
        i.competitorData = {
            flag: t,
            id: e,
            name: a
        },
        i.competitorLoading = !0,
        i.$$phase || i.$apply(),
        s = r = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            i.competitorData.ratings = e.val(),
            r = !0,
            s && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            i.competitorData.recentBest = e.val(),
            s = !0,
            r && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        })
    }
    ,
    firebase.database().ref("league/current/seasonText").once("value", function(e) {
        i.seasonText = e.val(),
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("matches/" + c).once("value", function(e) {
        var a, t, r;
        function s() {
            --t || (i.imagesLoaded = !0,
            i.$$phase || i.$apply())
        }
        if (i.match = e.val(),
        i.match.competitors[0].userId === firebase.auth().currentUser.uid && (i.self = 0),
        i.match.competitors[1].userId === firebase.auth().currentUser.uid && (i.self = 1),
        0 !== i.self && 1 !== i.self || "Finished" === i.match.competitors[i.self].status && !i.match.championshipId || i.match.endTime)
            return w = !0,
            o.path("view-images/" + c),
            void (i.$$phase || i.$apply());
        for (i.opponent = 1 - i.self,
        i.trial = i.match.competitors[i.self],
        t = i.trial.memo.length,
        r = [],
        a = 0; a < i.trial.memo.length; a++)
            !function(a) {
                firebase.storage().ref("images/" + i.trial.memo[a]).getDownloadURL().then(function(e) {
                    i.urls[i.trial.memo[a]] = e,
                    r[a] = new Image,
                    r[a].onload = s,
                    r[a].src = e
                })
            }(a);
        i.match.championshipId && (firebase.database().ref("championships/" + i.match.championshipId + "/commonConfig/title").once("value", function(e) {
            i.championshipTitle = e.val() || ""
        }),
        "remote" !== i.match.championshipId.substring(0, 6) && "japan2020" !== i.match.championshipId && (b = 0)),
        (m = firebase.database().ref("matches/" + c + "/competitors/" + i.opponent + "/matchType")).on("value", function(e) {
            i.match.competitors[i.opponent].matchType = e.val(),
            i.setReady(!1),
            i.$$phase || i.$apply()
        }),
        (T = firebase.database().ref("matches/" + c + "/competitors/" + i.opponent + "/status")).on("value", function(e) {
            i.match.competitors[i.opponent].status = e.val(),
            A(),
            "Finished" === i.match.competitors[0].status && "Finished" === i.match.competitors[1].status && (w = !0,
            o.path("view-images/" + c),
            i.$$phase || i.$apply()),
            i.$$phase || i.$apply()
        }),
        (p = firebase.database().ref("matches/" + c + "/competitors/" + i.opponent + "/memoTimeRT")).on("value", function(e) {
            e = e.val();
            "Memo" === i.phase && e < R && $("body, .wrapper").addClass("opponentFinished")
        }),
        -999 === i.match.startTime ? D() : i.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            y = i.match.startTime - e,
            G()
        }) : (i.phase = "Splash",
        i.$$phase || i.$apply(),
        (C = firebase.database().ref("matches/" + c + "/startTime")).on("value", function(e) {
            -999 === e.val() && D(),
            0 < e.val() && (y = Date.now(),
            G())
        }),
        (u = firebase.database().ref("prematchComments/" + c)).on("child_added", function(e) {
            var a = document.getElementById("comments");
            i.comments.push(e.val()),
            a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
                a.scrollTop = a.scrollHeight
            }, 0),
            i.$$phase || i.$apply()
        }))
    }),
    i.matchTypeClick = function(e) {
        "" === i.match.competitors[i.self].status && (i.match.competitors[i.self].matchType = e,
        firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/matchType").set(e),
        i.setReady(!1))
    }
    ,
    i.setReady = function(e) {
        i.match.competitors[i.self].status = e ? "Ready" : "",
        firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/status").set(e ? "Ready" : ""),
        i.match.championshipId && firebase.database().ref("championships/" + i.match.championshipId + "/matchesSummary/" + i.match.matchKey + "/competitors/" + i.self + "/status").set(e ? "Ready" : ""),
        i.readyHide = e ? "readyHide" : "",
        e && !i.match.championshipId && (d = t(P, 2e4)),
        A()
    }
    ,
    i.stopMemo = function(e) {
        e = e || Date.now(),
        i.trial.memoTime = Math.round((e - y) / 10) / 100 - S,
        i.trial.memoTime > R && (i.trial.memoTime = R),
        i.trial.memoTime < R && (firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/memoTimeRT").set(i.trial.memoTime),
        setTimeout(function() {
            firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/memoTime").set(i.trial.memoTime)
        }, 1e3 * b)),
        i.phase = "PreRecall",
        e = S + R + k - (e - y) / 1e3,
        i.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        i.timerSec = (e < 10 ? "0" : "") + e,
        i.$$phase || i.$apply(),
        $("body, .wrapper").removeClass("opponentFinished")
    }
    ,
    i.memoPrev = function() {
        0 < i.trial.memoCursor && U(i.trial.memoCursor - 1)
    }
    ,
    i.memoNext = function() {
        i.trial.memoCursor === i.trial.info.groups.length - 1 ? Date.now() - n < 500 ? i.stopMemo(n) : n = Date.now() : U(i.trial.memoCursor + 1)
    }
    ,
    i.memoReturn = function() {
        U(0)
    }
    ,
    $(document).keydown(F),
    $(document).keypress(V),
    $(window).blur(_),
    $(window).focus(x),
    i.memoClass = function(e) {
        return "Memo" !== i.phase ? "" : i.trial.info.images[e].groupNum === i.trial.memoCursor ? "imagesMemoMid" + i.trial.info.images[e].posInGroup : i.trial.info.images[e].groupNum > i.trial.memoCursor ? "imagesMemoRight" + (e - i.trial.info.groups[0].size) : "imagesMemoLeft" + e
    }
    ,
    i.setRecallCursor = function(e) {
        i.trial.recallCursor = e,
        f.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/recallCursor").set(f.shift())
        }, 1e3 * b)
    }
    ,
    i.recallImageClick = function(e) {
        var a;
        i.trial.recall[e] > I - 1 ? (E(e, i.trial.recallCursor),
        i.setRecallCursor(H())) : (a = i.trial.recall[e],
        E(e, i.trial.origRecall[e]),
        i.setRecallCursor(a))
    }
    ,
    i.hover = function(e) {
        i.trial.fullSize = e
    }
    ,
    i.numClick = function(e) {
        B(e),
        i.setRecallCursor(e)
    }
    ,
    i.spinClass = function(e) {
        return i.match && i.match.spin ? i.match.spinClasses[e] : ""
    }
    ,
    i.imageRecalled = function(e) {
        var a;
        if (!i.match || !i.match.spin)
            return !1;
        for (a = 0; a < i.trial.memo.length; a++)
            if (i.trial.recall[a] === e)
                return !0;
        return !1
    }
    ,
    i.finishedRecallClick = function() {
        i.phase = "Finished",
        i.$$phase || i.$apply(),
        i.match.championshipId && "pao" !== i.match.championshipId.substring(0, 3) && "aoo" !== i.match.championshipId.substring(0, 3) && "aeo" !== i.match.championshipId.substring(0, 3) && "world" !== i.match.championshipId.substring(0, 5) ? q(!1) : q(!0)
    }
    ,
    i.continueClick = function() {
        o.path("compete")
    }
    ,
    i.$on("$locationChangeStart", function(e) {
        i.phase && !w && (s = !0,
        confirm("Are you sure you want to exit the game?") || e.preventDefault())
    }),
    i.sendClick = function() {
        i.comment.trim() && (firebase.database().ref("prematchComments/" + c).push({
            author: i.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: i.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        }),
        i.comment = "",
        i.$$phase || i.$apply())
    }
    ,
    i.$on("$destroy", function() {
        $(".ui.modal.competitorModal." + i.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + i.modalId).remove(),
        t.cancel(d),
        t.cancel(M),
        i.match && i.match.competitors && i.match.competitors[i.self] && "Ready" === i.match.competitors[i.self].status && i.setReady(!1),
        $(document).off("keydown", F),
        $(document).off("keypress", V),
        $(window).off("blur", _),
        $(window).off("focus", x),
        $("body, .wrapper").removeClass("opponentFinished"),
        m && m.off(),
        p && p.off(),
        u && u.off(),
        C && C.off(),
        T && T.off()
    })
}
]),
angular.module("myApp.compete-international", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/compete-international/:matchId", {
        templateUrl: "compete-international/compete-international.html",
        controller: "CompeteInternationalCtrl"
    })
}
]).controller("CompeteInternationalCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(o, e, a, i, t) {
    window.myscope = i;
    var r, s, n, c, m, l, p, u, h, d, f, g, b, v, w, y, C, T, M, I, S = 20, R = 60, k = 10, N = 240;
    function A() {
        i.match.championshipId || i.self || "Ready" !== i.match.competitors[0].status || "Ready" !== i.match.competitors[1].status || firebase.database().ref("pending").push({
            matchId: c,
            requestType: "start",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    function D() {
        alert("This game has been reset. Please leave the game and return to the Home page.")
    }
    function P() {
        i.setReady(!1)
    }
    function U(e) {
        i.trial.memoCursor = e,
        l.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/memoCursor").set(l.shift())
        }, 1e3 * b)
    }
    function L() {
        i.trial.recallCursor !== i.trial.memo.length - 1 && (i.setRecallCursor(i.trial.recallCursor + 1),
        i.$$phase || i.$apply())
    }
    function _() {
        0 < i.trial.recallCursor && (i.setRecallCursor(i.trial.recallCursor - 1),
        i.$$phase || i.$apply())
    }
    function x(e) {
        var a;
        if (i.match.orderedRecall)
            9 !== e.which && 13 !== e.which || (i.trial.recallCursor === i.trial.memo.length - 1 ? i.finishedRecallClick() : (a = i.trial.recallCursor + 1,
            i.trial.recallCursor = a,
            f.push(a),
            setTimeout(function() {
                firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/recallCursor").set(f.shift())
            }, 1e3 * b),
            $("#namesRecall" + i.trial.inverseRecallSeqs[a]).focus(),
            i.$$phase || i.$apply()),
            e.preventDefault());
        else
            switch (e.which) {
            case 9:
            case 13:
                (w ? _ : L)(),
                e.preventDefault();
                break;
            case 37:
                _(),
                e.preventDefault();
                break;
            case 39:
                L(),
                e.preventDefault();
                break;
            case 38:
                6 <= i.trial.recallCursor && i.trial.recallCursor <= 17 ? (i.setRecallCursor(i.trial.recallCursor - 6),
                i.$$phase || i.$apply()) : 21 <= i.trial.recallCursor && (i.setRecallCursor(i.trial.recallCursor - 9),
                i.$$phase || i.$apply()),
                e.preventDefault();
                break;
            case 40:
                i.trial.recallCursor <= 11 && i.trial.recallCursor + 6 < i.trial.memo.length ? (i.setRecallCursor(i.trial.recallCursor + 6),
                i.$$phase || i.$apply()) : 12 <= i.trial.recallCursor && i.trial.recallCursor <= 21 && i.trial.recallCursor + 9 < i.trial.memo.length && (i.setRecallCursor(i.trial.recallCursor + 9),
                i.$$phase || i.$apply()),
                e.preventDefault();
                break;
            case 16:
                w = !0
            }
    }
    function F() {
        firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + c).push({
            focus: !1,
            phase: i.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function V() {
        firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + c).push({
            focus: !0,
            phase: i.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function E(e) {
        switch (i.phase) {
        case "Memo":
            !function(e) {
                switch (e.which) {
                case 13:
                    i.stopMemo(),
                    e.preventDefault();
                    break;
                case 32:
                case 38:
                case 87:
                    i.memoReturn(),
                    i.$$phase || i.$apply(),
                    e.preventDefault();
                    break;
                case 37:
                case 65:
                    i.memoPrev(),
                    i.$$phase || i.$apply(),
                    e.preventDefault();
                    break;
                case 39:
                case 68:
                    i.memoNext(),
                    i.$$phase || i.$apply(),
                    e.preventDefault()
                }
            }(e);
            break;
        case "Recall":
            x(e)
        }
    }
    function H(e) {
        16 === e.which && w && (w = !1)
    }
    function B(e) {
        setTimeout(function() {
            r || (firebase.database().ref("pending").push({
                matchId: c,
                recall: i.trial.recall,
                requestType: "endCompete",
                self: i.self,
                solo: i.match.solo || !1,
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                userId: firebase.auth().currentUser.uid
            }),
            firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/status").set("Finished"),
            i.match.competitors[i.self].status = "Finished",
            r = !0),
            e && (y = !0,
            o.path("view-international/" + c),
            i.$$phase || i.$apply())
        }, 1e3 * b)
    }
    function q() {
        var e = (Date.now() - C) / 1e3;
        if (s ? s = !1 : h && (2 < e - h || e - h < 0) && (C += 1e3 * (e - h - 1),
        e = (Date.now() - C) / 1e3),
        (h = e) < S && (i.phase = "PreMemo",
        v = S - e),
        S <= e && e < S + i.match.competitors[i.self].memoTime && (i.phase = "Memo",
        v = S + R - e),
        e >= S + i.match.competitors[i.self].memoTime && e < S + R + k && ("PreRecall" !== i.phase && (i.phase = "PreRecall",
        $("body, .wrapper").removeClass("opponentFinished")),
        v = S + R + k - e),
        S + R + k <= e && e < S + R + k + N && ("Recall" !== i.phase && "Finished" !== i.phase && (i.phase = "Recall",
        i.showFinished = !1,
        t(function() {
            i.showFinished = !0
        }, 2e3),
        t(function() {
            $("#namesRecall" + i.trial.inverseRecallSeqs[0]).focus()
        })),
        v = S + R + k + N - e),
        S + R + k + N < e)
            return i.phase = "Finished",
            i.$$phase || i.$apply(),
            void B(!0);
        i.timerMin = Math.floor(Math.round(v) / 60),
        e = Math.round(v) % 60,
        i.timerSec = (e < 10 ? "0" : "") + e,
        i.timerWarning = ("Memo" === i.phase || "Recall" === i.phase) && Math.round(v) < 10,
        I = t(q, 1e3)
    }
    n = 0,
    c = e.matchId,
    l = [],
    f = [],
    g = [],
    b = 0,
    i.comments = [],
    i.countryNames = countryNames,
    i.modalId = "m" + (new Date).getTime(),
    i.site = window.site,
    i.urls = {},
    i.competitorClick = function(e, a, t) {
        var r, s;
        $(".ui.modal.competitorModal").modal("show"),
        i.competitorData = {
            flag: t,
            id: e,
            name: a
        },
        i.competitorLoading = !0,
        i.$$phase || i.$apply(),
        s = r = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            i.competitorData.ratings = e.val(),
            r = !0,
            s && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            i.competitorData.recentBest = e.val(),
            s = !0,
            r && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        })
    }
    ,
    firebase.database().ref("league/current/seasonText").once("value", function(e) {
        i.seasonText = e.val(),
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("matches/" + c).once("value", function(e) {
        var a, t, r;
        function s() {
            --t || (i.imagesLoaded = !0,
            i.$$phase || i.$apply())
        }
        if (i.match = e.val(),
        i.match.competitors[0].userId === firebase.auth().currentUser.uid && (i.self = 0),
        i.match.competitors[1].userId === firebase.auth().currentUser.uid && (i.self = 1),
        0 !== i.self && 1 !== i.self || "Finished" === i.match.competitors[i.self].status && !i.match.championshipId || i.match.endTime)
            return y = !0,
            o.path("view-international/" + c),
            void (i.$$phase || i.$apply());
        for (i.opponent = 1 - i.self,
        i.trial = i.match.competitors[i.self],
        t = i.trial.memo.length,
        r = [],
        a = 0; a < i.trial.memo.length; a++)
            !function(a) {
                firebase.storage().ref("names/" + i.trial.memo[a].photo).getDownloadURL().then(function(e) {
                    i.urls[i.trial.memo[a].photo] = e,
                    i.$$phase || i.$apply(),
                    r[a] = new Image,
                    r[a].onload = s,
                    r[a].src = e
                })
            }(a);
        i.match.championshipId && (firebase.database().ref("championships/" + i.match.championshipId + "/commonConfig/title").once("value", function(e) {
            i.championshipTitle = e.val() || ""
        }),
        "remote" !== i.match.championshipId.substring(0, 6) && "japan2020" !== i.match.championshipId && (b = 0)),
        (m = firebase.database().ref("matches/" + c + "/competitors/" + i.opponent + "/matchType")).on("value", function(e) {
            i.match.competitors[i.opponent].matchType = e.val(),
            i.setReady(!1),
            i.$$phase || i.$apply()
        }),
        (M = firebase.database().ref("matches/" + c + "/competitors/" + i.opponent + "/status")).on("value", function(e) {
            i.match.competitors[i.opponent].status = e.val(),
            A(),
            "Finished" === i.match.competitors[0].status && "Finished" === i.match.competitors[1].status && (y = !0,
            o.path("view-international/" + c),
            i.$$phase || i.$apply()),
            i.$$phase || i.$apply()
        }),
        (p = firebase.database().ref("matches/" + c + "/competitors/" + i.opponent + "/memoTimeRT")).on("value", function(e) {
            e = e.val();
            "Memo" === i.phase && e < R && $("body, .wrapper").addClass("opponentFinished")
        }),
        -999 === i.match.startTime ? D() : i.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            C = i.match.startTime - e,
            q()
        }) : (i.phase = "Splash",
        i.$$phase || i.$apply(),
        (T = firebase.database().ref("matches/" + c + "/startTime")).on("value", function(e) {
            -999 === e.val() && D(),
            0 < e.val() && (C = Date.now(),
            q())
        }),
        (u = firebase.database().ref("prematchComments/" + c)).on("child_added", function(e) {
            var a = document.getElementById("comments");
            i.comments.push(e.val()),
            a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
                a.scrollTop = a.scrollHeight
            }, 0),
            i.$$phase || i.$apply()
        }))
    }),
    i.matchTypeClick = function(e) {
        "" === i.match.competitors[i.self].status && (i.match.competitors[i.self].matchType = e,
        firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/matchType").set(e),
        i.setReady(!1))
    }
    ,
    i.setReady = function(e) {
        i.match.competitors[i.self].status = e ? "Ready" : "",
        firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/status").set(e ? "Ready" : ""),
        i.match.championshipId && firebase.database().ref("championships/" + i.match.championshipId + "/matchesSummary/" + i.match.matchKey + "/competitors/" + i.self + "/status").set(e ? "Ready" : ""),
        i.readyHide = e ? "readyHide" : "",
        e && !i.match.championshipId && (d = t(P, 2e4)),
        A()
    }
    ,
    i.stopMemo = function(e) {
        e = e || Date.now(),
        i.trial.memoTime = Math.round((e - C) / 10) / 100 - S,
        i.trial.memoTime > R && (i.trial.memoTime = R),
        i.trial.memoTime < R && (firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/memoTimeRT").set(i.trial.memoTime),
        setTimeout(function() {
            firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/memoTime").set(i.trial.memoTime)
        }, 1e3 * b)),
        i.phase = "PreRecall",
        e = S + R + k - (e - C) / 1e3,
        i.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        i.timerSec = (e < 10 ? "0" : "") + e,
        i.$$phase || i.$apply(),
        $("body, .wrapper").removeClass("opponentFinished")
    }
    ,
    i.memoPrev = function() {
        0 < i.trial.memoCursor && U(i.trial.memoCursor - 1)
    }
    ,
    i.memoNext = function() {
        i.trial.memoCursor === i.trial.memo.length - 1 ? Date.now() - n < 500 ? i.stopMemo(n) : n = Date.now() : U(i.trial.memoCursor + 1)
    }
    ,
    i.memoReturn = function() {
        U(0)
    }
    ,
    i.memoClassPhoto = function(e) {
        return "Memo" !== i.phase ? "" : e == i.trial.memoCursor ? "namesMemoPhotoMid" : e > i.trial.memoCursor ? "namesMemoRight" + (e - 1) : "namesMemoLeft" + e
    }
    ,
    i.memoClassName = function(e) {
        return "Memo" !== i.phase ? "" : e == i.trial.memoCursor ? "namesMemoNameMid" : e > i.trial.memoCursor ? "namesMemoRight" + (e - 1) : "namesMemoLeft" + e
    }
    ,
    i.orderedRecallNameBlur = function() {
        $("#namesRecall" + i.trial.inverseRecallSeqs[i.trial.recallCursor]).focus()
    }
    ,
    $(document).keydown(E),
    $(document).keyup(H),
    $(window).blur(F),
    $(window).focus(V),
    i.setRecallCursor = function(e) {
        i.match.orderedRecall || (i.trial.recallCursor = e,
        f.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/recallCursor").set(f.shift())
        }, 1e3 * b),
        $("#namesRecall" + i.trial.inverseRecallSeqs[e]).focus())
    }
    ,
    i.recallChange = function(e) {
        g.push({
            item: e,
            recall: i.trial.recall[e]
        }),
        setTimeout(function() {
            var e = g.shift();
            firebase.database().ref("matches/" + c + "/competitors/" + i.self + "/recall/" + e.item).set(e.recall)
        }, 1e3 * b)
    }
    ,
    i.finishedRecallClick = function() {
        i.phase = "Finished",
        i.$$phase || i.$apply(),
        i.match.championshipId && "pao" !== i.match.championshipId.substring(0, 3) && "aoo" !== i.match.championshipId.substring(0, 3) && "aeo" !== i.match.championshipId.substring(0, 3) && "world" !== i.match.championshipId.substring(0, 5) ? B(!1) : B(!0)
    }
    ,
    i.continueClick = function() {
        o.path("compete")
    }
    ,
    i.$on("$locationChangeStart", function(e) {
        i.phase && !y && (s = !0,
        confirm("Are you sure you want to exit the game?") || e.preventDefault())
    }),
    i.sendClick = function() {
        i.comment.trim() && (firebase.database().ref("prematchComments/" + c).push({
            author: i.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: i.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        }),
        i.comment = "",
        i.$$phase || i.$apply())
    }
    ,
    i.$on("$destroy", function() {
        $(".ui.modal.competitorModal." + i.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + i.modalId).remove(),
        t.cancel(d),
        t.cancel(I),
        i.match && i.match.competitors && i.match.competitors[i.self] && "Ready" === i.match.competitors[i.self].status && i.setReady(!1),
        $(document).off("keydown", E),
        $(document).off("keyup", H),
        $(window).off("blur", F),
        $(window).off("focus", V),
        $("body, .wrapper").removeClass("opponentFinished"),
        m && m.off(),
        p && p.off(),
        u && u.off(),
        T && T.off(),
        M && M.off()
    })
}
]),
angular.module("myApp.compete-names", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/compete-names/:matchId", {
        templateUrl: "compete-names/compete-names.html",
        controller: "CompeteNamesCtrl"
    })
}
]).controller("CompeteNamesCtrl", ["$location", "$rootScope", "$routeParams", "$sce", "$scope", "$timeout", function(o, s, e, a, i, t) {
    window.myscope = i;
    var r, n, c, m, l, p, u, h, d, f, g, b, v, w, y, C, T, M, I, S, R = 20, k = 60, N = 10, A = 240;
    function D() {
        i.match.championshipId || i.self || "Ready" !== i.match.competitors[0].status || "Ready" !== i.match.competitors[1].status || firebase.database().ref("pending").push({
            matchId: m,
            requestType: "start",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    function P() {
        alert("This game has been reset. Please leave the game and return to the Home page.")
    }
    function U() {
        i.setReady(!1)
    }
    function L(e) {
        i.trial.memoCursor = e,
        p.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/memoCursor").set(p.shift())
        }, 1e3 * v)
    }
    function _() {
        i.trial.recallCursor !== i.trial.memo.length - 1 && (i.setRecallCursor(i.trial.recallCursor + 1),
        i.$$phase || i.$apply())
    }
    function x() {
        0 < i.trial.recallCursor && (i.setRecallCursor(i.trial.recallCursor - 1),
        i.$$phase || i.$apply())
    }
    function F(e) {
        switch (e.which) {
        case 9:
        case 13:
            (y ? x : _)(),
            e.preventDefault();
            break;
        case 37:
            x(),
            e.preventDefault();
            break;
        case 39:
            _(),
            e.preventDefault();
            break;
        case 38:
            6 <= i.trial.recallCursor && i.trial.recallCursor <= 17 ? (i.setRecallCursor(i.trial.recallCursor - 6),
            i.$$phase || i.$apply()) : 21 <= i.trial.recallCursor && (i.setRecallCursor(i.trial.recallCursor - 9),
            i.$$phase || i.$apply()),
            e.preventDefault();
            break;
        case 40:
            i.trial.recallCursor <= 11 && i.trial.recallCursor + 6 < i.trial.memo.length ? (i.setRecallCursor(i.trial.recallCursor + 6),
            i.$$phase || i.$apply()) : 12 <= i.trial.recallCursor && i.trial.recallCursor <= 21 && i.trial.recallCursor + 9 < i.trial.memo.length && (i.setRecallCursor(i.trial.recallCursor + 9),
            i.$$phase || i.$apply()),
            e.preventDefault();
            break;
        case 16:
            y = !0
        }
    }
    function V() {
        firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + m).push({
            focus: !1,
            phase: i.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function E() {
        firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + m).push({
            focus: !0,
            phase: i.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function H(e) {
        switch (i.phase) {
        case "Memo":
            !function(e) {
                switch (e.which) {
                case 13:
                    i.stopMemo(),
                    e.preventDefault();
                    break;
                case 32:
                case 38:
                case 87:
                    i.memoReturn(),
                    i.$$phase || i.$apply(),
                    e.preventDefault();
                    break;
                case 37:
                case 65:
                    i.memoPrev(),
                    i.$$phase || i.$apply(),
                    e.preventDefault();
                    break;
                case 39:
                case 68:
                    i.memoNext(),
                    i.$$phase || i.$apply(),
                    e.preventDefault()
                }
            }(e);
            break;
        case "Recall":
            F(e)
        }
    }
    function B(e) {
        16 === e.which && y && (y = !1)
    }
    function q(e) {
        setTimeout(function() {
            r || (firebase.database().ref("pending").push({
                matchId: m,
                recall: i.trial.recall,
                requestType: "endCompete",
                self: i.self,
                solo: i.match.solo || !1,
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                userId: firebase.auth().currentUser.uid
            }),
            firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/status").set("Finished"),
            i.match.competitors[i.self].status = "Finished",
            r = !0),
            e && (C = !0,
            o.path("view-names/" + m),
            i.$$phase || i.$apply())
        }, 1e3 * v)
    }
    function G() {
        var e = (Date.now() - T) / 1e3;
        if (n ? n = !1 : d && (2 < e - d || e - d < 0) && (T += 1e3 * (e - d - 1),
        e = (Date.now() - T) / 1e3),
        (d = e) < R && (i.phase = "PreMemo",
        w = R - e),
        R <= e && e < R + i.match.competitors[i.self].memoTime && (i.phase = "Memo",
        w = R + k - e),
        e >= R + i.match.competitors[i.self].memoTime && e < R + k + N && ("PreRecall" !== i.phase && (i.phase = "PreRecall",
        $("body, .wrapper").removeClass("opponentFinished")),
        w = R + k + N - e),
        R + k + N <= e && e < R + k + N + A && ("Recall" !== i.phase && "Finished" !== i.phase && (i.phase = "Recall",
        i.showFinished = !1,
        t(function() {
            i.showFinished = !0
        }, 2e3),
        t(function() {
            $("#namesRecall" + i.trial.inverseRecallSeqs[0]).focus()
        })),
        w = R + k + N + A - e),
        R + k + N + A < e)
            return i.phase = "Finished",
            i.$$phase || i.$apply(),
            void q(!0);
        i.timerMin = Math.floor(Math.round(w) / 60),
        e = Math.round(w) % 60,
        i.timerSec = (e < 10 ? "0" : "") + e,
        i.timerWarning = ("Memo" === i.phase || "Recall" === i.phase) && Math.round(w) < 10,
        S = t(G, 1e3)
    }
    c = 0,
    m = e.matchId,
    p = [],
    g = [],
    b = [],
    v = 0,
    i.comments = [],
    i.countryNames = countryNames,
    i.modalId = "m" + (new Date).getTime(),
    i.site = window.site,
    i.urls = {},
    i.competitorClick = function(e, a, t) {
        var r, s;
        $(".ui.modal.competitorModal").modal("show"),
        i.competitorData = {
            flag: t,
            id: e,
            name: a
        },
        i.competitorLoading = !0,
        i.$$phase || i.$apply(),
        s = r = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            i.competitorData.ratings = e.val(),
            r = !0,
            s && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            i.competitorData.recentBest = e.val(),
            s = !0,
            r && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        })
    }
    ,
    firebase.database().ref("league/current/seasonText").once("value", function(e) {
        i.seasonText = e.val(),
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("matches/" + m).once("value", function(e) {
        var a, t, r;
        function s() {
            --t || (i.imagesLoaded = !0,
            i.$$phase || i.$apply())
        }
        if (i.match = e.val(),
        i.match.competitors[0].userId === firebase.auth().currentUser.uid && (i.self = 0),
        i.match.competitors[1].userId === firebase.auth().currentUser.uid && (i.self = 1),
        0 !== i.self && 1 !== i.self || "Finished" === i.match.competitors[i.self].status && !i.match.championshipId || i.match.endTime)
            return C = !0,
            o.path("view-names/" + m),
            void (i.$$phase || i.$apply());
        for (i.opponent = 1 - i.self,
        i.trial = i.match.competitors[i.self],
        t = i.trial.memo.length,
        r = [],
        a = 0; a < i.trial.memo.length; a++)
            !function(a) {
                firebase.storage().ref("names/" + i.trial.memo[a].photo).getDownloadURL().then(function(e) {
                    i.urls[i.trial.memo[a].photo] = e,
                    r[a] = new Image,
                    r[a].onload = s,
                    r[a].src = e
                })
            }(a);
        i.match.championshipId && (firebase.database().ref("championships/" + i.match.championshipId + "/commonConfig/title").once("value", function(e) {
            i.championshipTitle = e.val() || ""
        }),
        "remote" !== i.match.championshipId.substring(0, 6) && "japan2020" !== i.match.championshipId && (v = 0)),
        (l = firebase.database().ref("matches/" + m + "/competitors/" + i.opponent + "/matchType")).on("value", function(e) {
            i.match.competitors[i.opponent].matchType = e.val(),
            i.setReady(!1),
            i.$$phase || i.$apply()
        }),
        (I = firebase.database().ref("matches/" + m + "/competitors/" + i.opponent + "/status")).on("value", function(e) {
            i.match.competitors[i.opponent].status = e.val(),
            D(),
            "Finished" === i.match.competitors[0].status && "Finished" === i.match.competitors[1].status && (C = !0,
            o.path("view-names/" + m),
            i.$$phase || i.$apply()),
            i.$$phase || i.$apply()
        }),
        (u = firebase.database().ref("matches/" + m + "/competitors/" + i.opponent + "/memoTimeRT")).on("value", function(e) {
            e = e.val();
            "Memo" === i.phase && e < k && $("body, .wrapper").addClass("opponentFinished")
        }),
        -999 === i.match.startTime ? P() : i.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            T = i.match.startTime - e,
            G()
        }) : (i.phase = "Splash",
        i.$$phase || i.$apply(),
        (M = firebase.database().ref("matches/" + m + "/startTime")).on("value", function(e) {
            -999 === e.val() && P(),
            0 < e.val() && (T = Date.now(),
            G())
        }),
        (h = firebase.database().ref("prematchComments/" + m)).on("child_added", function(e) {
            var a = document.getElementById("comments");
            i.comments.push(e.val()),
            a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
                a.scrollTop = a.scrollHeight
            }, 0),
            i.$$phase || i.$apply()
        }))
    }),
    i.matchTypeClick = function(e) {
        "" === i.match.competitors[i.self].status && (i.match.competitors[i.self].matchType = e,
        firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/matchType").set(e),
        i.setReady(!1))
    }
    ,
    i.setReady = function(e) {
        i.match.competitors[i.self].status = e ? "Ready" : "",
        firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/status").set(e ? "Ready" : ""),
        i.match.championshipId && firebase.database().ref("championships/" + i.match.championshipId + "/matchesSummary/" + i.match.matchKey + "/competitors/" + i.self + "/status").set(e ? "Ready" : ""),
        i.readyHide = e ? "readyHide" : "",
        e && !i.match.championshipId && (f = t(U, 2e4)),
        D()
    }
    ,
    i.stopMemo = function(e) {
        e = e || Date.now(),
        i.trial.memoTime = Math.round((e - T) / 10) / 100 - R,
        i.trial.memoTime > k && (i.trial.memoTime = k),
        i.trial.memoTime < k && (firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/memoTimeRT").set(i.trial.memoTime),
        setTimeout(function() {
            firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/memoTime").set(i.trial.memoTime)
        }, 1e3 * v)),
        i.phase = "PreRecall",
        e = R + k + N - (e - T) / 1e3,
        i.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        i.timerSec = (e < 10 ? "0" : "") + e,
        i.$$phase || i.$apply(),
        $("body, .wrapper").removeClass("opponentFinished")
    }
    ,
    i.memoPrev = function() {
        0 < i.trial.memoCursor && L(i.trial.memoCursor - 1)
    }
    ,
    i.memoNext = function() {
        i.trial.memoCursor === i.trial.memo.length - 1 ? Date.now() - c < 500 ? i.stopMemo(c) : c = Date.now() : L(i.trial.memoCursor + 1)
    }
    ,
    i.memoReturn = function() {
        L(0)
    }
    ,
    i.memoClassPhoto = function(e) {
        return "Memo" !== i.phase ? "" : e == i.trial.memoCursor ? "namesMemoPhotoMid" : e > i.trial.memoCursor ? "namesMemoRight" + (e - 1) : "namesMemoLeft" + e
    }
    ,
    i.memoClassName = function(e) {
        return "Memo" !== i.phase ? "" : e == i.trial.memoCursor ? "namesMemoNameMid" : e > i.trial.memoCursor ? "namesMemoRight" + (e - 1) : "namesMemoLeft" + e
    }
    ,
    $(document).keydown(H),
    $(document).keyup(B),
    $(window).blur(V),
    $(window).focus(E),
    i.setRecallCursor = function(e) {
        i.trial.recallCursor = e,
        g.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/recallCursor").set(g.shift())
        }, 1e3 * v),
        $("#namesRecall" + i.trial.inverseRecallSeqs[e]).focus()
    }
    ,
    i.setPokerRecallCursor = function(e) {
        for (var a = 0; a < 52; a++)
            if (i.trial.recall.cards[a] === e)
                return;
        i.trial.pokerRecallCursor = e,
        firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/pokerRecallCursor").set(e)
    }
    ,
    i.recallChange = function(e) {
        b.push({
            item: e,
            recall: i.trial.recall[e]
        }),
        setTimeout(function() {
            var e = b.shift();
            firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/recall/" + e.item).set(e.recall)
        }, 1e3 * v)
    }
    ,
    i.pokerRecallChangeName = function(e) {
        firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/recall/names/" + e).set(i.trial.recall.names[e])
    }
    ,
    i.finishedRecallClick = function() {
        i.phase = "Finished",
        i.$$phase || i.$apply(),
        i.match.championshipId && "pao" !== i.match.championshipId.substring(0, 3) && "aoo" !== i.match.championshipId.substring(0, 3) && "aeo" !== i.match.championshipId.substring(0, 3) && "world" !== i.match.championshipId.substring(0, 5) ? q(!1) : q(!0)
    }
    ,
    i.continueClick = function() {
        o.path("compete")
    }
    ,
    i.pokerRecallClass = function(e) {
        var a;
        return i.match && i.match.poker && "Recall" === i.phase ? (a = "cardsRecall_e card" + e + "_e",
        i.trial.recall.cards[e] < 52 ? a += " pokerRecallPos" + i.trial.recall.cards[e] : a += " pokerRecallPosBottom" + (i.trial.recall.cards[e] - 52),
        a) : ""
    }
    ,
    i.recallBoxClick = function(e) {
        i.setPokerRecallCursor(e)
    }
    ,
    i.cardClick = function(e) {
        var a;
        51 < i.trial.recall.cards[e] ? -1 !== i.trial.pokerRecallCursor && (i.trial.recall.cards[e] = i.trial.pokerRecallCursor,
        firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/recall/cards/" + e).set(i.trial.pokerRecallCursor),
        i.setPokerRecallCursor(function() {
            var e, a, t, r;
            if (!s.user)
                return -1;
            for (t = [],
            a = 0; a < 30; a += 1)
                t[a] = !1;
            for (e = 0; e < 52; e += 1)
                i.trial.recall.cards[e] < 52 && (t[i.trial.recall.cards[e]] = !0);
            for (a = 0; a < 30; a += 1)
                if (!t[r = "LTR" === s.user.prefs.cardsDirection ? (i.trial.pokerRecallCursor + a + 1) % 30 : (i.trial.pokerRecallCursor - a - 1 + 30) % 30])
                    return r;
            return -1
        }())) : (a = i.trial.recall.cards[e],
        i.trial.recall.cards[e] = i.trial.origRecall[e],
        firebase.database().ref("matches/" + m + "/competitors/" + i.self + "/recall/cards/" + e).set(i.trial.origRecall[e]),
        i.setPokerRecallCursor(a))
    }
    ,
    i.$on("$locationChangeStart", function(e) {
        i.phase && !C && (n = !0,
        confirm("Are you sure you want to exit the game?") || e.preventDefault())
    }),
    i.sendClick = function() {
        i.comment.trim() && (firebase.database().ref("prematchComments/" + m).push({
            author: i.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: i.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        }),
        i.comment = "",
        i.$$phase || i.$apply())
    }
    ,
    i.$on("$destroy", function() {
        $(".ui.modal.competitorModal." + i.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + i.modalId).remove(),
        t.cancel(f),
        t.cancel(S),
        i.match && i.match.competitors && i.match.competitors[i.self] && "Ready" === i.match.competitors[i.self].status && i.setReady(!1),
        $(document).off("keydown", H),
        $(document).off("keyup", B),
        $(window).off("blur", V),
        $(window).off("focus", E),
        $("body, .wrapper").removeClass("opponentFinished"),
        l && l.off(),
        u && u.off(),
        h && h.off(),
        M && M.off(),
        I && I.off()
    })
}
]),
angular.module("myApp.compete-numbers", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/compete-numbers/:matchId", {
        templateUrl: "compete-numbers/compete-numbers.html",
        controller: "CompeteNumbersCtrl"
    })
}
]).controller("CompeteNumbersCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(t, e, r, o, a) {
    window.myscope = o;
    var s, i, n, c, m, l, p, u, h, d, f, g, b, v, w, y, C, T, M, I = 20, S = 20, R = 60, k = 10, N = 240, A = 0;
    function D() {
        o.match.championshipId || o.self || "Ready" !== o.match.competitors[0].status || "Ready" !== o.match.competitors[1].status || firebase.database().ref("pending").push({
            matchId: c,
            requestType: "start",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    function P() {
        alert("This game has been reset. Please leave the game and return to the Home page.")
    }
    function U() {
        o.setReady(!1)
    }
    function L(e) {
        o.trial.memoCursor = e,
        l.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + c + "/competitors/" + o.self + "/memoCursor").set(l.shift())
        }, 1e3 * b)
    }
    function _() {
        firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + c).push({
            focus: !1,
            phase: o.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function x() {
        firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + c).push({
            focus: !0,
            phase: o.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function F(e) {
        switch (o.phase) {
        case "Memo":
            !function(e) {
                if (o.match.sudoku)
                    13 === e.which && (o.stopMemo(),
                    e.preventDefault());
                else
                    switch (e.which) {
                    case 13:
                        o.stopMemo(),
                        e.preventDefault();
                        break;
                    case 32:
                    case 38:
                    case 87:
                        o.memoReturn(),
                        o.$$phase || o.$apply(),
                        e.preventDefault();
                        break;
                    case 37:
                    case 65:
                        o.memoPrev(),
                        o.$$phase || o.$apply(),
                        e.preventDefault();
                        break;
                    case 39:
                    case 68:
                        o.memoNext(),
                        o.$$phase || o.$apply(),
                        e.preventDefault()
                    }
            }(e);
            break;
        case "Recall":
            !function(e) {
                if (o.match.hexadecimal)
                    switch (e.which) {
                    case 65:
                    case 66:
                    case 67:
                    case 68:
                    case 69:
                    case 70:
                        return o.recallDigit(String.fromCharCode(e.which)),
                        e.preventDefault(),
                        o.$$phase || o.$apply()
                    }
                switch (e.which) {
                case 8:
                    0 !== o.trial.recallCursor && o.setRecallCursor(o.trial.recallCursor - 1),
                    E(o.trial.recallCursor, ""),
                    e.preventDefault();
                    break;
                case 37:
                case 65:
                    0 !== o.trial.recallCursor && o.setRecallCursor(o.trial.recallCursor - 1),
                    e.preventDefault();
                    break;
                case 38:
                case 87:
                    o.trial.recallCursor > I - 1 && o.setRecallCursor(o.trial.recallCursor - I),
                    e.preventDefault();
                    break;
                case 39:
                case 68:
                    o.trial.recallCursor !== o.trial.memo.length - 1 && o.setRecallCursor(o.trial.recallCursor + 1),
                    e.preventDefault();
                    break;
                case 40:
                case 83:
                    o.trial.recallCursor < o.trial.memo.length - I && o.setRecallCursor(o.trial.recallCursor + I),
                    e.preventDefault();
                    break;
                case 46:
                    E(o.trial.recallCursor, "")
                }
                o.match.sudoku && (48 === e.which || 96 === e.which) || (o.match.sudoku && 32 === e.which && E(o.trial.recallCursor, ""),
                (48 <= e.which && e.which <= 57 || 96 <= e.which && e.which <= 105) && (48 <= e.which && e.which <= 57 ? o.recallDigit(e.which - 48) : o.recallDigit(e.which - 96)),
                o.$$phase || o.$apply())
            }(e)
        }
    }
    function V(e) {
        "Recall" === o.phase && function(e) {
            if (!o.match.randomAccess && !o.match.sudoku)
                switch (e.which) {
                case 43:
                case 61:
                    H(o.trial.recallCursor),
                    o.$$phase || o.$apply(),
                    e.preventDefault();
                    break;
                case 45:
                    B(o.trial.recallCursor),
                    o.$$phase || o.$apply(),
                    e.preventDefault()
                }
        }(e)
    }
    function E(e, a) {
        o.trial.recall[e] = a,
        g.push({
            item: e,
            recall: a
        }),
        setTimeout(function() {
            var e = g.shift();
            firebase.database().ref("matches/" + c + "/competitors/" + o.self + "/recall/" + e.item).set(e.recall)
        }, 1e3 * b)
    }
    function H(e) {
        for (var a = o.trial.memo.length - 1; e < a; --a)
            E(a, o.trial.recall[a - 1]);
        E(e, ""),
        o.$$phase || o.$apply()
    }
    function B(e) {
        for (var a = e; a < o.trial.memo.length - 1; a += 1)
            E(a, o.trial.recall[a + 1]);
        E(o.trial.memo.length - 1, ""),
        o.$$phase || o.$apply()
    }
    function q(e) {
        setTimeout(function() {
            s || (firebase.database().ref("pending").push({
                matchId: c,
                recall: o.trial.recall,
                requestType: "endCompete",
                self: o.self,
                solo: o.match.solo || !1,
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                userId: firebase.auth().currentUser.uid
            }),
            firebase.database().ref("matches/" + c + "/competitors/" + o.self + "/status").set("Finished"),
            o.match.competitors[o.self].status = "Finished",
            s = !0),
            e && (w = !0,
            t.path("view-numbers/" + c),
            o.$$phase || o.$apply())
        }, 1e3 * b)
    }
    function G() {
        var e = (Date.now() - y) / 1e3;
        if (i ? i = !1 : h && (2 < e - h || e - h < 0) && (y += 1e3 * (e - h - 1),
        e = (Date.now() - y) / 1e3),
        (h = e) < S && (o.phase = "PreMemo",
        v = S - e),
        S <= e && e < S + o.match.competitors[o.self].memoTime && (o.phase = "Memo",
        v = S + R - e),
        e >= S + o.match.competitors[o.self].memoTime && e < S + R + k && ("PreRecall" !== o.phase && (o.phase = "PreRecall",
        $("body, .wrapper").removeClass("opponentFinished")),
        v = S + R + k - e),
        S + R + k <= e && e < S + R + k + N && ("Recall" !== o.phase && "Finished" !== o.phase && (o.phase = "Recall",
        o.showFinished = !1,
        a(function() {
            o.showFinished = !0
        }, 2e3)),
        v = S + R + k + N - e),
        S + R + k + N < e)
            return o.phase = "Finished",
            o.$$phase || o.$apply(),
            void q(!0);
        o.timerMin = Math.floor(Math.round(v) / 60),
        e = Math.round(v) % 60,
        o.timerSec = (e < 10 ? "0" : "") + e,
        o.timerWarning = ("Memo" === o.phase || "Recall" === o.phase) && Math.round(v) < 10,
        M = a(G, 1e3)
    }
    n = 0,
    c = e.matchId,
    l = [],
    f = [],
    g = [],
    b = 0,
    o.comments = [],
    o.countryNames = countryNames,
    o.modalId = "m" + (new Date).getTime(),
    o.site = window.site,
    o.competitorClick = function(e, a, t) {
        var r, s;
        $(".ui.modal.competitorModal").modal("show"),
        o.competitorData = {
            flag: t,
            id: e,
            name: a
        },
        o.competitorLoading = !0,
        o.$$phase || o.$apply(),
        s = r = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            o.competitorData.ratings = e.val(),
            r = !0,
            s && (o.competitorLoading = !1,
            o.$$phase || o.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            o.competitorData.recentBest = e.val(),
            s = !0,
            r && (o.competitorLoading = !1,
            o.$$phase || o.$apply())
        })
    }
    ,
    firebase.database().ref("league/current/seasonText").once("value", function(e) {
        o.seasonText = e.val(),
        o.$$phase || o.$apply()
    }),
    firebase.database().ref("matches/" + c).once("value", function(e) {
        var a;
        if (o.match = e.val(),
        o.match.competitors[0].userId === firebase.auth().currentUser.uid && (o.self = 0),
        o.match.competitors[1].userId === firebase.auth().currentUser.uid && (o.self = 1),
        0 !== o.self && 1 !== o.self || "Finished" === o.match.competitors[o.self].status && !o.match.championshipId || o.match.endTime)
            return w = !0,
            t.path("view-numbers/" + c),
            void (o.$$phase || o.$apply());
        for (o.opponent = 1 - o.self,
        o.trial = o.match.competitors[o.self],
        a = 0; a < o.trial.info.groupCount; a += 1)
            o.trial.info.groups[a].contents = r.trustAsHtml(o.trial.info.groups[a].contents);
        o.match.sudoku && (I = 9),
        o.match.championshipId && (firebase.database().ref("championships/" + o.match.championshipId + "/commonConfig/title").once("value", function(e) {
            o.championshipTitle = e.val() || ""
        }),
        "remote" !== o.match.championshipId.substring(0, 6) && "japan2020" !== o.match.championshipId && (b = 0)),
        (m = firebase.database().ref("matches/" + c + "/competitors/" + o.opponent + "/matchType")).on("value", function(e) {
            o.match.competitors[o.opponent].matchType = e.val(),
            o.setReady(!1),
            o.$$phase || o.$apply()
        }),
        (T = firebase.database().ref("matches/" + c + "/competitors/" + o.opponent + "/status")).on("value", function(e) {
            o.match.competitors[o.opponent].status = e.val(),
            D(),
            "Finished" === o.match.competitors[0].status && "Finished" === o.match.competitors[1].status && (w = !0,
            t.path("view-numbers/" + c),
            o.$$phase || o.$apply()),
            o.$$phase || o.$apply()
        }),
        (p = firebase.database().ref("matches/" + c + "/competitors/" + o.opponent + "/memoTimeRT")).on("value", function(e) {
            e = e.val();
            "Memo" === o.phase && e < R && $("body, .wrapper").addClass("opponentFinished")
        }),
        -999 === o.match.startTime ? P() : o.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            y = o.match.startTime - e,
            G()
        }) : (o.phase = "Splash",
        o.$$phase || o.$apply(),
        (C = firebase.database().ref("matches/" + c + "/startTime")).on("value", function(e) {
            -999 === e.val() && P(),
            0 < e.val() && (y = Date.now(),
            G())
        }),
        (u = firebase.database().ref("prematchComments/" + c)).on("child_added", function(e) {
            var a = document.getElementById("comments");
            o.comments.push(e.val()),
            a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
                a.scrollTop = a.scrollHeight
            }, 0),
            o.$$phase || o.$apply()
        }))
    }),
    o.matchTypeClick = function(e) {
        "" === o.match.competitors[o.self].status && (o.match.competitors[o.self].matchType = e,
        firebase.database().ref("matches/" + c + "/competitors/" + o.self + "/matchType").set(e),
        o.setReady(!1))
    }
    ,
    o.setReady = function(e) {
        o.match.competitors[o.self].status = e ? "Ready" : "",
        firebase.database().ref("matches/" + c + "/competitors/" + o.self + "/status").set(e ? "Ready" : ""),
        o.match.championshipId && firebase.database().ref("championships/" + o.match.championshipId + "/matchesSummary/" + o.match.matchKey + "/competitors/" + o.self + "/status").set(e ? "Ready" : ""),
        o.readyHide = e ? "readyHide" : "",
        e && !o.match.championshipId && (d = a(U, 2e4)),
        D()
    }
    ,
    o.stopMemo = function(e) {
        e = e || Date.now(),
        o.trial.memoTime = Math.round((e - y) / 10) / 100 - S,
        o.trial.memoTime > R && (o.trial.memoTime = R),
        o.trial.memoTime < R && (firebase.database().ref("matches/" + c + "/competitors/" + o.self + "/memoTimeRT").set(o.trial.memoTime),
        setTimeout(function() {
            firebase.database().ref("matches/" + c + "/competitors/" + o.self + "/memoTime").set(o.trial.memoTime)
        }, 1e3 * b)),
        o.phase = "PreRecall",
        e = S + R + k - (e - y) / 1e3,
        o.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        o.timerSec = (e < 10 ? "0" : "") + e,
        o.$$phase || o.$apply(),
        $("body, .wrapper").removeClass("opponentFinished")
    }
    ,
    o.memoPrev = function() {
        0 < o.trial.memoCursor && L(o.trial.memoCursor - 1)
    }
    ,
    o.memoNext = function() {
        o.trial.memoCursor === o.trial.info.groupCount - 1 ? Date.now() - n < 500 ? o.stopMemo(n) : n = Date.now() : L(o.trial.memoCursor + 1)
    }
    ,
    o.memoReturn = function() {
        L(0)
    }
    ,
    o.nextRandomAccessPosition = function() {
        var e;
        79 < ++A ? o.finishedRecallClick() : (e = o.match.recallSequence[A],
        o.trial.recallCursor = e,
        f.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + c + "/competitors/" + o.self + "/recallCursor").set(f.shift())
        }, 1e3 * b))
    }
    ,
    o.recallDigit = function(e) {
        E(o.trial.recallCursor, e),
        o.match.randomAccess ? o.nextRandomAccessPosition() : o.trial.recallCursor < o.trial.memo.length - 1 && o.setRecallCursor(o.trial.recallCursor + 1)
    }
    ,
    $(document).keydown(F),
    $(document).keypress(V),
    $(window).blur(_),
    $(window).focus(x),
    o.memoClass = function(e) {
        return "" === o.phase ? "" : e === o.trial.memoCursor ? "numbersMemoMid" : e > o.trial.memoCursor ? "numbersMemoRight" + o.trial.info.groups[e].position : "numbersMemoLeft" + o.trial.info.groups[e].position
    }
    ,
    o.setRecallCursor = function(e) {
        o.match.randomAccess || (o.trial.recallCursor = e,
        f.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + c + "/competitors/" + o.self + "/recallCursor").set(f.shift())
        }, 1e3 * b))
    }
    ,
    o.shiftLeftClick = function() {
        B(o.trial.recallCursor)
    }
    ,
    o.shiftRightClick = function() {
        H(o.trial.recallCursor)
    }
    ,
    o.finishedRecallClick = function() {
        o.phase = "Finished",
        o.$$phase || o.$apply(),
        o.match.championshipId && "pao" !== o.match.championshipId.substring(0, 3) && "aoo" !== o.match.championshipId.substring(0, 3) && "aeo" !== o.match.championshipId.substring(0, 3) && "world" !== o.match.championshipId.substring(0, 5) ? q(!1) : q(!0)
    }
    ,
    o.continueClick = function() {
        t.path("compete")
    }
    ,
    o.$on("$locationChangeStart", function(e) {
        o.phase && !w && (i = !0,
        confirm("Are you sure you want to exit the game?") || e.preventDefault())
    }),
    o.sendClick = function() {
        o.comment.trim() && (firebase.database().ref("prematchComments/" + c).push({
            author: o.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: o.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        }),
        o.comment = "",
        o.$$phase || o.$apply())
    }
    ,
    o.$on("$destroy", function() {
        $(".ui.modal.competitorModal." + o.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + o.modalId).remove(),
        a.cancel(d),
        a.cancel(M),
        o.match && o.match.competitors && o.match.competitors[o.self] && "Ready" === o.match.competitors[o.self].status && o.setReady(!1),
        $(document).off("keydown", F),
        $(document).off("keypress", V),
        $(window).off("blur", _),
        $(window).off("focus", x),
        $("body, .wrapper").removeClass("opponentFinished"),
        m && m.off(),
        p && p.off(),
        u && u.off(),
        C && C.off(),
        T && T.off()
    })
}
]),
angular.module("myApp.compete-words", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/compete-words/:matchId", {
        templateUrl: "compete-words/compete-words.html",
        controller: "CompeteWordsCtrl"
    })
}
]).controller("CompeteWordsCtrl", ["$location", "$rootScope", "$routeParams", "$sce", "$scope", "$timeout", function(a, t, e, r, o, s) {
    window.myscope = o;
    var i, n, c, m, l, p, u, h, d, f, g, b, v, w, y, C, T, M, I, S, R = 20, k = 60, N = 10, A = 240;
    function D() {
        o.match.championshipId || o.self || "Ready" !== o.match.competitors[0].status || "Ready" !== o.match.competitors[1].status || firebase.database().ref("pending").push({
            matchId: m,
            requestType: "start",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    function P() {
        alert("This game has been reset. Please leave the game and return to the Home page.")
    }
    function U() {
        o.setReady(!1)
    }
    function L(e) {
        o.trial.memoCursor = e,
        p.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + m + "/competitors/" + o.self + "/memoCursor").set(p.shift())
        }, 1e3 * v)
    }
    function _() {
        o.trial.recallCursor !== o.trial.memo.length - 1 && (o.setRecallCursor(o.trial.recallCursor + 1),
        $("#wordsRecall" + o.trial.recallCursor).focus(),
        o.$$phase || o.$apply())
    }
    function x() {
        0 < o.trial.recallCursor && (o.setRecallCursor(o.trial.recallCursor - 1),
        $("#wordsRecall" + o.trial.recallCursor).focus(),
        o.$$phase || o.$apply())
    }
    function F(e) {
        if (o.match.flights)
            switch (e.which) {
            case 9:
            case 13:
                y ? 0 < o.trial.recallCursor && (o.setRecallCursor(o.trial.recallCursor - 1),
                $("#wordsRecall" + o.trial.recallCursor).focus(),
                o.$$phase || o.$apply()) : o.trial.recallCursor !== o.trial.memo.length - 1 && (o.setRecallCursor(o.trial.recallCursor + 1),
                $("#wordsRecall" + o.trial.recallCursor).focus(),
                o.$$phase || o.$apply()),
                e.preventDefault();
                break;
            case 16:
                y = !0
            }
        else
            switch (e.which) {
            case 9:
            case 13:
                (y ? x : _)(),
                e.preventDefault();
                break;
            case 40:
                _(),
                e.preventDefault();
                break;
            case 38:
                x(),
                e.preventDefault();
                break;
            case 37:
                0 <= o.trial.recallCursor - 10 && (o.setRecallCursor(o.trial.recallCursor - 10),
                $("#wordsRecall" + o.trial.recallCursor).focus(),
                o.$$phase || o.$apply()),
                e.preventDefault();
                break;
            case 39:
                o.trial.recallCursor + 10 < o.trial.memo.length && (o.setRecallCursor(o.trial.recallCursor + 10),
                $("#wordsRecall" + o.trial.recallCursor).focus(),
                o.$$phase || o.$apply()),
                e.preventDefault();
                break;
            case 16:
                y = !0
            }
    }
    function V(e) {
        if (!o.match.flights)
            switch (e.which) {
            case 43:
            case 61:
                !function(e) {
                    var a;
                    for (a = o.trial.memo.length - 1; e < a; --a)
                        W(a, o.trial.recall[a - 1]);
                    W(e, ""),
                    o.$$phase || o.$apply()
                }(o.trial.recallCursor),
                o.$$phase || o.$apply(),
                e.preventDefault();
                break;
            case 45:
                !function(e) {
                    var a;
                    for (a = e; a < o.trial.memo.length - 1; a += 1)
                        W(a, o.trial.recall[a + 1]);
                    W(o.trial.memo.length - 1, ""),
                    o.$$phase || o.$apply()
                }(o.trial.recallCursor),
                o.$$phase || o.$apply(),
                e.preventDefault()
            }
    }
    function E() {
        firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + m).push({
            focus: !1,
            phase: o.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function H() {
        firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/games/" + m).push({
            focus: !0,
            phase: o.phase || "",
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function B(e) {
        switch (o.phase) {
        case "Memo":
            !function(e) {
                if (o.match.flights)
                    13 === e.which && (o.stopMemo(),
                    e.preventDefault());
                else
                    switch (e.which) {
                    case 13:
                        o.stopMemo(),
                        e.preventDefault();
                        break;
                    case 32:
                    case 38:
                    case 87:
                        o.memoReturn(),
                        o.$$phase || o.$apply(),
                        e.preventDefault();
                        break;
                    case 37:
                    case 65:
                        o.memoPrev(),
                        o.$$phase || o.$apply(),
                        e.preventDefault();
                        break;
                    case 39:
                    case 68:
                        o.memoNext(),
                        o.$$phase || o.$apply(),
                        e.preventDefault()
                    }
            }(e);
            break;
        case "Recall":
            F(e)
        }
    }
    function q(e) {
        16 === e.which && y && (y = !1)
    }
    function G(e) {
        "Recall" === o.phase && V(e)
    }
    function W(e, a) {
        o.trial.recall[e] = a,
        o.recallChange(e)
    }
    function O(e) {
        setTimeout(function() {
            i || (firebase.database().ref("pending").push({
                matchId: m,
                recall: o.trial.recall,
                requestType: "endCompete",
                self: o.self,
                solo: o.match.solo || !1,
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                userId: firebase.auth().currentUser.uid
            }),
            firebase.database().ref("matches/" + m + "/competitors/" + o.self + "/status").set("Finished"),
            o.match.competitors[o.self].status = "Finished",
            i = !0),
            e && (C = !0,
            a.path("view-words/" + m),
            o.$$phase || o.$apply())
        }, 1e3 * v)
    }
    function z() {
        var e = (Date.now() - T) / 1e3;
        if (n ? n = !1 : d && (2 < e - d || e - d < 0) && (T += 1e3 * (e - d - 1),
        e = (Date.now() - T) / 1e3),
        (d = e) < R && (o.phase = "PreMemo",
        w = R - e),
        R <= e && e < R + o.match.competitors[o.self].memoTime && (o.phase = "Memo",
        w = R + k - e),
        e >= R + o.match.competitors[o.self].memoTime && e < R + k + N && ("PreRecall" !== o.phase && (o.phase = "PreRecall",
        $("body, .wrapper").removeClass("opponentFinished")),
        w = R + k + N - e),
        R + k + N <= e && e < R + k + N + A && ("Recall" !== o.phase && "Finished" !== o.phase && (o.phase = "Recall",
        o.showFinished = !1,
        s(function() {
            o.showFinished = !0
        }, 2e3)),
        w = R + k + N + A - e),
        R + k + N + A < e)
            return o.phase = "Finished",
            o.$$phase || o.$apply(),
            void O(!0);
        o.timerMin = Math.floor(Math.round(w) / 60),
        e = Math.round(w) % 60,
        o.timerSec = (e < 10 ? "0" : "") + e,
        o.timerWarning = ("Memo" === o.phase || "Recall" === o.phase) && Math.round(w) < 10,
        S = s(z, 1e3)
    }
    c = 0,
    m = e.matchId,
    p = [],
    g = [],
    b = [],
    v = 0,
    o.comments = [],
    o.countryNames = countryNames,
    o.modalId = "m" + (new Date).getTime(),
    o.site = window.site,
    o.competitorClick = function(e, a, t) {
        var r, s;
        $(".ui.modal.competitorModal").modal("show"),
        o.competitorData = {
            flag: t,
            id: e,
            name: a
        },
        o.competitorLoading = !0,
        o.$$phase || o.$apply(),
        s = r = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            o.competitorData.ratings = e.val(),
            r = !0,
            s && (o.competitorLoading = !1,
            o.$$phase || o.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            o.competitorData.recentBest = e.val(),
            s = !0,
            r && (o.competitorLoading = !1,
            o.$$phase || o.$apply())
        })
    }
    ,
    firebase.database().ref("league/current/seasonText").once("value", function(e) {
        o.seasonText = e.val(),
        o.$$phase || o.$apply()
    }),
    firebase.database().ref("matches/" + m).once("value", function(e) {
        return o.match = e.val(),
        o.match.competitors[0].userId === firebase.auth().currentUser.uid && (o.self = 0),
        o.match.competitors[1].userId === firebase.auth().currentUser.uid && (o.self = 1),
        0 !== o.self && 1 !== o.self || "Finished" === o.match.competitors[o.self].status && !o.match.championshipId || o.match.endTime ? (C = !0,
        a.path("view-words/" + m),
        void (o.$$phase || o.$apply())) : (o.opponent = 1 - o.self,
        o.trial = o.match.competitors[o.self],
        o.match.championshipId && (firebase.database().ref("championships/" + o.match.championshipId + "/commonConfig/title").once("value", function(e) {
            o.championshipTitle = e.val() || ""
        }),
        "remote" !== o.match.championshipId.substring(0, 6) && "japan2020" !== o.match.championshipId && (v = 0)),
        (l = firebase.database().ref("matches/" + m + "/competitors/" + o.opponent + "/matchType")).on("value", function(e) {
            o.match.competitors[o.opponent].matchType = e.val(),
            o.setReady(!1),
            o.$$phase || o.$apply()
        }),
        (I = firebase.database().ref("matches/" + m + "/competitors/" + o.opponent + "/status")).on("value", function(e) {
            o.match.competitors[o.opponent].status = e.val(),
            D(),
            "Finished" === o.match.competitors[0].status && "Finished" === o.match.competitors[1].status && (C = !0,
            a.path("view-words/" + m),
            o.$$phase || o.$apply()),
            o.$$phase || o.$apply()
        }),
        (u = firebase.database().ref("matches/" + m + "/competitors/" + o.opponent + "/memoTimeRT")).on("value", function(e) {
            e = e.val();
            "Memo" === o.phase && e < k && $("body, .wrapper").addClass("opponentFinished")
        }),
        void (-999 === o.match.startTime ? P() : o.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            T = o.match.startTime - e,
            z()
        }) : (o.phase = "Splash",
        o.$$phase || o.$apply(),
        (M = firebase.database().ref("matches/" + m + "/startTime")).on("value", function(e) {
            -999 === e.val() && P(),
            0 < e.val() && (T = Date.now(),
            z())
        }),
        (h = firebase.database().ref("prematchComments/" + m)).on("child_added", function(e) {
            var a = document.getElementById("comments");
            o.comments.push(e.val()),
            a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
                a.scrollTop = a.scrollHeight
            }, 0),
            o.$$phase || o.$apply()
        }))))
    }),
    o.matchTypeClick = function(e) {
        "" === o.match.competitors[o.self].status && (o.match.competitors[o.self].matchType = e,
        firebase.database().ref("matches/" + m + "/competitors/" + o.self + "/matchType").set(e),
        o.setReady(!1))
    }
    ,
    o.setReady = function(e) {
        o.match.competitors[o.self].status = e ? "Ready" : "",
        firebase.database().ref("matches/" + m + "/competitors/" + o.self + "/status").set(e ? "Ready" : ""),
        o.match.championshipId && firebase.database().ref("championships/" + o.match.championshipId + "/matchesSummary/" + o.match.matchKey + "/competitors/" + o.self + "/status").set(e ? "Ready" : ""),
        o.readyHide = e ? "readyHide" : "",
        e && !o.match.championshipId && (f = s(U, 2e4)),
        D()
    }
    ,
    o.stopMemo = function(e) {
        e = e || Date.now(),
        o.trial.memoTime = Math.round((e - T) / 10) / 100 - R,
        o.trial.memoTime > k && (o.trial.memoTime = k),
        o.trial.memoTime < k && (firebase.database().ref("matches/" + m + "/competitors/" + o.self + "/memoTimeRT").set(o.trial.memoTime),
        setTimeout(function() {
            firebase.database().ref("matches/" + m + "/competitors/" + o.self + "/memoTime").set(o.trial.memoTime)
        }, 1e3 * v)),
        o.phase = "PreRecall",
        e = R + k + N - (e - T) / 1e3,
        o.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        o.timerSec = (e < 10 ? "0" : "") + e,
        o.$$phase || o.$apply(),
        $("body, .wrapper").removeClass("opponentFinished")
    }
    ,
    o.memoPrev = function() {
        0 < o.trial.memoCursor && L(o.trial.memoCursor - 1)
    }
    ,
    o.memoNext = function() {
        o.trial.memoCursor === o.trial.info.groups.length - 1 ? Date.now() - c < 500 ? o.stopMemo(c) : c = Date.now() : L(o.trial.memoCursor + 1)
    }
    ,
    o.memoReturn = function() {
        L(0)
    }
    ,
    $(document).keydown(B),
    $(document).keyup(q),
    $(document).keypress(G),
    $(window).blur(E),
    $(window).focus(H),
    o.memoClass = function(e) {
        return "Memo" !== o.phase || e >= o.trial.memo.length ? "" : o.trial.info.words[e].groupNum === o.trial.memoCursor ? "wordsMemoMid" + o.trial.info.words[e].posInGroup : o.trial.info.words[e].groupNum > o.trial.memoCursor ? "wordsMemoRight" + (e - o.trial.info.groups[0].size) : "wordsMemoLeft" + e
    }
    ,
    o.setRecallCursor = function(e) {
        o.trial.recallCursor = e,
        g.push(e),
        setTimeout(function() {
            firebase.database().ref("matches/" + m + "/competitors/" + o.self + "/recallCursor").set(g.shift())
        }, 1e3 * v)
    }
    ,
    o.recallChange = function(e) {
        b.push({
            item: e,
            recall: o.trial.recall[e]
        }),
        setTimeout(function() {
            var e = b.shift();
            firebase.database().ref("matches/" + m + "/competitors/" + o.self + "/recall/" + e.item).set(e.recall)
        }, 1e3 * v)
    }
    ,
    o.finishedRecallClick = function() {
        o.phase = "Finished",
        o.$$phase || o.$apply(),
        o.match.championshipId && "pao" !== o.match.championshipId.substring(0, 3) && "aoo" !== o.match.championshipId.substring(0, 3) && "aeo" !== o.match.championshipId.substring(0, 3) && "world" !== o.match.championshipId.substring(0, 5) ? O(!1) : O(!0)
    }
    ,
    o.continueClick = function() {
        a.path("compete")
    }
    ,
    o.badWords = [];
    for (var j = 0; j < 6; j += 1)
        o.badWords.push({
            num: "",
            word: "",
            english: "",
            comments: ""
        });
    function K() {
        for (var e, a = 0; a < 6; a += 1)
            o.badWords[a].word && (firebase.database().ref("badWords").push({
                comments: o.badWords[a].comments,
                english: o.badWords[a].english,
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                userId: firebase.auth().currentUser.uid,
                word: o.badWords[a].word,
                wordsLanguage: t.user.prefs.wordsLanguage
            }),
            e = !0);
        e && $(".ui.modal.thanks").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    o.badWordsClick = function() {
        $(".ui.modal.badWords").modal("setting", {
            onApprove: K
        }).modal("show")
    }
    ,
    o.$on("$locationChangeStart", function(e) {
        o.phase && !C && (n = !0,
        confirm("Are you sure you want to exit the game?") || e.preventDefault())
    }),
    o.sendClick = function() {
        o.comment.trim() && (firebase.database().ref("prematchComments/" + m).push({
            author: o.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: o.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        }),
        o.comment = "",
        o.$$phase || o.$apply())
    }
    ,
    o.$on("$destroy", function() {
        $(".ui.modal.competitorModal." + o.modalId).modal("hide"),
        $(".ui.modal.badWords").remove(),
        $(".ui.modal.competitorModal." + o.modalId).remove(),
        $(".ui.modal.thanks").remove(),
        s.cancel(f),
        s.cancel(S),
        o.match && o.match.competitors && o.match.competitors[o.self] && "Ready" === o.match.competitors[o.self].status && o.setReady(!1),
        $(document).off("keydown", B),
        $(document).off("keyup", q),
        $(document).off("keypress", G),
        $(window).off("blur", E),
        $(window).off("focus", H),
        $("body, .wrapper").removeClass("opponentFinished"),
        l && l.off(),
        u && u.off(),
        h && h.off(),
        M && M.off(),
        I && I.off()
    })
}
]),
angular.module("myApp.contact", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/contact", {
        templateUrl: "contact/contact.html",
        controller: "ContactCtrl"
    })
}
]).controller("ContactCtrl", ["$scope", "$location", "$rootScope", "$timeout", function(a, e, t, r) {
    (window.myscope = a).sendClick = function() {
        a.sending = !0,
        firebase.database().ref("contactUs").push({
            subject: a.subject,
            message: a.message,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }, function(e) {
            a.messageClass = e ? "error" : "success",
            a.sending = !1,
            a.$$phase || a.$apply()
        })
    }
}
]),
angular.module("myApp.data", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/data", {
        templateUrl: "data/data.html",
        controller: "DataCtrl"
    })
}
]).controller("DataCtrl", ["$rootScope", "$scope", "$window", function(e, a, t) {
    var r;
    (window.myscope = a).waiting = !1,
    a.getRatedGamesData = function() {
        a.waiting = !0,
        a.$$phase || a.$apply(),
        r = firebase.database().ref("pending").push({
            requestType: "getRatedGamesForUser",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid,
            username: a.username.toLowerCase()
        }),
        firebase.database().ref("pending/" + r.key).on("value", function(e) {
            e.val() && e.val().done && (firebase.database().ref("pending/" + r.key).off(),
            r.remove(),
            a.userScores = e.val().userScores,
            a.waiting = !1,
            a.$$phase || a.$apply())
        })
    }
}
]),
angular.module("myApp.home", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/home", {
        templateUrl: "home/home.html",
        controller: "HomeCtrl"
    })
}
]).controller("HomeCtrl", ["$location", "$sce", "$scope", function(a, t, i) {
    var s, r, o;
    function e() {
        var a = document.getElementById("forumTopics");
        $.get("https://forum.artofmemory.com/c/memory-league/8.json", function(e) {
            var e = e.topic_list.topics.slice(1, 6).map(function(e) {
                return [e.title, "https://forum.artofmemory.com/t/" + e.slug + "/" + e.id]
            });
            e = (e = e).map(function(e) {
                return '<p><a href="' + e[1] + '" target="_blank" style="color: rgba(0,0,0,.87)">' + e[0] + "</a></p>"
            }),
            a && (a.innerHTML = e.join("\n"))
        })
    }
    function n() {
        var a, t, r, s;
        firebase.database().ref("recentAchievements").limitToLast(window.recentAchievementsCount).on("value", function(e) {
            if (a = e.val()) {
                for (i.recentAchievements = [],
                s = Object.keys(a),
                t = 0; t < s.length; t++)
                    r = s[t],
                    i.recentAchievements.unshift(a[r]);
                i.$$phase || i.$apply()
            }
        })
    }
    function c() {
        var e = i.recentMatches[0]
          , a = "Surprise" === e.eventName ? e.baseEventName : e.eventName;
        a = a.replace(" Names", "").toLowerCase(),
        e.viewUrl = "#!/view-" + a + "/" + e.matchId
    }
    function m(e) {
        var a, t, r;
        for (e = e || {},
        i.recentMatches = [],
        r = Object.keys(e),
        a = 0; a < r.length; a++)
            t = r[a],
            i.recentMatches.unshift(e[t]),
            i.recentMatches[0].key = t,
            c();
        i.recentMatchesSearching = !1,
        i.$$phase || i.$apply()
    }
    function l(e, a) {
        var t, r, s;
        for (i.recentMatches = [],
        s = Object.keys(e),
        t = 0; t < s.length; t++)
            r = s[t],
            i.recentMatches.unshift(e[r]),
            i.recentMatches[0].key = r,
            c();
        for (s = Object.keys(a),
        t = 0; t < s.length; t++)
            r = s[t],
            i.recentMatches.unshift(a[r]),
            i.recentMatches[0].key = r,
            c();
        i.recentMatches.sort(function(e, a) {
            return e.timestamp < a.timestamp ? 1 : -1
        }),
        i.recentMatches.length > window.recentMatchesCount && (i.recentMatches.length = window.recentMatchesCount),
        i.recentMatchesSearching = !1,
        i.$$phase || i.$apply()
    }
    function p() {
        var a, t, e, r;
        firebase.database().ref("recentMatches").off(),
        i.$$phase || i.$apply(),
        window.recentMatchesSearch.user0Name && !window.recentMatchesSearch.user1Name && (e = window.recentMatchesSearch.user0Name,
        r = ""),
        window.recentMatchesSearch.user1Name && !window.recentMatchesSearch.user0Name && (e = window.recentMatchesSearch.user1Name,
        r = ""),
        window.recentMatchesSearch.user0Name && window.recentMatchesSearch.user1Name && (e = window.recentMatchesSearch.user0Name,
        r = window.recentMatchesSearch.user1Name),
        window.recentMatchesSearch.championship || window.recentMatchesSearch.eventName || e || r ? !window.recentMatchesSearch.championship || window.recentMatchesSearch.eventName || e || r ? window.recentMatchesSearch.championship || !window.recentMatchesSearch.eventName || e || r ? window.recentMatchesSearch.championship || window.recentMatchesSearch.eventName || !e || r ? window.recentMatchesSearch.championship && window.recentMatchesSearch.eventName && !e && !r ? firebase.database().ref("recentMatches").orderByChild("championship_eventName").equalTo(window.recentMatchesSearch.championship + "|" + window.recentMatchesSearch.eventName).limitToLast(window.recentMatchesCount).on("value", function(e) {
            m(e.val())
        }) : window.recentMatchesSearch.championship && !window.recentMatchesSearch.eventName && e && !r ? (t = a = null,
        firebase.database().ref("recentMatches").orderByChild("championship_user0Name").equalTo(window.recentMatchesSearch.championship + "|" + e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            a = e.val() || {},
            t && l(a, t)
        }),
        firebase.database().ref("recentMatches").orderByChild("championship_user1Name").equalTo(window.recentMatchesSearch.championship + "|" + e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            t = e.val() || {},
            a && l(a, t)
        })) : !window.recentMatchesSearch.championship && window.recentMatchesSearch.eventName && e && !r ? (t = a = null,
        firebase.database().ref("recentMatches").orderByChild("eventName_user0Name").equalTo(window.recentMatchesSearch.eventName + "|" + e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            a = e.val() || {},
            t && l(a, t)
        }),
        firebase.database().ref("recentMatches").orderByChild("eventName_user1Name").equalTo(window.recentMatchesSearch.eventName + "|" + e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            t = e.val() || {},
            a && l(a, t)
        })) : !window.recentMatchesSearch.championship && !window.recentMatchesSearch.eventName && e && r ? (t = a = null,
        firebase.database().ref("recentMatches").orderByChild("user0Name_user1Name").equalTo(e + "|" + r).limitToLast(window.recentMatchesCount).on("value", function(e) {
            a = e.val() || {},
            t && l(a, t)
        }),
        firebase.database().ref("recentMatches").orderByChild("user0Name_user1Name").equalTo(r + "|" + e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            t = e.val() || {},
            a && l(a, t)
        })) : window.recentMatchesSearch.championship && window.recentMatchesSearch.eventName && e && !r ? (t = a = null,
        firebase.database().ref("recentMatches").orderByChild("championship_eventName_user0Name").equalTo(window.recentMatchesSearch.championship + "|" + window.recentMatchesSearch.eventName + "|" + e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            a = e.val() || {},
            t && l(a, t)
        }),
        firebase.database().ref("recentMatches").orderByChild("championship_eventName_user1Name").equalTo(window.recentMatchesSearch.championship + "|" + window.recentMatchesSearch.eventName + "|" + e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            t = e.val() || {},
            a && l(a, t)
        })) : window.recentMatchesSearch.championship && !window.recentMatchesSearch.eventName && e && r ? (t = a = null,
        firebase.database().ref("recentMatches").orderByChild("championship_user0Name_user1Name").equalTo(window.recentMatchesSearch.championship + "|" + e + "|" + r).limitToLast(window.recentMatchesCount).on("value", function(e) {
            a = e.val() || {},
            t && l(a, t)
        }),
        firebase.database().ref("recentMatches").orderByChild("championship_user0Name_user1Name").equalTo(window.recentMatchesSearch.championship + "|" + r + "|" + e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            t = e.val() || {},
            a && l(a, t)
        })) : !window.recentMatchesSearch.championship && window.recentMatchesSearch.eventName && e && r ? (t = a = null,
        firebase.database().ref("recentMatches").orderByChild("eventName_user0Name_user1Name").equalTo(window.recentMatchesSearch.eventName + "|" + e + "|" + r).limitToLast(window.recentMatchesCount).on("value", function(e) {
            a = e.val() || {},
            t && l(a, t)
        }),
        firebase.database().ref("recentMatches").orderByChild("eventName_user0Name_user1Name").equalTo(window.recentMatchesSearch.eventName + "|" + r + "|" + e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            t = e.val() || {},
            a && l(a, t)
        })) : window.recentMatchesSearch.championship && window.recentMatchesSearch.eventName && e && r && (t = a = null,
        firebase.database().ref("recentMatches").orderByChild("championship_eventName_user0Name_user1Name").equalTo(window.recentMatchesSearch.championship + "|" + window.recentMatchesSearch.eventName + "|" + e + "|" + r).limitToLast(window.recentMatchesCount).on("value", function(e) {
            a = e.val() || {},
            t && l(a, t)
        }),
        firebase.database().ref("recentMatches").orderByChild("championship_eventName_user0Name_user1Name").equalTo(window.recentMatchesSearch.championship + "|" + window.recentMatchesSearch.eventName + "|" + r + "|" + e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            t = e.val() || {},
            a && l(a, t)
        })) : (t = a = null,
        firebase.database().ref("recentMatches").orderByChild("user0Name").equalTo(e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            a = e.val() || {},
            t && l(a, t)
        }),
        firebase.database().ref("recentMatches").orderByChild("user1Name").equalTo(e).limitToLast(window.recentMatchesCount).on("value", function(e) {
            t = e.val() || {},
            a && l(a, t)
        })) : firebase.database().ref("recentMatches").orderByChild("eventName").equalTo(window.recentMatchesSearch.eventName).limitToLast(window.recentMatchesCount).on("value", function(e) {
            m(e.val())
        }) : firebase.database().ref("recentMatches").orderByChild("championship").equalTo(window.recentMatchesSearch.championship).limitToLast(window.recentMatchesCount).on("value", function(e) {
            m(e.val())
        }) : firebase.database().ref("recentMatches").limitToLast(window.recentMatchesCount).on("value", function(e) {
            m(e.val())
        })
    }
    function u() {
        firebase.database().ref("homeComments").limitToLast(window.commentsCount).on("value", function(e) {
            var a, t, r = e.val() || {};
            for (s = 7258118399e3,
            t = Object.keys(r),
            a = 0; a < t.length; a++)
                r[t[a]].timestamp < s && (s = r[t[a]].timestamp);
            i.comments = [],
            firebase.database().ref("homeComments").off(),
            firebase.database().ref("homeComments").orderByChild("timestamp").startAt(s).on("child_added", function(e) {
                var a = document.getElementById("comments");
                a && (i.comments.push(e.val()),
                !o && a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
                    a.scrollTop = a.scrollHeight
                }, 0),
                i.$$phase || i.$apply())
            })
        })
    }
    window.myscope = i,
    r = 0,
    o = !"20240129",
    i.competitorData = {},
    i.countryNames = countryNames,
    i.modalId = "m" + (new Date).getTime(),
    i.site = window.site,
    angular.element(document).ready(function() {
        setTimeout(e, 2e3)
    }),
    window.recentAchievementsCount = window.recentAchievementsCount || 8,
    window.recentMatchesCount = window.recentMatchesCount || 6,
    i.recentMatchesCount = window.recentMatchesCount,
    window.recentMatchesSearch = window.recentMatchesSearch || {
        championship: "",
        eventName: "",
        user0Name: "",
        user1Name: ""
    },
    window.searchVisible = window.searchVisible || !1,
    window.commentsCount = window.commentsCount || 6,
    i.search = {
        championship: window.recentMatchesSearch.championship,
        eventName: window.recentMatchesSearch.eventName,
        user0Name: window.recentMatchesSearch.user0Name,
        user1Name: window.recentMatchesSearch.user1Name
    },
    firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
        r = e.val()
    }),
    firebase.database().ref("currentChampionship").on("value", function(e) {
        i.currentChampionship = e.val(),
        i.currentChampionship.messageHtml && (i.currentChampionship.messageHtml = t.trustAsHtml(i.currentChampionship.messageHtml)),
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("publicMatches").on("value", function(e) {
        var a, t, r, s = e.val();
        if (i.championshipMatches = [],
        i.publicMatches = [],
        s)
            for (r = Object.keys(s),
            a = 0; a < r.length; a++)
                s[t = r[a]].matchId = t,
                i.currentChampionship.active && s[t].label && s[t].label.text === i.currentChampionship.matchLabelText ? (!s[t].restricted || i.user && i.user.viewRestricted) && i.championshipMatches.unshift(s[t]) : i.publicMatches.unshift(s[t]);
        i.championshipMatches.length || (i.championshipMatches = null),
        i.publicMatches.length || (i.publicMatches = null),
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("scheduledMatches").on("value", function(e) {
        var a, t;
        for (i.scheduledMatches = [],
        t = e.val() || [],
        a = 0; a < t.length; a++)
            t[a].timestamp >= Date.now() - 72e5 && i.scheduledMatches.push({
                competitorId1: t[a].competitorId1,
                competitorId2: t[a].competitorId2,
                date: new Date(t[a].timestamp).toLocaleString([], {
                    weekday: "short",
                    month: "short",
                    day: "numeric"
                }),
                flag1: t[a].flag1,
                flag2: t[a].flag2,
                originalIndex: a,
                live: t[a].live,
                matchDescription: t[a].matchDescription,
                name1: t[a].name1,
                name2: t[a].name2,
                time: new Date(t[a].timestamp).toLocaleString([], {
                    hour: "numeric",
                    minute: "2-digit"
                }),
                youtube: t[a].youtube
            });
        i.$$phase || i.$apply()
    }),
    n(),
    p(),
    firebase.database().ref("homeHtml/20240129").on("value", function(e) {
        i.homeHtml = t.trustAsHtml(e.val() || ""),
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("globalStats").on("value", function(e) {
        i.globalStats = e.val() || {},
        i.$$phase || i.$apply()
    }),
    i.comments = [],
    i.now = new Date,
    i.mlmDays = [],
    u(),
    i.showPreviousComments = function() {
        return 1528828965956 < s
    }
    ,
    firebase.database().ref("siteUpdates").on("value", function(e) {
        i.siteUpdates = e.val(),
        i.siteUpdatesSummary = i.siteUpdates.slice(0, 3),
        i.$$phase || i.$apply()
    }),
    i.mlmDays = function() {
        var e, a, t, r, s, o = (new Date).getFullYear();
        if (!(i.config && i.config.memoryLeagueMay && i.user && i.user["mlm" + o]))
            return 0;
        for (s = a = 0; s <= 31; s++)
            t = "d" + s,
            (t = i.user["mlm" + o][t]) && 3 <= t ? (i.mlmDays[s] = !0,
            a++) : i.mlmDays[s] = !1;
        return i.mlmDaysCached = a,
        setTimeout(function() {
            4 < (e = (new Date).getDate()) && (r = document.getElementById("mlMay" + (e - 3))),
            r && (document.getElementById("mlMay").scrollLeft = r.offsetLeft)
        }, 1),
        a
    }
    ,
    i.relativeTime = function(e) {
        e = (Date.now() - e + r) / 1e3;
        return e < 45 ? "a few seconds ago" : e < 90 ? "a minute ago" : e < 2700 ? Math.round(e / 60).toString() + " minutes ago" : e < 5400 ? "an hour ago" : e < 79200 ? Math.round(e / 60 / 60).toString() + " hours ago" : e < 129600 ? "a day ago" : Math.round(e / 60 / 60 / 24).toString() + " days ago"
    }
    ,
    i.scheduleClick = function(e) {
        var a;
        i.user.leagueLiveAdmin && (a = i.scheduledMatches[e].name1 + " vs " + i.scheduledMatches[e].name2,
        i.scheduledMatches[e].live ? window.confirm("Are you sure you want to remove the 'Live' label for " + a + "?") && firebase.database().ref("scheduledMatches/" + i.scheduledMatches[e].originalIndex).update({
            live: !1
        }) : window.confirm("Are you sure you want to add the 'Live' label for " + a + "?") && firebase.database().ref("scheduledMatches/" + i.scheduledMatches[e].originalIndex).update({
            live: !0
        }))
    }
    ,
    $(".competitorPopupController").popup({
        lastResort: "bottom center",
        movePopup: !1,
        on: "click",
        popup: "competitorPopup"
    }),
    $(".ui.dropdown.championship").dropdown({
        onChange: function(e) {
            i.search.championship = e
        }
    }).dropdown("set selected", window.recentMatchesSearch.championship),
    $(".ui.dropdown.eventName").dropdown({
        onChange: function(e) {
            i.search.eventName = e
        }
    }).dropdown("set selected", window.recentMatchesSearch.eventName),
    i.dismissExpiryWarning = function() {
        firebase.database().ref("pending").push({
            requestType: "dismiss",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        i.hideExpiryWarning = !0
    }
    ,
    i.competitorClick = function(e, a, t, r) {
        var s, o;
        $(".ui.modal.competitorModal").modal("show"),
        i.competitorData = {
            flag: t,
            id: e,
            name: a
        },
        i.competitorLoading = !0,
        i.$$phase || i.$apply(),
        o = s = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            i.competitorData.ratings = e.val(),
            s = !0,
            o && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            i.competitorData.recentBest = e.val(),
            o = !0,
            s && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        }),
        r && r.preventDefault()
    }
    ,
    i.challenge = function(e) {
        a.path("/compete/" + e + "/" + encodeURIComponent(i.competitorData.name))
    }
    ,
    i.showUpdates = function() {
        $(".ui.modal.updates").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    i.moreAchievements = function() {
        window.recentAchievementsCount += 10,
        n()
    }
    ,
    i.moreMatches = function() {
        window.recentMatchesCount += 10,
        i.recentMatchesCount = window.recentMatchesCount,
        p()
    }
    ,
    i.previousComments = function() {
        window.commentsCount = i.comments.length + 10,
        o = !0,
        u()
    }
    ,
    window.onscroll = function() {
        o = !1
    }
    ,
    i.sendClick = function() {
        var e;
        i.comment.trim() && (e = {
            author: i.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: i.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        },
        i.user.flag && (e.flag = i.user.flag),
        firebase.database().ref("homeComments").push(e),
        i.comment = "",
        i.$$phase || i.$apply())
    }
    ,
    window.searchVisible || $("#searchGames").transition("slide down", "1ms"),
    i.searchClick = function(e) {
        window.searchVisible = !window.searchVisible,
        window.searchVisible ? $("#searchGames").transition("slide down") : $("#searchGames").transition("slide down", "200ms"),
        document.getElementById("gameSearch").blur()
    }
    ,
    i.doSearch = function() {
        window.recentMatchesSearch = {
            championship: i.search.championship,
            eventName: i.search.eventName,
            user0Name: i.search.user0Name,
            user1Name: i.search.user1Name
        },
        window.recentMatchesCount = 6,
        i.recentMatchesCount = window.recentMatchesCount,
        i.recentMatches = [],
        i.recentMatchesSearching = !0,
        p()
    }
    ,
    i.clearSearch = function() {
        i.search.championship = "",
        $(".ui.dropdown.championship").dropdown("set selected", ""),
        i.search.eventName = "",
        $(".ui.dropdown.eventName").dropdown("set selected", ""),
        i.search.user0Name = "",
        i.search.user1Name = ""
    }
    ,
    i.searchKeyDown = function(e) {
        13 === e.keyCode && (i.doSearch(),
        e.stopPropagation())
    }
    ,
    i.$on("$destroy", function() {
        $(".ui.modal.competitorModal." + i.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + i.modalId).remove(),
        $(".ui.modal.updates").remove()
    })
}
]).controller("NavCtrl", ["$scope", "$location", "$rootScope", "$window", function(o, i, n, e) {
    var c, m;
    o.site = window.site,
    $(".ui.dropdown").dropdown({
        on: "click"
    }),
    firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
        c = e.val()
    }),
    firebase.database().ref("orangeGlow").on("value", function(e) {
        o.orangeGlow = e.val(),
        o.$$phase || o.$apply()
    }),
    firebase.database().ref("homeGlow").on("value", function(e) {
        o.homeGlow = e.val(),
        o.$$phase || o.$apply()
    }),
    firebase.database().ref("clientConfig").on("value", function(e) {
        n.config = e.val(),
        o.$$phase || o.$apply()
    }),
    o.isActive = function(e) {
        var a = i.path();
        return -1 !== a.indexOf("-") && -1 === a.indexOf("world-tour") && (a = a.substr(0, a.indexOf("-"))),
        -1 !== a.indexOf("/", 1) && (a = a.substr(0, a.indexOf("/", 1))),
        e === a
    }
    ,
    o.showMenu = function() {
        return void 0 !== o.user && ("/view-" !== i.path().substr(0, 6) || -1 === i.path().indexOf("Table"))
    }
    ,
    o.showGlow = function() {
        return (o.user && o.user.championshipMatchUrl || o.isChallenged) && -1 === i.path().indexOf("train-") && -1 === i.path().indexOf("compete")
    }
    ,
    o.showHomeGlow = function() {
        return o.homeGlow && "/home" !== i.path() && -1 === i.path().indexOf("train") && -1 === i.path().indexOf("compete")
    }
    ,
    o.showOrangeGlow = function() {
        return o.orangeGlow && !o.isChallenged && !(o.user && o.user.championshipMatchUrl) && -1 === i.path().indexOf("train-") && -1 === i.path().indexOf("compete-")
    }
    ,
    firebase.auth().onAuthStateChanged(function(e) {
        var a, t, r, s;
        if (e) {
            for (s = window.location.search.substr(1).split("&"),
            t = 0; t < s.length; t += 1)
                if ("a" === (r = s[t].split("="))[0])
                    return a = r[1],
                    firebase.database().ref("affiliateClicks").push({
                        affiliateId: a,
                        timestamp: firebase.database.ServerValue.TIMESTAMP,
                        userId: e.uid
                    }),
                    void firebase.database().ref("source/" + e.uid).push({
                        affiliateId: a,
                        timestamp: firebase.database.ServerValue.TIMESTAMP
                    }, function(e) {
                        window.location.href = window.location.href.replace("?a=" + a, "")
                    });
            m && m.off(),
            (m = firebase.database().ref("/users/" + e.uid)).on("value", function(e) {
                e.val() ? (n.user = e.val(),
                o.user = e.val(),
                o.showSignin = !1,
                o.user.termsAccepted ? "/signin" === i.path() && i.path("home") : i.path("account"),
                firebase.database().ref("challenges/" + firebase.auth().currentUser.uid).on("value", function(e) {
                    var a, t, r, s;
                    if (o.isChallenged = !1,
                    e.val() && (o.user && o.user.expiry > Date.now() || 0 < o.user.trialsRemaining))
                        for (t = e.val(),
                        s = Object.keys(t),
                        r = 0; r < s.length; r += 1)
                            if (a = t[s[r]],
                            a.timestamp - c > Date.now() - 5e3 && (o.user && o.user.expiry > Date.now() || o.user.trialsRemainingHigh || o.user.trialsRemaining && o.user.ratings[a.eventName].level < 6)) {
                                o.isChallenged = !0;
                                break
                            }
                    o.$$phase || o.$apply()
                })) : (n.user = null,
                o.user = null,
                n.showSignin = !0,
                o.showSignin = !0),
                o.$$phase || o.$apply()
            })
        } else
            n.user = null,
            o.user = null,
            o.showSignin = !0,
            firebase.auth().signInAnonymously().catch(function(e) {
                var a = e.code
                  , e = e.message;
                console.log(a, e)
            }),
            o.$$phase || o.$apply()
    }),
    o.signout = function() {
        firebase.auth().signOut().then(function() {
            i.path("home")
        }, function(e) {
            console.log(e)
        })
    }
}
]).controller("UsamcqCtrl", ["$scope", "$location", "$rootScope", "$window", function(a, t, e, r) {
    function s(e) {
        return new Date(e).toLocaleString("en-US", {
            hour: "numeric",
            minute: "2-digit"
        })
    }
    (window.myscopeUsa = a).showUsamcqInfo = function() {
        return !(!a.usamcqConfig || !a.usamcqConfig.showCompetitorInfo) && (-1 === t.path().indexOf("train-") && -1 === t.path().indexOf("compete-") && -1 === t.path().indexOf("usamc-"))
    }
    ,
    a.displayUsamcq = function(e) {
        a.hideUsamcqInfo = !e,
        e ? $("#usamcqInfo").transition("slide down") : $("#usamcqInfo").transition("slide down", "200ms"),
        a.$$phase || a.$apply()
    }
    ,
    a.usamcStartImages = function(e) {
        t.path("usamc-images/" + e)
    }
    ,
    a.usamcStartNames = function(e) {
        t.path("usamc-names/" + e)
    }
    ,
    a.usamcStartNumbers = function(e) {
        t.path("usamc-numbers/" + e)
    }
    ,
    function e() {
        a.user ? a.user.registrations && a.user.registrations.usamcq2023 && (firebase.database().ref("championships/usamcq2023/config").on("value", function(e) {
            a.usamcqConfig = e.val(),
            a.usamcqConfig.Images && a.usamcqConfig.Images.startTime && (a.startTimeImages = s(a.usamcqConfig.Images.startTime)),
            a.usamcqConfig.Images && a.usamcqConfig.Images.endTime && (a.endTimeImages = s(a.usamcqConfig.Images.endTime)),
            a.usamcqConfig.Names && a.usamcqConfig.Names.startTime && (a.startTimeNames = s(a.usamcqConfig.Names.startTime)),
            a.usamcqConfig.Names && a.usamcqConfig.Names.endTime && (a.endTimeNames = s(a.usamcqConfig.Names.endTime)),
            a.usamcqConfig.Numbers && a.usamcqConfig.Numbers.startTime && (a.startTimeNumbers = s(a.usamcqConfig.Numbers.startTime)),
            a.usamcqConfig.Numbers && a.usamcqConfig.Numbers.endTime && (a.endTimeNumbers = s(a.usamcqConfig.Numbers.endTime)),
            a.$$phase || a.$apply()
        }),
        firebase.database().ref("championships/usamcq2023/competitors/" + firebase.auth().currentUser.uid + "/trialsRemaining").on("value", function(e) {
            a.usamcqTrialsRemaining = e.val(),
            a.$$phase || a.$apply()
        })) : setTimeout(e, 1e3)
    }()
}
]),
angular.module("myApp.leaderboard", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/leaderboard", {
        templateUrl: "leaderboard/leaderboard.html",
        controller: "LeaderboardCtrl"
    })
}
]).controller("LeaderboardCtrl", ["$location", "$scope", function(a, o) {
    var r, s, i, t;
    function n(e) {
        var a;
        for (o.pagination[e] = [],
        a = 1; a <= s[e]; a += 1)
            3 === a && 5 < o.currentPage[e] && (o.pagination[e].push("..."),
            a = o.currentPage[e] - 1),
            a === o.currentPage[e] + 2 && s[e] > o.currentPage[e] + 4 && (o.pagination[e].push("..."),
            a = s[e] - 1),
            o.pagination[e].push(a)
    }
    function c(s) {
        r[s] && r[s].off(),
        r[s] = firebase.database().ref("leaderboard/" + s).orderByKey().startAt((t * (o.currentPage[s] - 1)).toString()).limitToFirst(t),
        r[s].on("value", function(e) {
            var a, t, r = e.val();
            if (r) {
                for (o.leaderboard[s] = [],
                t = Object.keys(r),
                a = 0; a < t.length; a += 1)
                    o.leaderboard[s].push({
                        displayName: r[t[a]].displayName,
                        flag: r[t[a]].flag,
                        rank: r[t[a]].rank,
                        rating: r[t[a]].rating,
                        sequence: parseInt(t[a], 10)
                    });
                o.leaderboard[s].sort(function(e, a) {
                    return e.sequence < a.sequence ? -1 : 1
                })
            }
            o.initialLoading[s] = !1,
            o.$$phase || o.$apply()
        })
    }
    function m() {
        for (var e = ["overall", "Cards", "Images", "International Names", "Names", "Numbers", "Words"], a = 0; a < e.length; a++)
            !function(a) {
                firebase.database().ref("leaderboard/" + a).orderByChild("displayName").equalTo(o.user.displayName).once("value", function(e) {
                    e = e.val();
                    e && (o.currentPage[a] = Math.floor(Object.keys(e)[0] / t) + 1),
                    n(a),
                    c(a)
                })
            }(e[a])
    }
    window.myscope = o,
    t = 20,
    o.competitorData = {},
    o.countryNames = countryNames,
    o.modalId = "m" + (new Date).getTime(),
    o.currentPage = {
        overall: 1,
        Cards: 1,
        Images: 1,
        "International Names": 1,
        Names: 1,
        Numbers: 1,
        Words: 1
    },
    s = {
        overall: 0,
        Cards: 0,
        Images: 0,
        "International Names": 0,
        Names: 0,
        Numbers: 0,
        Words: 0
    },
    o.initialLoading = {
        overall: !0,
        Cards: !0,
        Images: !0,
        "International Names": !0,
        Names: !0,
        Numbers: !0,
        Words: !0
    },
    r = {},
    $(".menu .item").tab(),
    o.leaderboard = {},
    o.pagination = {},
    o.pageClick = function(e, a) {
        "..." !== a && (o.currentPage[e] = a,
        n(e),
        c(e))
    }
    ,
    (i = firebase.database().ref("leaderboardPageCounts")).on("value", function(e) {
        var a, t;
        if (e) {
            for (s = e.val(),
            a = ["overall", "Cards", "Images", "International Names", "Names", "Numbers", "Words"],
            t = 0; t < a.length; t++)
                n(a[t]);
            o.$$phase || o.$apply()
        }
    }),
    function e() {
        var a, t, r;
        if (void 0 === o.user)
            setTimeout(e, 1e3);
        else if (o.user)
            m();
        else
            for (t = ["overall", "Cards", "Images", "International Names", "Names", "Numbers", "Words"],
            r = 0; r < t.length; r++)
                n(a = t[r]),
                c(a)
    }(),
    o.showExplanation = function() {
        $(".ui.modal.explanation").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    o.competitorClick = function(e, a) {
        var t, r, s;
        $(".ui.modal.competitorModal").modal("show"),
        o.competitorData = {
            flag: a,
            name: e
        },
        o.competitorLoading = !0,
        o.$$phase || o.$apply(),
        t = firebase.database().ref("pending").push({
            requestType: "getUser",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid,
            username: e.toLowerCase()
        }),
        firebase.database().ref("pending/" + t.key).on("value", function(e) {
            e = e.val();
            if (e && e.done) {
                if (firebase.database().ref("pending/" + t.key).off(),
                t.remove(),
                o.competitorData.id = e.returnUserId,
                !o.competitorData.id)
                    return o.competitorLoading = !1,
                    $(".ui.modal.competitor").modal("hide"),
                    void (o.$$phase || o.$apply());
                s = r = !1,
                firebase.database().ref("users/" + o.competitorData.id + "/ratings").once("value", function(e) {
                    o.competitorData.ratings = e.val(),
                    r = !0,
                    s && (o.competitorLoading = !1,
                    o.$$phase || o.$apply())
                }),
                firebase.database().ref("users/" + o.competitorData.id + "/recentBest").once("value", function(e) {
                    o.competitorData.recentBest = e.val(),
                    s = !0,
                    r && (o.competitorLoading = !1,
                    o.$$phase || o.$apply())
                })
            }
        })
    }
    ,
    o.challenge = function(e) {
        $(".ui.modal.competitor").modal("hide"),
        a.path("/compete/" + e + "/" + encodeURIComponent(o.competitorData.name)),
        o.$$phase || o.$apply()
    }
    ,
    o.$on("$destroy", function() {
        var e, a, t;
        for ($(".ui.modal.competitorModal." + o.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + o.modalId).remove(),
        $(".ui.modal.explanation").remove(),
        a = ["overall", "Cards", "Images", "International Names", "Names", "Numbers", "Words"],
        t = 0; t < a.length; t++)
            e = a[t],
            r && r[e] && r[e].off();
        i && i.off()
    })
}
]),
angular.module("myApp.league", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/league", {
        templateUrl: "league/league.html",
        controller: "LeagueCtrl"
    }),
    e.when("/league/:season/:division/:tab", {
        templateUrl: "league/league.html",
        controller: "LeagueCtrl"
    })
}
]).directive("contenteditable", function() {
    return {
        restrict: "A",
        require: "ngModel",
        link: function(a, e, t, r) {
            function s() {
                r.$setViewValue(e.html())
            }
            r.$render = function() {
                e.html(r.$viewValue || "")
            }
            ,
            e.bind("keydown", function(e) {
                13 !== e.which && 27 !== e.which || (e.target.blur(),
                e.preventDefault())
            }),
            e.bind("blur keyup change", function(e) {
                a.$apply(s)
            })
        }
    }
}).controller("LeagueCtrl", ["$compile", "$location", "$rootScope", "$routeParams", "$scope", "$window", function(e, r, a, t, i, s) {
    var o, n;
    (window.myscope = i).countryNames = countryNames,
    i.season = t.season,
    i.division = t.division,
    i.tab = t.tab,
    i.modalId = "m" + (new Date).getTime(),
    i.season && (i.seasonNum = i.season.replace("season", "")),
    i.division && (i.divisionNum = i.division.replace("division", "")),
    i.availability = {},
    firebase.database().ref("league/seasonCount").on("value", function(e) {
        if (n = e.val(),
        i.currentSeason = parseInt(i.seasonNum, 10) === n,
        !i.season)
            return r.path("league/season" + n + "/division1a/standings").replace(),
            void (i.$$phase || i.$apply());
        for (i.seasonNums = [],
        m = 0; m < n; m++)
            i.seasonNums.push(m + 1);
        setTimeout(function() {
            $("#season").dropdown("set selected", i.seasonNum),
            $("#season").dropdown({
                onChange: function(e, a, t) {
                    r.path("league/season" + e + "/division1" + (5 <= parseInt(e, 10) ? "a" : "") + "/standings").replace(),
                    i.$$phase || i.$apply()
                }
            }),
            i.$$phase || i.$apply()
        }, 1)
    }),
    i.season && (firebase.database().ref("league/" + i.season + "/config").on("value", function(e) {
        e.exists() && (i.divisions = e.val().divisions,
        i.currentRound = Math.floor((Date.now() - e.val().startTimestamp) / 6048e5) + 1,
        i.$$phase || i.$apply())
    }),
    firebase.database().ref("league/" + i.season + "/" + i.division + "/config").on("value", function(e) {
        e.exists() && (i.discussionUrl = e.val().discussionUrl,
        i.standingColors = e.val().standingColors,
        i.tabs = e.val().tabs,
        i.$$phase || i.$apply())
    }),
    firebase.database().ref("league/" + i.season + "/" + i.division + "/" + i.tab).on("value", function(e) {
        var a, t;
        for (o = e.val() || [],
        i.dataChanged = !1,
        i.leagueData = e.val() || [],
        t = 0; t < i.leagueData.length; t++)
            i.leagueData[t].rowId = t,
            i.leagueData[t].name && (i.leagueData[t].name = i.leagueData[t].name.trim()),
            i.leagueData[t].name1 && (i.leagueData[t].name1 = i.leagueData[t].name1.trim()),
            i.leagueData[t].name2 && (i.leagueData[t].name2 = i.leagueData[t].name2.trim());
        for (i.leaguePlayers = [],
        t = 0; t < i.leagueData.length; t++)
            i.leagueData[t].name && -1 === i.leaguePlayers.indexOf(i.leagueData[t].name) && i.leaguePlayers.push(i.leagueData[t].name),
            i.leagueData[t].name1 && -1 === i.leaguePlayers.indexOf(i.leagueData[t].name1) && i.leaguePlayers.push(i.leagueData[t].name1),
            i.leagueData[t].name2 && -1 === i.leaguePlayers.indexOf(i.leagueData[t].name2) && i.leaguePlayers.push(i.leagueData[t].name2);
        for (i.leaguePlayers.sort(function(e, a) {
            return e.toLowerCase() < a.toLowerCase() ? -1 : 1
        }),
        t = 0; t < i.leagueData.length; t++)
            i.leagueData[t].timestamp && (a = new Date(i.leagueData[t].timestamp),
            i.leagueData[t].schedule = l(a));
        if ("standings" === i.tab)
            for (i.leagueData.sort(function(e, a) {
                return parseFloat(e.points) > parseFloat(a.points) || !(parseFloat(e.points) < parseFloat(a.points)) && (parseFloat(e.diff) > parseFloat(a.diff) || !(parseFloat(e.diff) < parseFloat(a.diff)) && e.rowId < a.rowId) ? -1 : 1
            }),
            t = 0; t < i.leagueData.length; t++)
                0 < t && i.leagueData[t].points === i.leagueData[t - 1].points && i.leagueData[t].diff === i.leagueData[t - 1].diff ? i.leagueData[t].rank = i.leagueData[t - 1].rank : i.leagueData[t].rank = t + 1;
        i.ready = !0,
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("league/" + i.season + "/" + i.division + "/availability").once("value", function(e) {
        var a, t, r, s;
        if (e.exists())
            for (a = e.val(),
            r = Object.keys(a),
            s = 0; s < r.length; s++)
                t = a[r[s]],
                i.availability[t.competitorName] || (i.availability[t.competitorName] = {}),
                i.availability[t.competitorName]["t" + t.timestamp] = r[s];
        i.$$phase || i.$apply()
    })),
    i.hours = [];
    for (var c = 60 * Math.floor((new Date).getTime() / 1e3 / 60 / 60) * 60 * 1e3, m = 0; m < 216; m++)
        i.hours.push({
            dateWeekday: new Date(c).toLocaleString([], {
                weekday: "long"
            }),
            dateDate: new Date(c).toLocaleString([], {
                month: "short",
                day: "numeric"
            }),
            dateTime: new Date(c).toLocaleString([], {
                hour: "numeric",
                minute: "numeric"
            }),
            timestamp: c
        }),
        c += 36e5;
    function l(e) {
        return e.getFullYear() + "-" + (e.getMonth() + 1 < 10 ? "0" : "") + (e.getMonth() + 1) + "-" + (e.getDate() < 10 ? "0" : "") + e.getDate() + " " + (e.getHours() < 10 ? "0" : "") + e.getHours() + ":" + (e.getMinutes() < 10 ? "0" : "") + e.getMinutes()
    }
    i.notesFocus = function(e, a) {
        var t, r = i.leagueData[a];
        r.name1 !== i.user.displayName && r.name2 !== i.user.displayName || (a = '<span style="font-weight: bold">' + i.user.displayName + "</span>:&nbsp;",
        r.notes.endsWith(a) || (r.notes && (r.notes += "<br>"),
        r.notes += a)),
        t = e.target,
        setTimeout(function() {
            var e, a;
            e = t,
            (a = document.createRange()).selectNodeContents(e),
            a.collapse(!1),
            (e = window.getSelection()).removeAllRanges(),
            e.addRange(a)
        }, 0),
        i.editingNotes = !0
    }
    ,
    i.notesBlur = function(e) {
        var a = i.leagueData[e]
          , e = '<span style="font-weight: bold">' + i.user.displayName + "</span>:&nbsp;";
        a.notes.endsWith(e) && (a.notes = a.notes.substr(0, a.notes.length - e.length)),
        a.notes.endsWith("<br>") && (a.notes = a.notes.substr(0, a.notes.length - 4)),
        i.dataChanged && firebase.database().ref("league/" + i.season + "/" + i.division + "/" + i.tab + "/" + a.rowId + "/notes").set(a.notes),
        i.editingNotes = !1
    }
    ,
    i.scheduleBlur = function(e) {
        var a = i.leagueData[e];
        void 0 !== a.schedule && (a.schedule = a.schedule.replace(/<\/?[^>]+(>|$)/g, ""),
        e = a.schedule.length === "yyyy-mm-dd hh:mm".length && "-" === a.schedule.charAt(4) && "-" === a.schedule.charAt(7) && " " === a.schedule.charAt(10) && ":" === a.schedule.charAt(13) ? new Date(a.schedule) : new Date(""),
        isNaN(e.getTime()) ? "" === a.schedule ? (firebase.database().ref("league/" + i.season + "/" + i.division + "/" + i.tab + "/" + a.rowId).update({
            confirmed1: null,
            confirmed2: null,
            timestamp: null
        }),
        firebase.database().ref("pending").push({
            requestType: "updateScheduledMatches",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })) : a.timestamp ? (e = new Date(a.timestamp),
        a.schedule = l(e)) : a.schedule = "" : (e = {
            confirmed1: null,
            confirmed2: null,
            timestamp: Date.UTC(e.getUTCFullYear(), e.getUTCMonth(), e.getUTCDate(), e.getUTCHours(), e.getUTCMinutes(), 0)
        },
        a.competitorId1 === firebase.auth().currentUser.uid && (e.confirmed1 = !0),
        a.competitorId2 === firebase.auth().currentUser.uid && (e.confirmed2 = !0),
        firebase.database().ref("league/" + i.season + "/" + i.division + "/" + i.tab + "/" + a.rowId).update(e),
        firebase.database().ref("pending").push({
            requestType: "updateScheduledMatches",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        a.competitorId1 === firebase.auth().currentUser.uid && firebase.database().ref("pending").push({
            division: i.division,
            emailId: "match scheduled",
            fromName: i.user.displayName,
            requestType: "notifyLeaguePlayer",
            season: i.season,
            tab: i.tab,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            toCompetitorId: a.competitorId2,
            userId: firebase.auth().currentUser.uid
        }),
        a.competitorId2 === firebase.auth().currentUser.uid && firebase.database().ref("pending").push({
            division: i.division,
            emailId: "match scheduled",
            fromName: i.user.displayName,
            requestType: "notifyLeaguePlayer",
            season: i.season,
            tab: i.tab,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            toCompetitorId: a.competitorId1,
            userId: firebase.auth().currentUser.uid
        })))
    }
    ,
    i.fieldChanged = function(e, a, t) {
        o[e][a] = t.replace(/<\/?[^>]+(>|$)/g, ""),
        i.dataChanged = !0
    }
    ,
    i.resultBlur = function(e) {
        var a, t;
        if ("" === this.leagueData[e].result1 && "" === this.leagueData[e].result2)
            t = a = 0;
        else if ("quarters" === i.tab || "semis" === i.tab || "final" === i.tab)
            a = this.leagueData[e].result1,
            t = this.leagueData[e].result2;
        else if (a = parseFloat(this.leagueData[e].result1),
        t = parseFloat(this.leagueData[e].result2),
        a < 0 || 99 < a || t < 0 || 99 < t)
            return;
        firebase.database().ref("pending").push({
            division: i.division,
            requestType: "leagueResult",
            result1: a,
            result2: t,
            rowId: e,
            season: i.season,
            tab: i.tab,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    ,
    i.confirmClick = function(e) {
        var a, t = {};
        e.competitorId1 === firebase.auth().currentUser.uid && (t.confirmed1 = !0,
        a = e.competitorId2),
        e.competitorId2 === firebase.auth().currentUser.uid && (t.confirmed2 = !0,
        a = e.competitorId1),
        (t.confirmed1 || t.confirmed2) && (firebase.database().ref("league/" + i.season + "/" + i.division + "/" + i.tab + "/" + e.rowId).update(t),
        firebase.database().ref("pending").push({
            requestType: "updateScheduledMatches",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })),
        a && (t.confirmed1 || e.confirmed1) && (t.confirmed2 || e.confirmed2) && firebase.database().ref("pending").push({
            division: i.division,
            emailId: "match confirmed",
            fromName: i.user.displayName,
            requestType: "notifyLeaguePlayer",
            season: i.season,
            tab: i.tab,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            toCompetitorId: a,
            userId: firebase.auth().currentUser.uid
        })
    }
    ,
    i.divisionsClick = function() {
        var e, a = window.prompt('Enter division numbers, separated by spaces - e.g. "1 2 3 4a 4b 5a 5b"', i.divisions.join(" "));
        if (a)
            if ("1" === (a = a.split(" "))[0].substr(0, 1))
                for (i.divisions = a,
                firebase.database().ref("league/" + i.season + "/config/divisions").set(i.divisions),
                e = 0; e < i.divisions.length; e++)
                    !function(o) {
                        firebase.database().ref("league/" + i.season + "/division" + o + "/config").once("value", function(e) {
                            var a, t, r, s = e.val();
                            if (s) {
                                for (e = parseInt(o, 10) !== parseInt(i.divisions[i.divisions.length - 1], 10),
                                t = -1,
                                a = 0; a < s.tabs.length; a++)
                                    if ("playoffs" === s.tabs[a].value) {
                                        t = a;
                                        break
                                    }
                                e && -1 === t && (s.tabs.push({
                                    label: "Playoffs",
                                    value: "playoffs"
                                }),
                                r = !0),
                                e || -1 === t || "1" === o || (s.tabs.splice(t, 1),
                                r = !0)
                            } else
                                (s = {
                                    tabs: []
                                }).tabs.push({
                                    label: "Standings",
                                    value: "standings"
                                }),
                                s.tabs.push({
                                    label: "W1",
                                    value: "week1"
                                }),
                                parseInt(o, 10) !== parseInt(i.divisions[i.divisions.length - 1], 10) && s.tabs.push({
                                    label: "Playoffs",
                                    value: "playoffs"
                                }),
                                "1" === o.substr(0, 1) && "1c" === i.divisions[2] && s.tabs.push({
                                    label: "Quarters",
                                    value: "quarters"
                                }),
                                "1" === o.substr(0, 1) && (s.tabs.push({
                                    label: "Semis",
                                    value: "semis"
                                }),
                                s.tabs.push({
                                    label: "Final",
                                    value: "final"
                                })),
                                r = !0;
                            r && firebase.database().ref("league/" + i.season + "/division" + o + "/config").set(s)
                        })
                    }(i.divisions[e]);
            else
                alert("Unexpected input - does not start with 1")
    }
    ,
    i.weeksClick = function() {
        for (var e, a, t, r, s = 0, o = 0; o < i.tabs.length; o++)
            "week" === i.tabs[o].value.substr(0, 4) && s++;
        if (a = window.prompt("Enter number of weeks in the regular season for " + i.division, s))
            if (1 <= (s = parseInt(a, 10)) && s <= 16) {
                for (t = [],
                o = 0; o < i.tabs.length; o++)
                    "week" !== i.tabs[o].value.substr(0, 4) && t.push({
                        label: i.tabs[o].label,
                        value: i.tabs[o].value
                    });
                for ((s < 11 || s < 13 && "1" !== i.divisionNum) && (e = !0),
                o = 0; o < s; o++)
                    r = {
                        label: (e ? "W" : "") + (o + 1).toString(),
                        value: "week" + (o + 1).toString()
                    },
                    t.splice(o + 1, 0, r);
                firebase.database().ref("league/" + i.season + "/" + i.division + "/config/tabs").set(t)
            } else
                alert("Unexpected input - should be a number between 1 and 16")
    }
    ,
    i.addRowsClick = function() {
        var e, a, t, r, s = window.prompt("Enter the number of rows to add", "");
        if (s)
            if (1 <= (e = parseInt(s, 10)) && e <= 15)
                for (t = "standings" === i.tab ? {
                    against: "0.0",
                    diff: "0",
                    drawn: "0",
                    for: "0.0",
                    lost: "0",
                    name: "",
                    played: "0",
                    points: "0",
                    won: "0"
                } : {
                    name1: "",
                    name2: "",
                    notes: "",
                    result1: "",
                    result2: ""
                },
                r = i.leagueData ? i.leagueData.length : 0,
                a = 0; a < e; a++)
                    firebase.database().ref("league/" + i.season + "/" + i.division + "/" + i.tab + "/" + (r + a)).set(t);
            else
                alert("Unexpected input - should be a number between 1 and 15")
    }
    ,
    i.colorsClick = function() {
        var e, a, t, r = "";
        if (i.standingColors && (r = i.standingColors.join(" ")),
        r = window.prompt('Enter the row colours, separated by spaces\ne.g. "green green amber none none amber red red"', r)) {
            for (a = r.toLowerCase().split(" "),
            e = 0; e < a.length; e++)
                if (-1 === ["amber", "green", "none", "red"].indexOf(a[e])) {
                    t = !0;
                    break
                }
            t ? alert("Unexpected input - should be a sequence of colours separated by a single space") : firebase.database().ref("league/" + i.season + "/" + i.division + "/config/standingColors").set(a)
        }
    }
    ,
    i.availabilityClick = function(e, a) {
        var t;
        e === i.user.displayName && (i.availability[e] || (i.availability[e] = {}),
        i.availability[e]["t" + a.timestamp] ? (firebase.database().ref("league/" + i.season + "/" + i.division + "/availability/" + i.availability[e]["t" + a.timestamp]).remove(),
        delete i.availability[e]["t" + a.timestamp]) : ((t = firebase.database().ref("league/" + i.season + "/" + i.division + "/availability").push()).set({
            competitorName: e,
            timestamp: a.timestamp
        }),
        i.availability[e]["t" + a.timestamp] = t.key),
        i.$$phase || i.$apply())
    }
    ,
    i.save = function() {
        for (var e = 0; e < o.length; e++)
            ("standings" === i.tab && "delete" === o[e].name.toLowerCase() || "standings" !== i.tab && "delete" === o[e].name1.toLowerCase()) && (o.splice(e, 1),
            e--);
        firebase.database().ref("league/" + i.season + "/" + i.division + "/" + i.tab).set(o),
        i.dataChanged = !1
    }
    ,
    i.sendToOpponent = function() {
        var a = firebase.database().ref("pending").push({
            division: i.division,
            requestType: "notifyOpponent",
            season: i.season,
            tab: i.tab,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        });
        i.status = "sending",
        firebase.database().ref("pending/" + a.key).on("value", function(e) {
            e = e.val();
            e && e.done && (firebase.database().ref("pending/" + a.key).off(),
            a.remove(),
            e.success ? i.status = "sent" : i.status = "error",
            i.$$phase || i.$apply())
        })
    }
    ,
    i.closeMessage = function() {
        i.status = "",
        i.$$phase || i.$apply()
    }
    ,
    i.showRules = function() {
        $(".ui.modal.rules").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    i.isLeagueCompetitor = function() {
        if (!i.leagueData || !i.user || !i.currentSeason)
            return !1;
        for (m = 0; m < i.leagueData.length; m++)
            if (i.user.displayName === i.leagueData[m].name || i.user.displayName === i.leagueData[m].name1 || i.user.displayName === i.leagueData[m].name2)
                return !0;
        return !1
    }
    ,
    i.showContactAdmin = function() {
        i.message = "",
        $(".ui.modal.contactAdmin").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    i.sendClick = function() {
        i.sending = !0,
        firebase.database().ref("contactUs").push({
            subject: "League Season",
            message: i.message,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }, function(e) {
            i.messageClass = e ? "error" : "success",
            i.sending = !1,
            i.$$phase || i.$apply()
        })
    }
    ,
    i.competitorClick = function(e, a, t) {
        var r, s;
        $(".ui.modal.competitorModal").modal("show"),
        i.competitorData = {
            flag: t,
            id: e,
            name: a
        },
        i.competitorLoading = !0,
        i.$$phase || i.$apply(),
        s = r = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            i.competitorData.ratings = e.val(),
            r = !0,
            s && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            i.competitorData.recentBest = e.val(),
            s = !0,
            r && (i.competitorLoading = !1,
            i.$$phase || i.$apply())
        })
    }
    ,
    i.$on("$locationChangeStart", function(e) {
        i.user && i.user.leagueAdmin && i.dataChanged && !confirm("You have unsaved changes. Are you sure you want to leave the page?") && e.preventDefault()
    }),
    i.$on("$destroy", function() {
        $(".ui.modal.competitorModal." + i.modalId).modal("hide"),
        $(".ui.modal.contactAdmin").modal("hide"),
        $(".ui.modal.rules").modal("hide"),
        $(".ui.modal.competitorModal." + i.modalId).remove(),
        $(".ui.modal.contactAdmin").remove(),
        $(".ui.modal.rules").remove()
    })
}
]),
angular.module("myApp.league-register", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/league/register", {
        templateUrl: "league-register/league-register.html",
        controller: "LeagueRegisterCtrl"
    })
}
]).controller("LeagueRegisterCtrl", ["$location", "$rootScope", "$scope", "$window", function(e, a, t, r) {
    (window.myscope = t).myObj = {},
    t.showRules = function() {
        $(".ui.modal.rules").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    t.register = function() {
        var a;
        t.registerClicked = !0,
        t.$$phase || t.$apply(),
        a = firebase.database().ref("pending").push({
            aomUsername: t.myObj.aomUsername,
            displayName: t.user.displayName,
            email: t.user.email,
            requestType: "leagueRegister",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        firebase.database().ref("pending/" + a.key).on("value", function(e) {
            e = e.val();
            e && e.done && (firebase.database().ref("pending/" + a.key).off(),
            a.remove(),
            t.registered = !0,
            t.$$phase || t.$apply())
        })
    }
}
]),
angular.module("myApp.performance", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/performance", {
        templateUrl: "performance/performance.html",
        controller: "PerformanceCtrl"
    })
}
]).controller("PerformanceCtrl", ["$rootScope", "$scope", "$window", function(e, s, a) {
    (window.myscope = s).show = {},
    function e() {
        s.user ? function() {
            for (var e, a, t = ["Cards", "Images", "International Names", "Names", "Numbers", "Words"], r = 0; r < t.length; r++)
                e = t[r],
                a = s.user.ratings[e],
                s.show[e] = a.rating === a.base + a.scores + a.wins;
            s.ready = !0,
            s.$$phase || s.$apply()
        }() : setTimeout(e, 500)
    }(),
    $(".menu .item").tab()
}
]),
angular.module("myApp.qualify", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/qualify", {
        templateUrl: "qualify/qualify.html",
        controller: "QualifyCtrl"
    })
}
]).controller("QualifyCtrl", [function() {}
]),
angular.module("myApp.signin", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/signin", {
        templateUrl: "signin/signin.html",
        controller: "SigninCtrl"
    })
}
]).controller("SigninCtrl", ["$location", "$rootScope", "$scope", "$window", function(e, a, r, t) {
    var s;
    (window.myscope = r).sendClick = function() {
        if (r.emailError = !1,
        r.invalidEmail = !1,
        r.notEligible = !1,
        !r.email)
            return r.messageClass = "error",
            void (r.invalidEmail = !0);
        r.status = "Sending",
        r.messageClass = "",
        r.$$phase || r.$apply(),
        s && s.off(),
        (s = firebase.database().ref("signin").push({
            userId: firebase.auth().currentUser.uid,
            email: r.email,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })).on("child_added", function(e, a) {
            var t;
            switch (e.key) {
            case "customToken":
                t = e.val(),
                firebase.auth().signInWithCustomToken(t).catch(function(e) {
                    e.code;
                    e = e.message;
                    console.log(e)
                });
                break;
            case "emailError":
                r.messageClass = "error",
                r.emailError = !0,
                r.status = "";
                break;
            case "emailSent":
                r.messageClass = "success",
                r.status = "Sent";
                break;
            case "notEligible":
                r.messageClass = "error",
                r.notEligible = !0,
                r.status = ""
            }
            r.$$phase || r.$apply()
        })
    }
}
]),
angular.module("myApp.train", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/train", {
        templateUrl: "train/train.html",
        controller: "TrainCtrl"
    })
}
]).controller("TrainCtrl", ["$scope", "$location", function(e, a) {
    e.cardsClick = function() {
        a.path("/train-cards")
    }
    ,
    e.imagesClick = function() {
        a.path("/train-images")
    }
    ,
    e.internationalClick = function() {
        a.path("/train-international")
    }
    ,
    e.namesClick = function() {
        a.path("/train-names")
    }
    ,
    e.numbersClick = function() {
        a.path("/train-numbers")
    }
    ,
    e.wordsClick = function() {
        a.path("/train-words")
    }
}
]),
angular.module("myApp.train-cards", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/train-cards", {
        templateUrl: "train-cards/train-cards.html",
        controller: "TrainCardsCtrl"
    })
}
]).controller("TrainCardsCtrl", ["$scope", "$location", "$rootScope", "$route", "$timeout", "$window", function(s, a, o, e, i, n) {
    window.myscope = s;
    var c, m, r, l, t, p, u, h, d, f, g, b, v = 10, w = [];
    function y(e) {
        var a;
        switch (e) {
        case "Arabic":
            for (a = 0; a < 52; a += 1)
                w[a] = new Image,
                w[a].src = "images/cards/arabic/a_card" + a + ".png";
            break;
        case "English":
            for (a = 0; a < 52; a += 1)
                w[a] = new Image,
                w[a].src = 38 === a ? "images/cards/english/card" + a + ".svg?v=1" : "images/cards/english/card" + a + ".svg";
            break;
        case "FourColor":
            for (a = 0; a < 52; a += 1)
                w[a] = new Image,
                w[a].src = "images/cards/four-color/card" + a + ".svg";
            break;
        case "German":
            for (a = 0; a < 52; a += 1)
                w[a] = new Image,
                w[a].src = "images/cards/german/g_card" + a + ".png"
        }
    }
    function C() {
        for (var e = s.prefs.cardsGroups.split(" "), a = 0; a < e.length; a += 1)
            if ("1" !== e[a] && "2" !== e[a] && "3" !== e[a] && "4" !== e[a] && "5" !== e[a] && "6" !== e[a] && "7" !== e[a] && "8" !== e[a])
                return alert("Invalid Groups value - groups must be between 1 and 8"),
                !1;
        firebase.database().ref("pending").push({
            cardsDirection: s.prefs.cardsDirection,
            cardsGroups: s.prefs.cardsGroups,
            cardsHideTimer: s.prefs.cardsHideTimer,
            cardsSpacing: s.prefs.cardsSpacing,
            cardsStyle: s.prefs.cardsStyle,
            cardsSuits: s.prefs.cardsSuits,
            cardsValues: s.prefs.cardsValues,
            eventName: "Cards",
            prepTime: s.prefs.prepTime,
            requestType: "prefs",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        s.prefs.cardsStyle !== o.user.prefs.cardsStyle && y(s.prefs.cardsStyle)
    }
    function T(e) {
        s.trial.memoCursor = e
    }
    function M() {
        c ? s.stopMemo(Date.now()) : Date.now() - t < 500 ? s.stopMemo(t) : t = Date.now()
    }
    function I() {
        s.phase && "Completed" !== s.phase && firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + b).push({
            focus: !1,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function S() {
        s.phase && "Completed" !== s.phase && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + b).push({
            focus: !0,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function R(e) {
        "Memo" === s.phase && function(e) {
            switch (e.which) {
            case 13:
                s.stopMemo(),
                e.preventDefault();
                break;
            case 32:
            case 38:
            case 87:
                s.memoReturn(),
                s.$$phase || s.$apply(),
                e.preventDefault();
                break;
            case 37:
            case 65:
                s.memoPrev(),
                s.$$phase || s.$apply(),
                e.preventDefault();
                break;
            case 39:
            case 68:
                s.memoNext(),
                s.$$phase || s.$apply(),
                e.preventDefault()
            }
            s.stopAutoAdvance()
        }(e)
    }
    function k(e) {
        "Recall" === s.phase && function(e) {
            switch (e.which) {
            case 43:
            case 61:
                D(s.trial.recallCursor),
                s.$$phase || s.$apply(),
                e.preventDefault();
                break;
            case 45:
                P(s.trial.recallCursor),
                s.$$phase || s.$apply(),
                e.preventDefault()
            }
        }(e)
    }
    function N(e, a) {
        s.trial.recall[e] = a
    }
    function A() {
        var e, a, t, r;
        if (!o.user)
            return -1;
        for (t = [],
        a = 0; a < s.trial.items; a += 1)
            t[a] = !1;
        for (e = 0; e < 52; e += 1)
            s.trial.recall[e] < 52 && (t[s.trial.recall[e]] = !0);
        for (a = 0; a < s.trial.items; a += 1)
            if (!t[r = "LTR" === o.user.prefs.cardsDirection ? (s.trial.recallCursor + a + 1) % s.trial.items : (s.trial.recallCursor - a - 1 + s.trial.items) % s.trial.items])
                return r;
        return -1
    }
    function D(e) {
        var a;
        if ("LTR" === o.user.prefs.cardsDirection)
            for (a = 0; a < 52; a += 1)
                s.trial.recall[a] < 52 && s.trial.recall[a] >= e && (s.trial.recall[a] === s.trial.items - 1 ? N(a, o.user.prefs.cardsRecall[a]) : N(a, s.trial.recall[a] + 1));
        else
            for (a = 0; a < 52; a += 1)
                s.trial.recall[a] < 52 && s.trial.recall[a] <= e && (0 === s.trial.recall[a] ? N(a, o.user.prefs.cardsRecall[a]) : N(a, s.trial.recall[a] - 1))
    }
    function P(e) {
        var a, t = !1;
        if ("LTR" === o.user.prefs.cardsDirection)
            for (a = 0; a < 52; a += 1)
                s.trial.recall[a] < 52 && s.trial.recall[a] > e && (s.trial.recall[a] === s.trial.recallCursor + 1 && (t = !0),
                N(a, s.trial.recall[a] - 1));
        else
            for (a = 0; a < 52; a += 1)
                s.trial.recall[a] < 52 && s.trial.recall[a] < e && (s.trial.recall[a] === s.trial.recallCursor - 1 && (t = !0),
                N(a, s.trial.recall[a] + 1));
        t && s.setRecallCursor(A())
    }
    function U() {
        var e, a, t, r = (Date.now() - f) / 1e3;
        if (l ? l = !1 : p && (2 < r - p || r - p < 0) && (f += 1e3 * (r - p - 1),
        r = (Date.now() - f) / 1e3),
        (p = r) < h && (s.phase = "PreMemo",
        e = h - r),
        h <= r && r < h + s.trial.memoTime && ("Memo" !== s.phase && (s.phase = "Memo",
        m && (c = setInterval(s.memoNext, 1e3 * m))),
        e = h + u - r),
        r >= h + s.trial.memoTime && r < h + u + v && ("PreRecall" !== s.phase && (s.phase = "PreRecall"),
        e = h + u + v - r),
        h + u + v <= r && r < h + u + v + d && ("Recall" !== s.phase && (s.phase = "Recall",
        s.showFinished = !1,
        s.touch = !!n.mlTouch,
        i(function() {
            s.showFinished = !0
        }, 2e3)),
        e = h + u + v + d - r),
        h + u + v + d < r)
            return s.trial.recallTime || (s.trial.recallTime = d),
            s.phase = "Completed",
            s.showContinue = !1,
            i(function() {
                s.showContinue = !0
            }, 2e3),
            a = firebase.database().ref("pending").push({
                memoTime: s.trial.memoTime,
                recall: s.trial.recall,
                recallTime: s.trial.recallTime,
                requestType: "endTrain",
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                trialId: b,
                userId: firebase.auth().currentUser.uid
            }),
            void firebase.database().ref("pending/" + a.key + "/response").on("value", function(e) {
                (t = e.val()) && (firebase.database().ref("pending/" + a.key + "/response").off(),
                a.remove(),
                s.trial.score = t.score,
                t.targetReached && (s.message = t.message,
                $(".ui.modal.targetReached").modal("show")),
                s.$$phase || s.$apply())
            });
        s.timerMin = Math.floor(Math.round(e) / 60),
        r = Math.round(e) % 60,
        s.timerSec = (r < 10 ? "0" : "") + r,
        s.timerWarning = ("Memo" === s.phase || "Recall" === s.phase) && Math.round(e) < 10,
        g = i(U, 1e3)
    }
    t = 0,
    s.highLevel = 6,
    s.now = Date.now(),
    function e() {
        s.user ? (y(s.user.prefs.cardsStyle),
        s.user.custom || (s.user.custom = {}),
        s.user.custom.Cards || (s.user.custom.Cards = {
            items: s.user.ratings && s.user.ratings.Cards ? s.user.ratings.Cards.items.toString() : "",
            maxMemoTime: "60",
            maxRecallTime: "240"
        }),
        s.user.custom.Cards.maxRecallTime || (s.user.custom.Cards.maxRecallTime = 240),
        void 0 === s.user.custom.Cards.autoAdvanceTotal && (s.user.custom.Cards.autoAdvanceTotal = ""),
        s.$$phase || s.$apply()) : s.showSignin ? (a.path("home"),
        s.$$phase || s.$apply()) : setTimeout(e, 1e3)
    }(),
    s.showInstructions = function() {
        $(".ui.modal.instructions").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.showLevels = function() {
        $(".ui.modal.levels").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    window.trainingType = window.trainingType || {},
    $(".menu .item").tab().tab("change tab", window.trainingType.Cards || "standard").tab({
        onVisible: function(e) {
            window.trainingType.Cards = e
        }
    }),
    $(".ui.checkbox").checkbox(),
    s.hideTimerClick = function() {
        s.prefs.cardsHideTimer = !s.prefs.cardsHideTimer
    }
    ,
    s.showPreferences = function() {
        o.user && (s.prefs = {
            cardsDirection: o.user.prefs.cardsDirection,
            cardsGroups: o.user.prefs.cardsGroups,
            cardsHideTimer: o.user.prefs.cardsHideTimer || !1,
            cardsSpacing: o.user.prefs.cardsSpacing || "regular",
            cardsStyle: o.user.prefs.cardsStyle,
            cardsSuits: o.user.prefs.cardsSuits,
            cardsValues: o.user.prefs.cardsValues,
            prepTime: o.user.prefs.prepTime || "20s"
        },
        $(".ui.modal.preferences").modal("setting", {
            onApprove: C
        }).modal("show"))
    }
    ,
    s.start = function(t) {
        var e, a;
        if (h = o.user && o.user.prefs && o.user.prefs.prepTime ? parseInt(o.user.prefs.prepTime, 10) : 20,
        "custom" === t) {
            if (!(0 < (u = parseInt(s.user.custom.Cards.maxMemoTime, 10)) && u <= 1800))
                return void alert("Maximum memorization time must be a number between 1 and 1800.");
            if (s.user.custom.Cards.autoAdvanceTotal && "" !== s.user.custom.Cards.autoAdvanceTotal && (!(r = parseFloat(s.user.custom.Cards.autoAdvanceTotal.replace(",", "."))) || !(5 <= r && r <= u)))
                return void alert("Auto advance total time must be either:\n   (i) blank, or\n   (ii) between 5 seconds and the maximum memorization time.");
            if (!(0 < (d = parseInt(s.user.custom.Cards.maxRecallTime, 10)) && d <= 1800))
                return void alert("Maximum recall time must be a number between 1 and 1800.")
        }
        "standard" === t && (u = 60,
        d = 240,
        m = 0),
        s.loading = !0,
        e = {
            eventName: "Cards",
            requestType: "train",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        },
        "custom" === t && (e.custom = s.user.custom.Cards),
        a = firebase.database().ref("pending").push(e),
        firebase.database().ref("pending/" + a.key + "/trialId").on("value", function(e) {
            (b = e.val()) && (firebase.database().ref("pending/" + a.key + "/trialId").off(),
            a.remove(),
            firebase.database().ref("trials/" + b).once("value", function(e, a) {
                s.trial = e.val(),
                "custom" === t && r && (m = r / s.trial.info.groups.length),
                s.loading = !1,
                f = Date.now(),
                U()
            }))
        })
    }
    ,
    s.stopMemo = function(e) {
        e = e || Date.now(),
        s.trial.memoTime = Math.round((e - f) / 10) / 100 - h,
        s.trial.memoTime > u && (s.trial.memoTime = u),
        m && Math.abs(s.trial.memoTime - r) < .05 && (s.trial.memoTime = Math.round(100 * r) / 100),
        s.stopAutoAdvance(),
        s.phase = "PreRecall",
        e = h + u + v - (e - f) / 1e3,
        s.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        s.timerSec = (e < 10 ? "0" : "") + e,
        s.$$phase || s.$apply()
    }
    ,
    s.memoPrev = function() {
        "LTR" === o.user.prefs.cardsDirection ? 0 < s.trial.memoCursor && T(s.trial.memoCursor - 1) : s.trial.memoCursor < s.trial.info.groups.length - 1 && T(s.trial.memoCursor + 1)
    }
    ,
    s.memoNext = function() {
        "LTR" === o.user.prefs.cardsDirection ? s.trial.memoCursor === s.trial.info.groups.length - 1 ? M() : T(s.trial.memoCursor + 1) : 0 === s.trial.memoCursor ? M() : T(s.trial.memoCursor - 1),
        s.$$phase || s.$apply()
    }
    ,
    s.memoReturn = function() {
        "LTR" === o.user.prefs.cardsDirection ? T(0) : T(s.trial.info.groups.length - 1)
    }
    ,
    s.stopAutoAdvance = function() {
        c && (clearInterval(c),
        m = 0)
    }
    ,
    s.shiftLeftClick = function() {
        P(s.trial.recallCursor)
    }
    ,
    s.shiftRightClick = function() {
        D(s.trial.recallCursor)
    }
    ,
    $(document).keydown(R),
    $(document).keypress(k),
    $(window).blur(I),
    $(window).focus(S),
    s.memoClass = function(e) {
        var a;
        if ("Memo" !== s.phase || !o.user)
            return "";
        switch (o.user.prefs.cardsStyle) {
        case "Arabic":
            a = "cardsMemo_a card" + e + "_a";
            break;
        case "English":
            a = "cardsMemo_e card" + e + "_e";
            break;
        case "FourColor":
            a = "cardsMemo_f card" + e + "_f";
            break;
        case "German":
            a = "cardsMemo_g card" + e + "_g"
        }
        return s.trial.info.cards[e].groupNum === s.trial.memoCursor ? (a += " cardsMemoPos" + s.trial.info.cards[e].posInGroup,
        "compact" === o.user.prefs.cardsSpacing && (a += "Compact")) : a += " cardsMemoPos" + (52 + s.trial.memo[e] - s.trial.info.groups[s.trial.memoCursor].start - s.trial.info.groups[s.trial.memoCursor].size),
        a
    }
    ,
    s.skip = function() {
        var e, a = (Date.now() - f) / 1e3;
        switch (s.phase) {
        case "PreMemo":
            e = h - a;
            break;
        case "Memo":
            e = h + u - a;
            break;
        case "PreRecall":
            e = h + u + v - a;
            break;
        case "Recall":
            e = h + u + v + d - a,
            s.trial.recallTime = a - h - u - v,
            s.phase = "Completed"
        }
        f -= 1e3 * e,
        p += e,
        i.cancel(g),
        U(),
        $(".skip").blur()
    }
    ,
    s.setRecallCursor = function(e) {
        s.trial.recallCursor = e
    }
    ,
    s.boxNum = function(e) {
        return "Recall" === s.phase && o.user ? "LTR" === o.user.prefs.cardsDirection ? e + 1 : s.trial.items - e : ""
    }
    ,
    s.recallClass = function(e) {
        var a;
        if ("Recall" !== s.phase || !o.user)
            return "";
        switch (o.user.prefs.cardsStyle) {
        case "Arabic":
            a = "cardsRecall_a card" + e + "_a";
            break;
        case "English":
            a = "cardsRecall_e card" + e + "_e";
            break;
        case "FourColor":
            a = "cardsRecall_f card" + e + "_f";
            break;
        case "German":
            a = "cardsRecall_g card" + e + "_g"
        }
        return a += " cardsRecallPos" + s.trial.recall[e]
    }
    ,
    s.boxWidth = function() {
        var e;
        if ("Recall" !== s.phase && "Completed" !== s.phase || !o.user)
            return "";
        switch (o.user.prefs.cardsStyle) {
        case "Arabic":
            e = "cardsBoxWidth_a";
            break;
        case "English":
            e = "cardsBoxWidth_e";
            break;
        case "FourColor":
            e = "cardsBoxWidth_f";
            break;
        case "German":
            e = "cardsBoxWidth_g"
        }
        return e
    }
    ,
    s.cardClick = function(e) {
        var a;
        51 < s.trial.recall[e] ? -1 !== s.trial.recallCursor && (N(e, s.trial.recallCursor),
        s.setRecallCursor(A())) : (a = s.trial.recall[e],
        N(e, s.trial.origRecall[e]),
        s.setRecallCursor(a))
    }
    ,
    s.numClick = function(e) {
        D(e),
        s.setRecallCursor(e)
    }
    ,
    s.resultsClass = function(e) {
        var a, t;
        if ("Completed" !== s.phase || !o.user)
            return "";
        switch (o.user.prefs.cardsStyle) {
        case "Arabic":
            a = "cardsResults_a card" + e + "_a";
            break;
        case "English":
            a = "cardsResults_e card" + e + "_e";
            break;
        case "FourColor":
            a = "cardsResults_f card" + e + "_f";
            break;
        case "German":
            a = "cardsResults_g card" + e + "_g"
        }
        return a += " " + (t = e,
        51 < s.trial.recall[t] ? "" : s.trial.memo[t] === s.trial.recall[t] ? "cardsCorrect" : "cardsIncorrect"),
        a += " cardsRecallPos" + s.trial.recall[e]
    }
    ,
    s.originalCard = function(e) {
        var a, t, r;
        if ("Completed" !== s.phase || !o.user)
            return "";
        for (a = 0; a < 52 && s.trial.memo[a] !== e; a += 1)
            ;
        return t = 12 < a ? "♦" : "♣",
        25 < a && (t = "♥"),
        38 < a && (t = "♠"),
        1 === (r = a % 13 + 1) && (r = "A"),
        11 === r && (r = "German" === o.user.prefs.cardsStyle ? "B" : "J"),
        12 === r && (r = "German" === o.user.prefs.cardsStyle ? "D" : "Q"),
        13 === r && (r = "K"),
        r + t
    }
    ,
    s.originalCardColor = function(e) {
        var a;
        if ("Completed" !== s.phase)
            return "";
        for (a = 0; a < 52; a += 1)
            if (s.trial.memo[a] === e)
                return "FourColor" === o.user.prefs.cardsStyle ? a < 13 ? "cardsGreen" : a < 26 ? "cardsBlue" : a < 39 ? "cardsRed" : "cardsBlack" : 12 < a && a < 39 ? "cardsRed" : "cardsBlack"
    }
    ,
    s.continueClick = function() {
        e.reload()
    }
    ,
    s.$on("$locationChangeStart", function(e) {
        s.phase && "Completed" !== s.phase && (l = !0,
        confirm("Are you sure you want to exit the trial?") || e.preventDefault())
    }),
    s.$on("$destroy", function() {
        $(".ui.modal.instructions").remove(),
        $(".ui.modal.levels").remove(),
        $(".ui.modal.preferences").remove(),
        $(".ui.modal.targetReached").remove(),
        i.cancel(g),
        $(document).off("keydown", R),
        $(document).off("keypress", k),
        $(window).off("blur", I),
        $(window).off("focus", S)
    })
}
]),
angular.module("myApp.train-images", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/train-images", {
        templateUrl: "train-images/train-images.html",
        controller: "TrainImagesCtrl"
    }),
    e.when("/usamc-images/:attempt", {
        templateUrl: "train-images/train-images.html",
        controller: "TrainImagesCtrl"
    })
}
]).controller("TrainImagesCtrl", ["$scope", "$location", "$rootScope", "$route", "$routeParams", "$timeout", function(s, a, r, e, t, o) {
    window.myscope = s;
    var i, n, c, m, l, p, u, h, d, f, g, b, v = 30, w = 10;
    function y() {
        for (var e = s.prefs.imagesGroups.split(" "), a = 0; a < e.length; a += 1)
            if ("1" !== e[a] && "2" !== e[a] && "3" !== e[a] && "4" !== e[a] && "5" !== e[a])
                return alert("Invalid Groups value - groups must be between 1 and 5"),
                !1;
        firebase.database().ref("pending").push({
            eventName: "Images",
            imagesGroups: s.prefs.imagesGroups,
            imagesHideTimer: s.prefs.imagesHideTimer,
            prepTime: s.prefs.prepTime,
            requestType: "prefs",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    function C() {
        var e, a;
        function r() {
            --a || (s.loading = !1,
            f = Date.now(),
            P())
        }
        for (a = s.trial.memo.length,
        e = 0; e < s.trial.memo.length; e++)
            !function(a) {
                var t;
                firebase.storage().ref("images/" + s.trial.memo[a]).getDownloadURL().then(function(e) {
                    s.urls[s.trial.memo[a]] = e,
                    (t = new Image).onload = r,
                    t.src = e
                })
            }(e)
    }
    function T(e) {
        s.trial.memoCursor = e
    }
    function M(e) {
        switch (e.which) {
        case 43:
        case 61:
            D(s.trial.recallCursor),
            s.$$phase || s.$apply(),
            e.preventDefault();
            break;
        case 45:
            !function(e) {
                var a, t;
                for (t = !1,
                a = 0; a < s.trial.memo.length; a += 1)
                    s.trial.recall[a] < v && s.trial.recall[a] > e && (s.trial.recall[a] === s.trial.recallCursor + 1 && (t = !0),
                    N(a, s.trial.recall[a] - 1));
                t && s.setRecallCursor(A())
            }(s.trial.recallCursor),
            s.$$phase || s.$apply(),
            e.preventDefault()
        }
    }
    function I() {
        s.phase && "Completed" !== s.phase && firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + b).push({
            focus: !1,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function S() {
        s.phase && "Completed" !== s.phase && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + b).push({
            focus: !0,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function R(e) {
        "Memo" === s.phase && function(e) {
            switch (e.which) {
            case 13:
                s.stopMemo(),
                e.preventDefault();
                break;
            case 32:
            case 38:
            case 87:
                s.memoReturn(),
                s.$$phase || s.$apply(),
                e.preventDefault();
                break;
            case 37:
            case 65:
                s.memoPrev(),
                s.$$phase || s.$apply(),
                e.preventDefault();
                break;
            case 39:
            case 68:
                s.memoNext(),
                s.$$phase || s.$apply(),
                e.preventDefault()
            }
            s.stopAutoAdvance()
        }(e)
    }
    function k(e) {
        "Recall" === s.phase && M(e)
    }
    function N(e, a) {
        s.trial.recall[e] = a
    }
    function A() {
        for (var e, a = [], t = 0; t < s.trial.memo.length; t += 1)
            a[t] = !1;
        for (t = 0; t < s.trial.memo.length; t += 1)
            s.trial.recall[t] < v && (a[s.trial.recall[t]] = !0);
        for (t = 0; t < s.trial.memo.length; t += 1)
            if (!a[e = (s.trial.recallCursor + t + 1) % s.trial.memo.length])
                return e;
        return -1
    }
    function D(e) {
        for (var a = 0; a < s.trial.memo.length; a += 1)
            s.trial.recall[a] < v && s.trial.recall[a] >= e && (s.trial.recall[a] === s.trial.memo.length - 1 ? N(a, s.trial.origRecall[a]) : N(a, s.trial.recall[a] + 1))
    }
    function P() {
        var e, a, t, r = (Date.now() - f) / 1e3;
        if (m ? m = !1 : p && (2 < r - p || r - p < 0) && (f += 1e3 * (r - p - 1),
        r = (Date.now() - f) / 1e3),
        (p = r) < h && (s.phase = "PreMemo",
        e = h - r),
        h <= r && r < h + s.trial.memoTime && ("Memo" !== s.phase && (s.phase = "Memo",
        n && (i = setInterval(s.memoNext, 1e3 * n))),
        e = h + u - r),
        r >= h + s.trial.memoTime && r < h + u + w && ("PreRecall" !== s.phase && (s.phase = "PreRecall"),
        e = h + u + w - r),
        h + u + w <= r && r < h + u + w + d && ("Recall" !== s.phase && (s.phase = "Recall",
        s.showFinished = !1,
        o(function() {
            s.showFinished = !0
        }, 2e3)),
        e = h + u + w + d - r),
        h + u + w + d < r)
            return s.trial.recallTime || (s.trial.recallTime = d),
            s.phase = "Completed",
            s.showContinue = !1,
            o(function() {
                s.showContinue = !0
            }, 2e3),
            a = firebase.database().ref("pending").push({
                memoTime: s.trial.memoTime,
                recall: s.trial.recall,
                recallTime: s.trial.recallTime,
                requestType: "endTrain",
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                trialId: b,
                userId: firebase.auth().currentUser.uid
            }),
            void firebase.database().ref("pending/" + a.key + "/response").on("value", function(e) {
                (t = e.val()) && (firebase.database().ref("pending/" + a.key + "/response").off(),
                a.remove(),
                s.trial.score = t.score,
                t.targetReached && (s.message = t.message,
                $(".ui.modal.targetReached").modal("show")),
                s.$$phase || s.$apply())
            });
        s.timerMin = Math.floor(Math.round(e) / 60),
        r = Math.round(e) % 60,
        s.timerSec = (r < 10 ? "0" : "") + r,
        s.timerWarning = ("Memo" === s.phase || "Recall" === s.phase) && Math.round(e) < 10,
        g = o(P, 1e3)
    }
    l = 0,
    s.highLevel = 6,
    s.now = Date.now(),
    s.urls = {},
    s.usamc = "/usamc" === a.path().substring(0, 6),
    s.usamc && (s.attempt = parseInt(t.attempt, 0)),
    s.showInstructions = function() {
        $(".ui.modal.instructions").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.showLevels = function() {
        $(".ui.modal.levels").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    window.trainingType = window.trainingType || {},
    $(".menu .item").tab().tab("change tab", window.trainingType.Images || "standard").tab({
        onVisible: function(e) {
            window.trainingType.Images = e
        }
    }),
    $(".ui.checkbox").checkbox(),
    s.hideTimerClick = function() {
        s.prefs.imagesHideTimer = !s.prefs.imagesHideTimer
    }
    ,
    s.showPreferences = function() {
        r.user && (s.prefs = {
            imagesGroups: r.user.prefs.imagesGroups || "1",
            imagesHideTimer: r.user.prefs.imagesHideTimer || !1,
            prepTime: r.user.prefs.prepTime || "20s"
        },
        $(".ui.modal.preferences").modal("setting", {
            onApprove: y
        }).modal("show"))
    }
    ,
    s.start = function(t) {
        var e, a;
        if (h = "usamc" !== t && r.user && r.user.prefs && r.user.prefs.prepTime ? parseInt(r.user.prefs.prepTime, 10) : 20,
        "custom" === t) {
            if (!(0 < (u = parseInt(s.user.custom.Images.maxMemoTime, 10)) && u <= 1800))
                return void alert("Maximum memorization time must be a number between 1 and 1800.");
            if (s.user.custom.Images.autoAdvanceTotal && "" !== s.user.custom.Images.autoAdvanceTotal && (!(c = parseFloat(s.user.custom.Images.autoAdvanceTotal.replace(",", "."))) || !(5 <= c && c <= u)))
                return void alert("Auto advance total time must be either:\n   (i) blank, or\n   (ii) between 5 seconds and the maximum memorization time.");
            if (!(0 < (d = parseInt(s.user.custom.Images.maxRecallTime, 10)) && d <= 1800))
                return void alert("Maximum recall time must be a number between 1 and 1800.")
        }
        "standard" === t && (u = 60,
        d = 240,
        n = 0),
        "usamc" === t && (u = 300,
        d = 240,
        n = 0),
        s.loading = !0,
        e = {
            eventName: "Images",
            requestType: "train",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        },
        "custom" === t && (e.custom = s.user.custom.Images),
        "usamc" === t && (e.usamcAttempt = s.attempt),
        a = firebase.database().ref("pending").push(e),
        firebase.database().ref("pending/" + a.key + "/trialId").on("value", function(e) {
            (b = e.val()) && (firebase.database().ref("pending/" + a.key + "/trialId").off(),
            a.remove(),
            firebase.database().ref("trials/" + b).once("value", function(e, a) {
                s.trial = e.val(),
                "custom" === t && c && (n = c / s.trial.info.groups.length),
                C()
            }))
        })
    }
    ,
    s.stopMemo = function(e) {
        e = e || Date.now(),
        s.trial.memoTime = Math.round((e - f) / 10) / 100 - h,
        s.trial.memoTime > u && (s.trial.memoTime = u),
        n && Math.abs(s.trial.memoTime - c) < .05 && (s.trial.memoTime = Math.round(100 * c) / 100),
        s.stopAutoAdvance(),
        s.usamc ? s.skip() : (s.phase = "PreRecall",
        e = h + u + w - (e - f) / 1e3,
        s.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        s.timerSec = (e < 10 ? "0" : "") + e),
        s.$$phase || s.$apply()
    }
    ,
    s.memoPrev = function() {
        0 < s.trial.memoCursor && T(s.trial.memoCursor - 1)
    }
    ,
    s.memoNext = function() {
        s.trial.memoCursor === s.trial.info.groups.length - 1 ? "r6yQv9C6w6brdJaPpCg5yZjjV1Y2" !== firebase.auth().currentUser.uid && (i ? s.stopMemo(Date.now()) : Date.now() - l < 500 ? s.stopMemo(l) : l = Date.now()) : T(s.trial.memoCursor + 1),
        s.$$phase || s.$apply()
    }
    ,
    s.memoReturn = function() {
        T(0)
    }
    ,
    s.stopAutoAdvance = function() {
        i && (clearInterval(i),
        n = 0)
    }
    ,
    $(document).keydown(R),
    $(document).keypress(k),
    $(window).blur(I),
    $(window).focus(S),
    s.memoClass = function(e) {
        return "Memo" !== s.phase ? "" : s.trial.info.images[e].groupNum === s.trial.memoCursor ? "imagesMemoMid" + s.trial.info.images[e].posInGroup : s.trial.info.images[e].groupNum > s.trial.memoCursor ? "imagesMemoRight" + (e - s.trial.info.groups[0].size) : "imagesMemoLeft" + e
    }
    ,
    s.skip = function() {
        var e, a = (Date.now() - f) / 1e3;
        switch (s.phase) {
        case "PreMemo":
            e = h - a;
            break;
        case "Memo":
            e = h + u - a;
            break;
        case "PreRecall":
            e = h + u + w - a;
            break;
        case "Recall":
            e = h + u + w + d - a,
            s.trial.recallTime = a - h - u - w,
            s.phase = "Completed"
        }
        f -= 1e3 * e,
        p += e,
        o.cancel(g),
        P(),
        $(".skip").blur()
    }
    ,
    s.setRecallCursor = function(e) {
        s.trial.recallCursor = e
    }
    ,
    s.recallImageClick = function(e) {
        var a;
        s.trial.recall[e] > v - 1 ? (N(e, s.trial.recallCursor),
        s.setRecallCursor(A())) : (a = s.trial.recall[e],
        N(e, s.trial.origRecall[e]),
        s.setRecallCursor(a))
    }
    ,
    s.hover = function(e) {
        s.trial.fullSize = e
    }
    ,
    s.numClick = function(e) {
        D(e),
        s.setRecallCursor(e)
    }
    ,
    s.continueClick = function() {
        s.usamc ? a.path("home") : e.reload()
    }
    ,
    function e() {
        s.user ? (s.user.custom || (s.user.custom = {}),
        s.user.custom.Images || (s.user.custom.Images = {
            items: s.user.ratings && s.user.ratings.Images ? s.user.ratings.Images.items.toString() : "",
            maxMemoTime: "60",
            maxRecallTime: "240"
        }),
        s.user.custom.Images.maxRecallTime || (s.user.custom.Images.maxRecallTime = 240),
        void 0 === s.user.custom.Images.autoAdvanceTotal && (s.user.custom.Images.autoAdvanceTotal = ""),
        s.$$phase || s.$apply(),
        s.usamc && firebase.database().ref("championships/usamcq2023/competitors/" + firebase.auth().currentUser.uid + "/trialsRemaining/Images").once("value", function(e) {
            e = e.val(),
            1 === s.attempt && 2 === e || 2 === s.attempt && 1 === e ? s.start("usamc") : a.path("home")
        })) : s.showSignin ? (a.path("home"),
        s.$$phase || s.$apply()) : setTimeout(e, 1e3)
    }(),
    s.$on("$locationChangeStart", function(e) {
        s.phase && "Completed" !== s.phase && (m = !0,
        confirm("Are you sure you want to exit the trial?") || e.preventDefault())
    }),
    s.$on("$destroy", function() {
        $(".ui.modal.instructions").remove(),
        $(".ui.modal.levels").remove(),
        $(".ui.modal.preferences").remove(),
        $(".ui.modal.targetReached").remove(),
        o.cancel(g),
        $(document).off("keydown", R),
        $(document).off("keypress", k),
        $(window).off("blur", I),
        $(window).off("focus", S)
    })
}
]),
angular.module("myApp.train-international", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/train-international", {
        templateUrl: "train-international/train-international.html",
        controller: "TrainInternationalCtrl"
    })
}
]).controller("TrainInternationalCtrl", ["$scope", "$location", "$rootScope", "$route", "$timeout", function(s, a, r, e, o) {
    window.myscope = s;
    var i, n, c, m, t, l, p, u, h, d, f, g, b, v = 10;
    function w() {
        firebase.database().ref("pending").push({
            eventName: "International Names",
            internationalHideTimer: s.prefs.internationalHideTimer,
            internationalScript: s.prefs.internationalScript,
            prepTime: s.prefs.prepTime,
            requestType: "prefs",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    function y() {
        var e, a;
        function r() {
            --a || (s.loading = !1,
            f = Date.now(),
            D())
        }
        for (a = s.trial.memo.length,
        e = 0; e < s.trial.memo.length; e++)
            !function(a) {
                var t;
                firebase.storage().ref("names/" + s.trial.memo[a].photo).getDownloadURL().then(function(e) {
                    s.urls[s.trial.memo[a].photo] = e,
                    (t = new Image).onload = r,
                    t.src = e
                })
            }(e)
    }
    function C(e) {
        s.trial.memoCursor = e
    }
    function T() {
        s.trial.recallCursor !== s.trial.memo.length - 1 && (s.setRecallCursor(s.trial.recallCursor + 1),
        s.$$phase || s.$apply())
    }
    function M() {
        0 < s.trial.recallCursor && (s.setRecallCursor(s.trial.recallCursor - 1),
        s.$$phase || s.$apply())
    }
    function I(e) {
        switch (e.which) {
        case 9:
        case 13:
            (d ? M : T)(),
            e.preventDefault();
            break;
        case 37:
            M(),
            e.preventDefault();
            break;
        case 39:
            T(),
            e.preventDefault();
            break;
        case 38:
            6 <= s.trial.recallCursor && s.trial.recallCursor <= 17 ? (s.setRecallCursor(s.trial.recallCursor - 6),
            s.$$phase || s.$apply()) : 21 <= s.trial.recallCursor && (s.setRecallCursor(s.trial.recallCursor - 9),
            s.$$phase || s.$apply()),
            e.preventDefault();
            break;
        case 40:
            s.trial.recallCursor <= 11 && s.trial.recallCursor + 6 < s.trial.memo.length ? (s.setRecallCursor(s.trial.recallCursor + 6),
            s.$$phase || s.$apply()) : 12 <= s.trial.recallCursor && s.trial.recallCursor <= 21 && s.trial.recallCursor + 9 < s.trial.memo.length && (s.setRecallCursor(s.trial.recallCursor + 9),
            s.$$phase || s.$apply()),
            e.preventDefault();
            break;
        case 16:
            d = !0
        }
    }
    function S() {
        s.phase && "Completed" !== s.phase && firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + b).push({
            focus: !1,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function R() {
        s.phase && "Completed" !== s.phase && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + b).push({
            focus: !0,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function k(e) {
        switch (s.phase) {
        case "Memo":
            !function(e) {
                switch (e.which) {
                case 13:
                    s.stopMemo(),
                    e.preventDefault();
                    break;
                case 32:
                case 38:
                case 87:
                    s.memoReturn(),
                    s.$$phase || s.$apply(),
                    e.preventDefault();
                    break;
                case 37:
                case 65:
                    s.memoPrev(),
                    s.$$phase || s.$apply(),
                    e.preventDefault();
                    break;
                case 39:
                case 68:
                    s.memoNext(),
                    s.$$phase || s.$apply(),
                    e.preventDefault()
                }
                s.stopAutoAdvance()
            }(e);
            break;
        case "Recall":
            I(e)
        }
    }
    function N(e) {
        16 === e.which && d && (d = !1)
    }
    function A(e) {
        return e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = e.replace(/ß/g, "ss")).replace(/à/g, "a")).replace(/á/g, "a")).replace(/â/g, "a")).replace(/ã/g, "a")).replace(/ä/g, "a")).replace(/å/g, "a")).replace(/æ/g, "ae")).replace(/ç/g, "c")).replace(/ð/g, "d")).replace(/đ/g, "d")).replace(/è/g, "e")).replace(/é/g, "e")).replace(/ê/g, "e")).replace(/ë/g, "e")).replace(/ё/g, "e")).replace(/ė/g, "e")).replace(/е/g, "e")).replace(/ə/g, "e")).replace(/ğ/g, "g")).replace(/ì/g, "i")).replace(/í/g, "i")).replace(/î/g, "i")).replace(/ï/g, "i")).replace(/ı/g, "i")).replace(/i̇/g, "i")).replace(/ñ/g, "n")).replace(/ò/g, "o")).replace(/ó/g, "o")).replace(/ô/g, "o")).replace(/ö/g, "o")).replace(/ø/g, "o")).replace(/ù/g, "u")).replace(/ú/g, "u")).replace(/û/g, "u")).replace(/ü/g, "u")).replace(/ă/g, "a")).replace(/ą/g, "a")).replace(/ć/g, "c")).replace(/č/g, "c")).replace(/ę/g, "e")).replace(/ě/g, "e")).replace(/ł/g, "l")).replace(/ń/g, "n")).replace(/ő/g, "o")).replace(/œ/g, "oe")).replace(/ś/g, "s")).replace(/š/g, "s")).replace(/ű/g, "u")).replace(/ū/g, "u")).replace(/ź/g, "z")).replace(/ż/g, "z")).replace(/ž/g, "z")).replace(/ș/g, "s")).replace(/ş/g, "s")).replace(/ț/g, "t")).replace(/إ/g, "ا")).replace(/آ/g, "ا")).replace(/أ/g, "ا")).replace(/ي/g, "ى")).replace(/ة/g, "ه")).replace(/^ال/, "")).replace(/ά/g, "α")).replace(/έ/g, "ε")).replace(/ή/g, "η")).replace(/ϊ/g, "ι")).replace(/ΐ/g, "ι")).replace(/ί/g, "ι")).replace(/ό/g, "ο")).replace(/ώ/g, "ω")).replace(/ύ/g, "υ")).replace(/ΰ/g, "υ")).replace(/ϋ/g, "υ")).replace(/ς/g, "σ")).replace(/अं/g, "अन्")).replace(/जं/g, "जन्")).replace(/फ़/g, "फ")).replace(/ज़/g, "ज")).replace(/सं/g, "सन्")).replace(/यां/g, "यान्")).replace(/रबड़/g, "रबर")).replace(/बां/g, "बाँ")).replace(/बूं/g, "बूँ")).replace(/’/g, "'")
    }
    function D() {
        var e, a, t, r = (Date.now() - f) / 1e3;
        if (m ? m = !1 : l && (2 < r - l || r - l < 0) && (f += 1e3 * (r - l - 1),
        r = (Date.now() - f) / 1e3),
        (l = r) < u && (s.phase = "PreMemo",
        e = u - r),
        u <= r && r < u + s.trial.memoTime && ("Memo" !== s.phase && (s.phase = "Memo",
        n && (i = setInterval(s.memoNext, 1e3 * n))),
        e = u + p - r),
        r >= u + s.trial.memoTime && r < u + p + v && ("PreRecall" !== s.phase && (s.phase = "PreRecall"),
        e = u + p + v - r),
        u + p + v <= r && r < u + p + v + h && ("Recall" !== s.phase && (s.phase = "Recall",
        s.showFinished = !1,
        o(function() {
            s.showFinished = !0
        }, 2e3),
        o(function() {
            $("#namesRecall" + s.trial.inverseRecallSeqs[0]).focus()
        })),
        e = u + p + v + h - r),
        u + p + v + h < r)
            return s.trial.recallTime || (s.trial.recallTime = h),
            s.phase = "Completed",
            s.showContinue = !1,
            o(function() {
                s.showContinue = !0
            }, 2e3),
            a = firebase.database().ref("pending").push({
                memoTime: s.trial.memoTime,
                recall: s.trial.recall,
                recallTime: s.trial.recallTime,
                requestType: "endTrain",
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                trialId: b,
                userId: firebase.auth().currentUser.uid
            }),
            void firebase.database().ref("pending/" + a.key + "/response").on("value", function(e) {
                (t = e.val()) && (firebase.database().ref("pending/" + a.key + "/response").off(),
                a.remove(),
                s.trial.score = t.score,
                t.targetReached && (s.message = t.message,
                $(".ui.modal.targetReached").modal("show")),
                s.$$phase || s.$apply())
            });
        s.timerMin = Math.floor(Math.round(e) / 60),
        r = Math.round(e) % 60,
        s.timerSec = (r < 10 ? "0" : "") + r,
        s.timerWarning = ("Memo" === s.phase || "Recall" === s.phase) && Math.round(e) < 10,
        g = o(D, 1e3)
    }
    t = 0,
    s.highLevel = 6,
    s.now = Date.now(),
    s.urls = {},
    function e() {
        s.user ? (s.user.custom || (s.user.custom = {}),
        s.user.custom["International Names"] || (s.user.custom["International Names"] = {
            items: s.user.ratings && s.user.ratings["International Names"] ? s.user.ratings["International Names"].items.toString() : "",
            maxMemoTime: "60",
            maxRecallTime: "240"
        }),
        s.user.custom["International Names"].maxRecallTime || (s.user.custom["International Names"].maxRecallTime = 240),
        void 0 === s.user.custom["International Names"].autoAdvanceTotal && (s.user.custom["International Names"].autoAdvanceTotal = ""),
        s.$$phase || s.$apply()) : s.showSignin ? (a.path("home"),
        s.$$phase || s.$apply()) : setTimeout(e, 1e3)
    }(),
    s.showInstructions = function() {
        $(".ui.modal.instructions").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.showLevels = function() {
        $(".ui.modal.levels").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    window.trainingType = window.trainingType || {},
    $(".menu .item").tab().tab("change tab", window.trainingType["International Names"] || "standard").tab({
        onVisible: function(e) {
            window.trainingType["International Names"] = e
        }
    }),
    $(".ui.checkbox").checkbox(),
    s.hideTimerClick = function() {
        s.prefs.internationalHideTimer = !s.prefs.internationalHideTimer
    }
    ,
    s.showPreferences = function() {
        r.user && (s.prefs = {
            internationalHideTimer: r.user.prefs.internationalHideTimer || !1,
            internationalScript: r.user.prefs.internationalScript,
            prepTime: r.user.prefs.prepTime || "20s"
        },
        $(".ui.modal.preferences").modal("setting", {
            onApprove: w
        }).modal("show"))
    }
    ,
    s.start = function(t) {
        var e, a;
        if (u = r.user && r.user.prefs && r.user.prefs.prepTime ? parseInt(r.user.prefs.prepTime, 10) : 20,
        "custom" === t) {
            if (!(0 < (p = parseInt(s.user.custom["International Names"].maxMemoTime, 10)) && p <= 1800))
                return void alert("Maximum memorization time must be a number between 1 and 1800.");
            if (s.user.custom["International Names"].autoAdvanceTotal && "" !== s.user.custom["International Names"].autoAdvanceTotal && (!(c = parseFloat(s.user.custom["International Names"].autoAdvanceTotal.replace(",", "."))) || !(5 <= c && c <= p)))
                return void alert("Auto advance total time must be either:\n   (i) blank, or\n   (ii) between 5 seconds and the maximum memorization time.");
            if (!(0 < (h = parseInt(s.user.custom["International Names"].maxRecallTime, 10)) && h <= 1800))
                return void alert("Maximum recall time must be a number between 1 and 1800.")
        }
        "standard" === t && (p = 60,
        h = 240,
        n = 0),
        s.loading = !0,
        e = {
            eventName: "International Names",
            requestType: "train",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        },
        "custom" === t && (e.custom = s.user.custom["International Names"]),
        a = firebase.database().ref("pending").push(e),
        firebase.database().ref("pending/" + a.key + "/trialId").on("value", function(e) {
            (b = e.val()) && (firebase.database().ref("pending/" + a.key + "/trialId").off(),
            a.remove(),
            firebase.database().ref("trials/" + b).once("value", function(e, a) {
                s.trial = e.val(),
                "custom" === t && c && (n = c / s.trial.memo.length),
                y()
            }))
        })
    }
    ,
    s.stopMemo = function(e) {
        e = e || Date.now(),
        s.trial.memoTime = Math.round((e - f) / 10) / 100 - u,
        s.trial.memoTime > p && (s.trial.memoTime = p),
        n && Math.abs(s.trial.memoTime - c) < .05 && (s.trial.memoTime = Math.round(100 * c) / 100),
        s.stopAutoAdvance(),
        s.phase = "PreRecall",
        e = u + p + v - (e - f) / 1e3,
        s.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        s.timerSec = (e < 10 ? "0" : "") + e,
        s.$$phase || s.$apply()
    }
    ,
    s.memoPrev = function() {
        0 < s.trial.memoCursor && C(s.trial.memoCursor - 1)
    }
    ,
    s.memoNext = function() {
        s.trial.memoCursor === s.trial.memo.length - 1 ? i ? s.stopMemo(Date.now()) : Date.now() - t < 500 ? s.stopMemo(t) : t = Date.now() : C(s.trial.memoCursor + 1),
        s.$$phase || s.$apply()
    }
    ,
    s.memoReturn = function() {
        C(0)
    }
    ,
    s.memoClassPhoto = function(e) {
        return "Memo" !== s.phase ? "" : e == s.trial.memoCursor ? "namesMemoPhotoMid" : e > s.trial.memoCursor ? "namesMemoRight" + (e - 1) : "namesMemoLeft" + e
    }
    ,
    s.memoClassName = function(e) {
        return "Memo" !== s.phase ? "" : e == s.trial.memoCursor ? "namesMemoNameMid" : e > s.trial.memoCursor ? "namesMemoRight" + (e - 1) : "namesMemoLeft" + e
    }
    ,
    s.stopAutoAdvance = function() {
        i && (clearInterval(i),
        n = 0)
    }
    ,
    $(document).keydown(k),
    $(document).keyup(N),
    $(window).blur(S),
    $(window).focus(R),
    s.skip = function() {
        var e, a = (Date.now() - f) / 1e3;
        switch (s.phase) {
        case "PreMemo":
            e = u - a;
            break;
        case "Memo":
            e = u + p - a;
            break;
        case "PreRecall":
            e = u + p + v - a;
            break;
        case "Recall":
            e = u + p + v + h - a,
            s.trial.recallTime = a - u - p - v,
            s.phase = "Completed"
        }
        f -= 1e3 * e,
        l += e,
        o.cancel(g),
        D(),
        $(".skip").blur()
    }
    ,
    s.setRecallCursor = function(e) {
        s.trial.recallCursor = e,
        $("#namesRecall" + s.trial.inverseRecallSeqs[e]).focus()
    }
    ,
    s.isCorrect = function(e, a) {
        return !(!a || !e) && A(e.toLowerCase()) === A(a.toLowerCase())
    }
    ,
    s.isIncorrect = function(e, a) {
        return !(!a || !e) && A(e.toLowerCase()) !== A(a.toLowerCase())
    }
    ,
    s.continueClick = function() {
        e.reload()
    }
    ,
    s.$on("$locationChangeStart", function(e) {
        s.phase && "Completed" !== s.phase && (m = !0,
        confirm("Are you sure you want to exit the trial?") || e.preventDefault())
    }),
    s.$on("$destroy", function() {
        $(".ui.modal.instructions").remove(),
        $(".ui.modal.levels").remove(),
        $(".ui.modal.preferences").remove(),
        $(".ui.modal.targetReached").remove(),
        o.cancel(g),
        $(document).off("keydown", k),
        $(document).off("keyup", N),
        $(window).off("blur", S),
        $(window).off("focus", R)
    })
}
]),
angular.module("myApp.train-names", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/train-names", {
        templateUrl: "train-names/train-names.html",
        controller: "TrainNamesCtrl"
    }),
    e.when("/usamc-names/:attempt", {
        templateUrl: "train-names/train-names.html",
        controller: "TrainNamesCtrl"
    })
}
]).controller("TrainNamesCtrl", ["$scope", "$location", "$rootScope", "$route", "$routeParams", "$timeout", function(s, a, r, e, t, o) {
    window.myscope = s;
    var i, n, c, m, l, p, u, h, d, f, g, b, v, w = 10;
    function y() {
        firebase.database().ref("pending").push({
            eventName: "Names",
            namesHideTimer: s.prefs.namesHideTimer,
            namesLanguage: s.prefs.namesLanguage,
            prepTime: s.prefs.prepTime,
            requestType: "prefs",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    function C() {
        var e, a;
        function r() {
            --a || (s.loading = !1,
            g = Date.now(),
            P())
        }
        for (a = s.trial.memo.length,
        e = 0; e < s.trial.memo.length; e++)
            !function(a) {
                var t;
                firebase.storage().ref("names/" + s.trial.memo[a].photo).getDownloadURL().then(function(e) {
                    s.urls[s.trial.memo[a].photo] = e,
                    (t = new Image).onload = r,
                    t.src = e
                })
            }(e)
    }
    function T(e) {
        s.trial.memoCursor = e
    }
    function M() {
        s.trial.recallCursor !== s.trial.memo.length - 1 && (s.setRecallCursor(s.trial.recallCursor + 1),
        s.$$phase || s.$apply())
    }
    function I() {
        0 < s.trial.recallCursor && (s.setRecallCursor(s.trial.recallCursor - 1),
        s.$$phase || s.$apply())
    }
    function S(e) {
        switch (e.which) {
        case 9:
        case 13:
            (f ? I : M)(),
            e.preventDefault();
            break;
        case 37:
            I(),
            e.preventDefault();
            break;
        case 39:
            M(),
            e.preventDefault();
            break;
        case 38:
            6 <= s.trial.recallCursor && s.trial.recallCursor <= 17 ? (s.setRecallCursor(s.trial.recallCursor - 6),
            s.$$phase || s.$apply()) : 21 <= s.trial.recallCursor && (s.setRecallCursor(s.trial.recallCursor - 9),
            s.$$phase || s.$apply()),
            e.preventDefault();
            break;
        case 40:
            s.trial.recallCursor <= 11 && s.trial.recallCursor + 6 < s.trial.memo.length ? (s.setRecallCursor(s.trial.recallCursor + 6),
            s.$$phase || s.$apply()) : 12 <= s.trial.recallCursor && s.trial.recallCursor <= 21 && s.trial.recallCursor + 9 < s.trial.memo.length && (s.setRecallCursor(s.trial.recallCursor + 9),
            s.$$phase || s.$apply()),
            e.preventDefault();
            break;
        case 16:
            f = !0
        }
    }
    function R() {
        s.phase && "Completed" !== s.phase && firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + v).push({
            focus: !1,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function k() {
        s.phase && "Completed" !== s.phase && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + v).push({
            focus: !0,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function N(e) {
        switch (s.phase) {
        case "Memo":
            !function(e) {
                switch (e.which) {
                case 13:
                    s.stopMemo(),
                    e.preventDefault();
                    break;
                case 32:
                case 38:
                case 87:
                    s.memoReturn(),
                    s.$$phase || s.$apply(),
                    e.preventDefault();
                    break;
                case 37:
                case 65:
                    s.memoPrev(),
                    s.$$phase || s.$apply(),
                    e.preventDefault();
                    break;
                case 39:
                case 68:
                    s.memoNext(),
                    s.$$phase || s.$apply(),
                    e.preventDefault()
                }
                s.stopAutoAdvance()
            }(e);
            break;
        case "Recall":
            S(e)
        }
    }
    function A(e) {
        16 === e.which && f && (f = !1)
    }
    function D(e) {
        return e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = e.replace(/ß/g, "ss")).replace(/à/g, "a")).replace(/á/g, "a")).replace(/â/g, "a")).replace(/ã/g, "a")).replace(/ä/g, "a")).replace(/å/g, "a")).replace(/æ/g, "ae")).replace(/ç/g, "c")).replace(/ð/g, "d")).replace(/đ/g, "d")).replace(/è/g, "e")).replace(/é/g, "e")).replace(/ê/g, "e")).replace(/ë/g, "e")).replace(/ё/g, "e")).replace(/ė/g, "e")).replace(/е/g, "e")).replace(/ə/g, "e")).replace(/ğ/g, "g")).replace(/ì/g, "i")).replace(/í/g, "i")).replace(/î/g, "i")).replace(/ï/g, "i")).replace(/ı/g, "i")).replace(/i̇/g, "i")).replace(/ñ/g, "n")).replace(/ò/g, "o")).replace(/ó/g, "o")).replace(/ô/g, "o")).replace(/ö/g, "o")).replace(/ø/g, "o")).replace(/ù/g, "u")).replace(/ú/g, "u")).replace(/û/g, "u")).replace(/ü/g, "u")).replace(/ă/g, "a")).replace(/ą/g, "a")).replace(/ć/g, "c")).replace(/č/g, "c")).replace(/ę/g, "e")).replace(/ě/g, "e")).replace(/ł/g, "l")).replace(/ń/g, "n")).replace(/ő/g, "o")).replace(/œ/g, "oe")).replace(/ś/g, "s")).replace(/š/g, "s")).replace(/ű/g, "u")).replace(/ū/g, "u")).replace(/ź/g, "z")).replace(/ż/g, "z")).replace(/ž/g, "z")).replace(/ș/g, "s")).replace(/ş/g, "s")).replace(/ț/g, "t")).replace(/إ/g, "ا")).replace(/آ/g, "ا")).replace(/أ/g, "ا")).replace(/ي/g, "ى")).replace(/ة/g, "ه")).replace(/^ال/, "")).replace(/ά/g, "α")).replace(/έ/g, "ε")).replace(/ή/g, "η")).replace(/ϊ/g, "ι")).replace(/ΐ/g, "ι")).replace(/ί/g, "ι")).replace(/ό/g, "ο")).replace(/ώ/g, "ω")).replace(/ύ/g, "υ")).replace(/ΰ/g, "υ")).replace(/ϋ/g, "υ")).replace(/ς/g, "σ")).replace(/अं/g, "अन्")).replace(/जं/g, "जन्")).replace(/फ़/g, "फ")).replace(/ज़/g, "ज")).replace(/सं/g, "सन्")).replace(/यां/g, "यान्")).replace(/रबड़/g, "रबर")).replace(/बां/g, "बाँ")).replace(/बूं/g, "बूँ")).replace(/’/g, "'")
    }
    function P() {
        var e, a, t, r = (Date.now() - g) / 1e3;
        if (m ? m = !1 : p && (2 < r - p || r - p < 0) && (g += 1e3 * (r - p - 1),
        r = (Date.now() - g) / 1e3),
        (p = r) < h && (s.phase = "PreMemo",
        e = h - r),
        h <= r && r < h + s.trial.memoTime && ("Memo" !== s.phase && (s.phase = "Memo",
        n && (i = setInterval(s.memoNext, 1e3 * n))),
        e = h + u - r),
        r >= h + s.trial.memoTime && r < h + u + w && ("PreRecall" !== s.phase && (s.phase = "PreRecall"),
        e = h + u + w - r),
        h + u + w <= r && r < h + u + w + d && ("Recall" !== s.phase && (s.phase = "Recall",
        s.showFinished = !1,
        o(function() {
            s.showFinished = !0
        }, 2e3),
        o(function() {
            $("#namesRecall" + s.trial.inverseRecallSeqs[0]).focus()
        })),
        e = h + u + w + d - r),
        h + u + w + d < r)
            return s.trial.recallTime || (s.trial.recallTime = d),
            s.phase = "Completed",
            s.showContinue = !1,
            o(function() {
                s.showContinue = !0
            }, 2e3),
            a = firebase.database().ref("pending").push({
                memoTime: s.trial.memoTime,
                recall: s.trial.recall,
                recallTime: s.trial.recallTime,
                requestType: "endTrain",
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                trialId: v,
                userId: firebase.auth().currentUser.uid
            }),
            void firebase.database().ref("pending/" + a.key + "/response").on("value", function(e) {
                (t = e.val()) && (firebase.database().ref("pending/" + a.key + "/response").off(),
                a.remove(),
                s.trial.score = t.score,
                t.targetReached && (s.message = t.message,
                $(".ui.modal.targetReached").modal("show")),
                s.$$phase || s.$apply())
            });
        s.timerMin = Math.floor(Math.round(e) / 60),
        r = Math.round(e) % 60,
        s.timerSec = (r < 10 ? "0" : "") + r,
        s.timerWarning = ("Memo" === s.phase || "Recall" === s.phase) && Math.round(e) < 10,
        b = o(P, 1e3)
    }
    l = 0,
    s.highLevel = 6,
    s.now = Date.now(),
    s.urls = {},
    s.usamc = "/usamc" === a.path().substring(0, 6),
    s.usamc && (s.attempt = parseInt(t.attempt, 0)),
    s.showInstructions = function() {
        $(".ui.modal.instructions").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.showLevels = function() {
        $(".ui.modal.levels").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    window.trainingType = window.trainingType || {},
    $(".menu .item").tab().tab("change tab", window.trainingType.Names || "standard").tab({
        onVisible: function(e) {
            window.trainingType.Names = e
        }
    }),
    $(".ui.checkbox").checkbox(),
    s.hideTimerClick = function() {
        s.prefs.namesHideTimer = !s.prefs.namesHideTimer
    }
    ,
    s.showPreferences = function() {
        r.user && (s.prefs = {
            namesHideTimer: r.user.prefs.namesHideTimer || !1,
            namesLanguage: r.user.prefs.namesLanguage,
            prepTime: r.user.prefs.prepTime || "20s"
        },
        $(".ui.modal.preferences").modal("setting", {
            onApprove: y
        }).modal("show"))
    }
    ,
    s.start = function(t) {
        var e, a;
        if (h = "usamc" !== t && r.user && r.user.prefs && r.user.prefs.prepTime ? parseInt(r.user.prefs.prepTime, 10) : 20,
        "custom" === t) {
            if (!(0 < (u = parseInt(s.user.custom.Names.maxMemoTime, 10)) && u <= 1800))
                return void alert("Maximum memorization time must be a number between 1 and 1800.");
            if (s.user.custom.Names.autoAdvanceTotal && "" !== s.user.custom.Names.autoAdvanceTotal && (!(c = parseFloat(s.user.custom.Names.autoAdvanceTotal.replace(",", "."))) || !(5 <= c && c <= u)))
                return void alert("Auto advance total time must be either:\n   (i) blank, or\n   (ii) between 5 seconds and the maximum memorization time.");
            if (!(0 < (d = parseInt(s.user.custom.Names.maxRecallTime, 10)) && d <= 1800))
                return void alert("Maximum recall time must be a number between 1 and 1800.")
        }
        "standard" === t && (u = 60,
        d = 240,
        n = 0),
        "usamc" === t && (u = 300,
        d = 240,
        n = 0),
        s.loading = !0,
        e = {
            eventName: "Names",
            requestType: "train",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        },
        "custom" === t && (e.custom = s.user.custom.Names),
        "usamc" === t && (e.usamcAttempt = s.attempt),
        a = firebase.database().ref("pending").push(e),
        firebase.database().ref("pending/" + a.key + "/trialId").on("value", function(e) {
            (v = e.val()) && (firebase.database().ref("pending/" + a.key + "/trialId").off(),
            a.remove(),
            firebase.database().ref("trials/" + v).once("value", function(e, a) {
                s.trial = e.val(),
                "custom" === t && c && (n = c / s.trial.memo.length),
                C()
            }))
        })
    }
    ,
    s.stopMemo = function(e) {
        e = e || Date.now(),
        s.trial.memoTime = Math.round((e - g) / 10) / 100 - h,
        s.trial.memoTime > u && (s.trial.memoTime = u),
        n && Math.abs(s.trial.memoTime - c) < .05 && (s.trial.memoTime = Math.round(100 * c) / 100),
        s.stopAutoAdvance(),
        s.usamc ? s.skip() : (s.phase = "PreRecall",
        e = h + u + w - (e - g) / 1e3,
        s.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        s.timerSec = (e < 10 ? "0" : "") + e),
        s.$$phase || s.$apply()
    }
    ,
    s.memoPrev = function() {
        0 < s.trial.memoCursor && T(s.trial.memoCursor - 1)
    }
    ,
    s.memoNext = function() {
        s.trial.memoCursor === s.trial.memo.length - 1 ? "r6yQv9C6w6brdJaPpCg5yZjjV1Y2" !== firebase.auth().currentUser.uid && (i ? s.stopMemo(Date.now()) : Date.now() - l < 500 ? s.stopMemo(l) : l = Date.now()) : T(s.trial.memoCursor + 1),
        s.$$phase || s.$apply()
    }
    ,
    s.memoReturn = function() {
        T(0)
    }
    ,
    s.memoClassPhoto = function(e) {
        return "Memo" !== s.phase ? "" : e == s.trial.memoCursor ? "namesMemoPhotoMid" : e > s.trial.memoCursor ? "namesMemoRight" + (e - 1) : "namesMemoLeft" + e
    }
    ,
    s.memoClassName = function(e) {
        return "Memo" !== s.phase ? "" : e == s.trial.memoCursor ? "namesMemoNameMid" : e > s.trial.memoCursor ? "namesMemoRight" + (e - 1) : "namesMemoLeft" + e
    }
    ,
    s.stopAutoAdvance = function() {
        i && (clearInterval(i),
        n = 0)
    }
    ,
    $(document).keydown(N),
    $(document).keyup(A),
    $(window).blur(R),
    $(window).focus(k),
    s.skip = function() {
        var e, a = (Date.now() - g) / 1e3;
        switch (s.phase) {
        case "PreMemo":
            e = h - a;
            break;
        case "Memo":
            e = h + u - a;
            break;
        case "PreRecall":
            e = h + u + w - a;
            break;
        case "Recall":
            e = h + u + w + d - a,
            s.trial.recallTime = a - h - u - w,
            s.phase = "Completed"
        }
        g -= 1e3 * e,
        p += e,
        o.cancel(b),
        P(),
        $(".skip").blur()
    }
    ,
    s.setRecallCursor = function(e) {
        s.trial.recallCursor = e,
        $("#namesRecall" + s.trial.inverseRecallSeqs[e]).focus()
    }
    ,
    s.isCorrect = function(e, a) {
        return !(!a || !e) && D(e.toLowerCase()) === D(a.toLowerCase())
    }
    ,
    s.isIncorrect = function(e, a) {
        return !(!a || !e) && D(e.toLowerCase()) !== D(a.toLowerCase())
    }
    ,
    s.continueClick = function() {
        s.usamc ? a.path("home") : e.reload()
    }
    ,
    function e() {
        s.user ? (s.user.custom || (s.user.custom = {}),
        s.user.custom.Names || (s.user.custom.Names = {
            items: s.user.ratings && s.user.ratings.Names ? s.user.ratings.Names.items.toString() : "",
            maxMemoTime: "60",
            maxRecallTime: "240"
        }),
        s.user.custom.Names.maxRecallTime || (s.user.custom.Names.maxRecallTime = 240),
        void 0 === s.user.custom.Names.autoAdvanceTotal && (s.user.custom.Names.autoAdvanceTotal = ""),
        s.$$phase || s.$apply(),
        s.usamc && firebase.database().ref("championships/usamcq2023/competitors/" + firebase.auth().currentUser.uid + "/trialsRemaining/Names").once("value", function(e) {
            e = e.val(),
            1 === s.attempt && 2 === e || 2 === s.attempt && 1 === e ? s.start("usamc") : a.path("home")
        })) : s.showSignin ? (a.path("home"),
        s.$$phase || s.$apply()) : setTimeout(e, 1e3)
    }(),
    s.$on("$locationChangeStart", function(e) {
        s.phase && "Completed" !== s.phase && (m = !0,
        confirm("Are you sure you want to exit the trial?") || e.preventDefault())
    }),
    s.$on("$destroy", function() {
        $(".ui.modal.instructions").remove(),
        $(".ui.modal.levels").remove(),
        $(".ui.modal.preferences").remove(),
        $(".ui.modal.targetReached").remove(),
        o.cancel(b),
        $(document).off("keydown", N),
        $(document).off("keyup", A),
        $(window).off("blur", R),
        $(window).off("focus", k)
    })
}
]),
angular.module("myApp.train-numbers", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/train-numbers", {
        templateUrl: "train-numbers/train-numbers.html",
        controller: "TrainNumbersCtrl"
    }),
    e.when("/usamc-numbers/:attempt", {
        templateUrl: "train-numbers/train-numbers.html",
        controller: "TrainNumbersCtrl"
    })
}
]).controller("TrainNumbersCtrl", ["$scope", "$location", "$rootScope", "$route", "$routeParams", "$sce", "$timeout", function(s, a, o, e, t, i, n) {
    window.myscope = s;
    var c, m, l, p, r, u, h, d, f, g, b, v, w = 20, y = 10;
    function C() {
        var e, a;
        if ("3,2,3" !== s.prefs.numbersGroups)
            for (e = s.prefs.numbersGroups.split(" "),
            a = 0; a < e.length; a += 1)
                if ("1" !== e[a] && "2" !== e[a] && "3" !== e[a] && "4" !== e[a] && "5" !== e[a] && "6" !== e[a] && "7" !== e[a] && "8" !== e[a] || "1" === s.prefs.numbersGroups)
                    return alert("Invalid Groups value - groups must be between 2 and 8"),
                    !1;
        firebase.database().ref("pending").push({
            eventName: "Numbers",
            numbersGroups: s.prefs.numbersGroups,
            numbersHideTimer: s.prefs.numbersHideTimer,
            prepTime: s.prefs.prepTime,
            requestType: "prefs",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        })
    }
    function T(e) {
        s.trial.memoCursor = e
    }
    function M() {
        s.phase && "Completed" !== s.phase && firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + v).push({
            focus: !1,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function I() {
        s.phase && "Completed" !== s.phase && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + v).push({
            focus: !0,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function S(e) {
        switch (s.phase) {
        case "Memo":
            !function(e) {
                switch (e.which) {
                case 13:
                    s.stopMemo(),
                    e.preventDefault();
                    break;
                case 32:
                case 38:
                case 87:
                    s.memoReturn(),
                    s.$$phase || s.$apply(),
                    e.preventDefault();
                    break;
                case 37:
                case 65:
                    s.memoPrev(),
                    s.$$phase || s.$apply(),
                    e.preventDefault();
                    break;
                case 39:
                case 68:
                    s.memoNext(),
                    s.$$phase || s.$apply(),
                    e.preventDefault()
                }
                s.stopAutoAdvance()
            }(e);
            break;
        case "Recall":
            !function(e) {
                switch (e.which) {
                case 8:
                    0 !== s.trial.recallCursor && s.setRecallCursor(s.trial.recallCursor - 1),
                    k(s.trial.recallCursor, ""),
                    e.preventDefault();
                    break;
                case 37:
                case 65:
                    0 !== s.trial.recallCursor && s.setRecallCursor(s.trial.recallCursor - 1),
                    e.preventDefault();
                    break;
                case 38:
                case 87:
                    s.trial.recallCursor > w - 1 && s.setRecallCursor(s.trial.recallCursor - w),
                    e.preventDefault();
                    break;
                case 39:
                case 68:
                    s.trial.recallCursor !== s.trial.memo.length - 1 && s.setRecallCursor(s.trial.recallCursor + 1),
                    e.preventDefault();
                    break;
                case 40:
                case 83:
                    s.trial.recallCursor < s.trial.memo.length - w && s.setRecallCursor(s.trial.recallCursor + w),
                    e.preventDefault();
                    break;
                case 46:
                    k(s.trial.recallCursor, "")
                }
                (48 <= e.which && e.which <= 57 || 96 <= e.which && e.which <= 105) && (48 <= e.which && e.which <= 57 ? s.recallDigit(e.which - 48) : s.recallDigit(e.which - 96)),
                s.$$phase || s.$apply()
            }(e)
        }
    }
    function R(e) {
        "Recall" === s.phase && function(e) {
            switch (e.which) {
            case 43:
            case 61:
                N(s.trial.recallCursor),
                s.$$phase || s.$apply(),
                e.preventDefault();
                break;
            case 45:
                A(s.trial.recallCursor),
                s.$$phase || s.$apply(),
                e.preventDefault()
            }
        }(e)
    }
    function k(e, a) {
        s.trial.recall[e] = a
    }
    function N(e) {
        for (var a = s.trial.memo.length - 1; e < a; --a)
            k(a, s.trial.recall[a - 1]);
        k(e, ""),
        s.$$phase || s.$apply()
    }
    function A(e) {
        for (var a = e; a < s.trial.memo.length - 1; a += 1)
            k(a, s.trial.recall[a + 1]);
        k(s.trial.memo.length - 1, ""),
        s.$$phase || s.$apply()
    }
    function D() {
        var e, a, t, r = (Date.now() - g) / 1e3;
        if (p ? p = !1 : u && (2 < r - u || r - u < 0) && (g += 1e3 * (r - u - 1),
        r = (Date.now() - g) / 1e3),
        (u = r) < d && (s.phase = "PreMemo",
        e = d - r),
        d <= r && r < d + s.trial.memoTime && ("Memo" !== s.phase && (s.phase = "Memo",
        m && (c = setInterval(s.memoNext, 1e3 * m))),
        e = d + h - r),
        r >= d + s.trial.memoTime && r < d + h + y && ("PreRecall" !== s.phase && (s.phase = "PreRecall"),
        e = d + h + y - r),
        d + h + y <= r && r < d + h + y + f && ("Recall" !== s.phase && (s.phase = "Recall",
        s.showFinished = !1,
        n(function() {
            s.showFinished = !0
        }, 2e3)),
        e = d + h + y + f - r),
        d + h + y + f < r)
            return s.trial.recallTime || (s.trial.recallTime = f),
            s.phase = "Completed",
            s.showContinue = !1,
            n(function() {
                s.showContinue = !0
            }, 2e3),
            a = firebase.database().ref("pending").push({
                memoTime: s.trial.memoTime,
                recall: s.trial.recall,
                recallTime: s.trial.recallTime,
                requestType: "endTrain",
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                trialId: v,
                userId: firebase.auth().currentUser.uid
            }),
            void firebase.database().ref("pending/" + a.key + "/response").on("value", function(e) {
                (t = e.val()) && (firebase.database().ref("pending/" + a.key + "/response").off(),
                a.remove(),
                s.trial.score = t.score,
                t.targetReached && (s.message = t.message,
                $(".ui.modal.targetReached").modal("show")),
                s.$$phase || s.$apply())
            });
        s.timerMin = Math.floor(Math.round(e) / 60),
        r = Math.round(e) % 60,
        s.timerSec = (r < 10 ? "0" : "") + r,
        s.timerWarning = ("Memo" === s.phase || "Recall" === s.phase) && Math.round(e) < 10,
        b = n(D, 1e3)
    }
    r = 0,
    s.highLevel = 6,
    s.now = Date.now(),
    s.usamc = "/usamc" === a.path().substring(0, 6),
    s.usamc && (s.attempt = parseInt(t.attempt, 0)),
    s.showInstructions = function() {
        $(".ui.modal.instructions").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.showLevels = function() {
        $(".ui.modal.levels").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    window.trainingType = window.trainingType || {},
    $(".menu .item").tab().tab("change tab", window.trainingType.Numbers || "standard").tab({
        onVisible: function(e) {
            window.trainingType.Numbers = e
        }
    }),
    $(".ui.checkbox").checkbox(),
    s.hideTimerClick = function() {
        s.prefs.numbersHideTimer = !s.prefs.numbersHideTimer
    }
    ,
    s.showPreferences = function() {
        o.user && (s.prefs = {
            numbersGroups: o.user.prefs.numbersGroups,
            numbersHideTimer: o.user.prefs.numbersHideTimer || !1,
            prepTime: o.user.prefs.prepTime || "20s"
        },
        $(".ui.modal.preferences").modal("setting", {
            onApprove: C
        }).modal("show"))
    }
    ,
    s.start = function(a) {
        var t, e, r;
        if (d = "usamc" !== a && o.user && o.user.prefs && o.user.prefs.prepTime ? parseInt(o.user.prefs.prepTime, 10) : 20,
        "custom" === a) {
            if (!(0 < (h = parseInt(s.user.custom.Numbers.maxMemoTime, 10)) && h <= 1800))
                return void alert("Maximum memorization time must be a number between 1 and 1800.");
            if (s.user.custom.Numbers.autoAdvanceTotal && "" !== s.user.custom.Numbers.autoAdvanceTotal && (!(l = parseFloat(s.user.custom.Numbers.autoAdvanceTotal.replace(",", "."))) || !(5 <= l && l <= h)))
                return void alert("Auto advance total time must be either:\n   (i) blank, or\n   (ii) between 5 seconds and the maximum memorization time.");
            if (!(0 < (f = parseInt(s.user.custom.Numbers.maxRecallTime, 10)) && f <= 1800))
                return void alert("Maximum recall time must be a number between 1 and 1800.")
        }
        "standard" === a && (h = 60,
        f = 240,
        m = 0),
        "usamc" === a && (h = 300,
        f = 240,
        m = 0),
        s.loading = !0,
        e = {
            eventName: "Numbers",
            requestType: "train",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        },
        "custom" === a && (e.custom = s.user.custom.Numbers),
        "usamc" === a && (e.usamcAttempt = s.attempt),
        r = firebase.database().ref("pending").push(e),
        firebase.database().ref("pending/" + r.key + "/trialId").on("value", function(e) {
            (v = e.val()) && (firebase.database().ref("pending/" + r.key + "/trialId").off(),
            r.remove(),
            firebase.database().ref("trials/" + v).once("value").then(function(e) {
                for (s.trial = e.val(),
                "custom" === a && l && (m = l / s.trial.info.groups.length),
                t = 0; t < s.trial.info.groupCount; t += 1)
                    s.trial.info.groups[t].contents = i.trustAsHtml(s.trial.info.groups[t].contents);
                s.loading = !1,
                g = Date.now(),
                D()
            }))
        })
    }
    ,
    s.stopMemo = function(e) {
        e = e || Date.now(),
        s.trial.memoTime = Math.round((e - g) / 10) / 100 - d,
        s.trial.memoTime > h && (s.trial.memoTime = h),
        m && Math.abs(s.trial.memoTime - l) < .05 && (s.trial.memoTime = Math.round(100 * l) / 100),
        s.stopAutoAdvance(),
        s.usamc ? s.skip() : (s.phase = "PreRecall",
        e = d + h + y - (e - g) / 1e3,
        s.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        s.timerSec = (e < 10 ? "0" : "") + e),
        s.$$phase || s.$apply()
    }
    ,
    s.memoPrev = function() {
        0 < s.trial.memoCursor && T(s.trial.memoCursor - 1)
    }
    ,
    s.memoNext = function() {
        s.trial.memoCursor === s.trial.info.groupCount - 1 ? "r6yQv9C6w6brdJaPpCg5yZjjV1Y2" !== firebase.auth().currentUser.uid && (c ? s.stopMemo(Date.now()) : Date.now() - r < 500 ? s.stopMemo(r) : r = Date.now()) : T(s.trial.memoCursor + 1),
        s.$$phase || s.$apply()
    }
    ,
    s.memoReturn = function() {
        T(0)
    }
    ,
    s.stopAutoAdvance = function() {
        c && (clearInterval(c),
        m = 0)
    }
    ,
    s.recallDigit = function(e) {
        k(s.trial.recallCursor, e),
        s.trial.recallCursor < s.trial.memo.length - 1 && s.setRecallCursor(s.trial.recallCursor + 1)
    }
    ,
    $(document).keydown(S),
    $(document).keypress(R),
    $(window).blur(M),
    $(window).focus(I),
    s.memoClass = function(e) {
        return "" === s.phase ? "" : e === s.trial.memoCursor ? "numbersMemoMid" : e > s.trial.memoCursor ? "numbersMemoRight" + s.trial.info.groups[e].position : "numbersMemoLeft" + s.trial.info.groups[e].position
    }
    ,
    s.skip = function() {
        var e, a = (Date.now() - g) / 1e3;
        switch (s.phase) {
        case "PreMemo":
            e = d - a;
            break;
        case "Memo":
            e = d + h - a;
            break;
        case "PreRecall":
            e = d + h + y - a;
            break;
        case "Recall":
            e = d + h + y + f - a,
            s.trial.recallTime = a - d - h - y,
            s.phase = "Completed"
        }
        g -= 1e3 * e,
        u += e,
        n.cancel(b),
        D(),
        $(".skip").blur()
    }
    ,
    s.setRecallCursor = function(e) {
        s.trial.recallCursor = e
    }
    ,
    s.shiftLeftClick = function() {
        A(s.trial.recallCursor)
    }
    ,
    s.shiftRightClick = function() {
        N(s.trial.recallCursor)
    }
    ,
    s.continueClick = function() {
        s.usamc ? a.path("home") : e.reload()
    }
    ,
    function e() {
        s.user ? (s.user.custom || (s.user.custom = {}),
        s.user.custom.Numbers || (s.user.custom.Numbers = {
            items: s.user.ratings && s.user.ratings.Numbers ? s.user.ratings.Numbers.items.toString() : "",
            maxMemoTime: "60",
            maxRecallTime: "240"
        }),
        s.user.custom.Numbers.maxRecallTime || (s.user.custom.Numbers.maxRecallTime = 240),
        void 0 === s.user.custom.Numbers.autoAdvanceTotal && (s.user.custom.Numbers.autoAdvanceTotal = ""),
        s.$$phase || s.$apply(),
        s.usamc && firebase.database().ref("championships/usamcq2023/competitors/" + firebase.auth().currentUser.uid + "/trialsRemaining/Numbers").once("value", function(e) {
            e = e.val(),
            1 === s.attempt && 2 === e || 2 === s.attempt && 1 === e ? s.start("usamc") : a.path("home")
        })) : s.showSignin ? (a.path("home"),
        s.$$phase || s.$apply()) : setTimeout(e, 1e3)
    }(),
    s.$on("$locationChangeStart", function(e) {
        s.phase && "Completed" !== s.phase && (p = !0,
        confirm("Are you sure you want to exit the trial?") || e.preventDefault())
    }),
    s.$on("$destroy", function() {
        $(".ui.modal.instructions").remove(),
        $(".ui.modal.levels").remove(),
        $(".ui.modal.preferences").remove(),
        $(".ui.modal.targetReached").remove(),
        n.cancel(b),
        $(document).off("keydown", S),
        $(document).off("keypress", R),
        $(window).off("blur", M),
        $(window).off("focus", I)
    })
}
]),
angular.module("myApp.train-words", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/train-words", {
        templateUrl: "train-words/train-words.html",
        controller: "TrainWordsCtrl"
    })
}
]).controller("TrainWordsCtrl", ["$scope", "$location", "$rootScope", "$route", "$timeout", function(s, a, r, e, o) {
    window.myscope = s;
    var i, n, c, m, t, l, p, u, h, d, f, g, b, v = 10;
    function w() {
        for (var e = s.prefs.wordsGroups.split(" "), a = 0; a < e.length; a += 1)
            if ("1" !== e[a] && "2" !== e[a] && "3" !== e[a] && "4" !== e[a] && "5" !== e[a])
                return alert("Invalid Groups value - groups must be between 1 and 5"),
                !1;
        firebase.database().ref("pending").push({
            eventName: "Words",
            prepTime: s.prefs.prepTime,
            requestType: "prefs",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid,
            wordsGroups: s.prefs.wordsGroups,
            wordsHideTimer: s.prefs.wordsHideTimer,
            wordsLanguage: s.prefs.wordsLanguage
        })
    }
    function y(e) {
        s.trial.memoCursor = e
    }
    function C() {
        s.trial.recallCursor !== s.trial.memo.length - 1 && (s.setRecallCursor(s.trial.recallCursor + 1),
        $("#wordsRecall" + s.trial.recallCursor).focus(),
        s.$$phase || s.$apply())
    }
    function T() {
        0 < s.trial.recallCursor && (s.setRecallCursor(s.trial.recallCursor - 1),
        $("#wordsRecall" + s.trial.recallCursor).focus(),
        s.$$phase || s.$apply())
    }
    function M(e) {
        switch (e.which) {
        case 9:
        case 13:
            (d ? T : C)(),
            e.preventDefault();
            break;
        case 40:
            C(),
            e.preventDefault();
            break;
        case 38:
            T(),
            e.preventDefault();
            break;
        case 37:
            0 <= s.trial.recallCursor - 10 && (s.setRecallCursor(s.trial.recallCursor - 10),
            $("#wordsRecall" + s.trial.recallCursor).focus(),
            s.$$phase || s.$apply()),
            e.preventDefault();
            break;
        case 39:
            s.trial.recallCursor + 10 < s.trial.memo.length && (s.setRecallCursor(s.trial.recallCursor + 10),
            $("#wordsRecall" + s.trial.recallCursor).focus(),
            s.$$phase || s.$apply()),
            e.preventDefault();
            break;
        case 16:
            d = !0
        }
    }
    function I(e) {
        switch (e.which) {
        case 43:
        case 61:
            !function(e) {
                var a;
                for (a = s.trial.memo.length - 1; e < a; --a)
                    D(a, s.trial.recall[a - 1]);
                D(e, ""),
                s.$$phase || s.$apply()
            }(s.trial.recallCursor),
            s.$$phase || s.$apply(),
            e.preventDefault();
            break;
        case 45:
            !function(e) {
                var a;
                for (a = e; a < s.trial.memo.length - 1; a += 1)
                    D(a, s.trial.recall[a + 1]);
                D(s.trial.memo.length - 1, ""),
                s.$$phase || s.$apply()
            }(s.trial.recallCursor),
            s.$$phase || s.$apply(),
            e.preventDefault()
        }
    }
    function S() {
        s.phase && "Completed" !== s.phase && firebase.auth().currentUser && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + b).push({
            focus: !1,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function R() {
        s.phase && "Completed" !== s.phase && firebase.database().ref("changes/" + firebase.auth().currentUser.uid + "/training/" + b).push({
            focus: !0,
            phase: s.phase,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        })
    }
    function k(e) {
        switch (s.phase) {
        case "Memo":
            !function(e) {
                switch (e.which) {
                case 13:
                    s.stopMemo(),
                    e.preventDefault();
                    break;
                case 32:
                case 38:
                case 87:
                    s.memoReturn(),
                    s.$$phase || s.$apply(),
                    e.preventDefault();
                    break;
                case 37:
                case 65:
                    s.memoPrev(),
                    s.$$phase || s.$apply(),
                    e.preventDefault();
                    break;
                case 39:
                case 68:
                    s.memoNext(),
                    s.$$phase || s.$apply(),
                    e.preventDefault()
                }
                s.stopAutoAdvance()
            }(e);
            break;
        case "Recall":
            M(e)
        }
    }
    function N(e) {
        16 === e.which && d && (d = !1)
    }
    function A(e) {
        "Recall" === s.phase && I(e)
    }
    function D(e, a) {
        s.trial.recall[e] = a
    }
    function P(e) {
        return e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = e.replace(/ß/g, "ss")).replace(/à/g, "a")).replace(/á/g, "a")).replace(/â/g, "a")).replace(/ã/g, "a")).replace(/ä/g, "a")).replace(/å/g, "a")).replace(/æ/g, "ae")).replace(/ç/g, "c")).replace(/ð/g, "d")).replace(/đ/g, "d")).replace(/è/g, "e")).replace(/é/g, "e")).replace(/ê/g, "e")).replace(/ë/g, "e")).replace(/ё/g, "e")).replace(/ė/g, "e")).replace(/е/g, "e")).replace(/ə/g, "e")).replace(/ğ/g, "g")).replace(/ì/g, "i")).replace(/í/g, "i")).replace(/î/g, "i")).replace(/ï/g, "i")).replace(/ı/g, "i")).replace(/i̇/g, "i")).replace(/ñ/g, "n")).replace(/ò/g, "o")).replace(/ó/g, "o")).replace(/ô/g, "o")).replace(/ö/g, "o")).replace(/ø/g, "o")).replace(/ù/g, "u")).replace(/ú/g, "u")).replace(/û/g, "u")).replace(/ü/g, "u")).replace(/ă/g, "a")).replace(/ą/g, "a")).replace(/ć/g, "c")).replace(/č/g, "c")).replace(/ę/g, "e")).replace(/ě/g, "e")).replace(/ł/g, "l")).replace(/ń/g, "n")).replace(/ő/g, "o")).replace(/œ/g, "oe")).replace(/ś/g, "s")).replace(/š/g, "s")).replace(/ű/g, "u")).replace(/ū/g, "u")).replace(/ź/g, "z")).replace(/ż/g, "z")).replace(/ž/g, "z")).replace(/ș/g, "s")).replace(/ş/g, "s")).replace(/ț/g, "t")).replace(/إ/g, "ا")).replace(/آ/g, "ا")).replace(/أ/g, "ا")).replace(/ي/g, "ى")).replace(/ة/g, "ه")).replace(/^ال/, "")).replace(/ά/g, "α")).replace(/έ/g, "ε")).replace(/ή/g, "η")).replace(/ϊ/g, "ι")).replace(/ΐ/g, "ι")).replace(/ί/g, "ι")).replace(/ό/g, "ο")).replace(/ώ/g, "ω")).replace(/ύ/g, "υ")).replace(/ΰ/g, "υ")).replace(/ϋ/g, "υ")).replace(/ς/g, "σ")).replace(/अं/g, "अन्")).replace(/जं/g, "जन्")).replace(/फ़/g, "फ")).replace(/ज़/g, "ज")).replace(/सं/g, "सन्")).replace(/यां/g, "यान्")).replace(/रबड़/g, "रबर")).replace(/बां/g, "बाँ")).replace(/बूं/g, "बूँ")).replace(/’/g, "'")
    }
    function U() {
        var e, a, t, r = (Date.now() - f) / 1e3;
        if (m ? m = !1 : l && (2 < r - l || r - l < 0) && (f += 1e3 * (r - l - 1),
        r = (Date.now() - f) / 1e3),
        (l = r) < u && (s.phase = "PreMemo",
        e = u - r),
        u <= r && r < u + s.trial.memoTime && ("Memo" !== s.phase && (s.phase = "Memo",
        n && (i = setInterval(s.memoNext, 1e3 * n))),
        e = u + p - r),
        r >= u + s.trial.memoTime && r < u + p + v && ("PreRecall" !== s.phase && (s.phase = "PreRecall"),
        e = u + p + v - r),
        u + p + v <= r && r < u + p + v + h && ("Recall" !== s.phase && (s.phase = "Recall",
        s.showFinished = !1,
        o(function() {
            s.showFinished = !0
        }, 2e3),
        o(function() {
            $("#wordsRecall0").focus()
        })),
        e = u + p + v + h - r),
        u + p + v + h < r)
            return s.trial.recallTime || (s.trial.recallTime = h),
            s.phase = "Completed",
            s.showContinue = !1,
            o(function() {
                s.showContinue = !0
            }, 2e3),
            a = firebase.database().ref("pending").push({
                memoTime: s.trial.memoTime,
                recall: s.trial.recall,
                recallTime: s.trial.recallTime,
                requestType: "endTrain",
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                trialId: b,
                userId: firebase.auth().currentUser.uid
            }),
            void firebase.database().ref("pending/" + a.key + "/response").on("value", function(e) {
                (t = e.val()) && (firebase.database().ref("pending/" + a.key + "/response").off(),
                a.remove(),
                s.trial.score = t.score,
                t.targetReached && (s.message = t.message,
                $(".ui.modal.targetReached").modal("show")),
                s.$$phase || s.$apply())
            });
        s.timerMin = Math.floor(Math.round(e) / 60),
        r = Math.round(e) % 60,
        s.timerSec = (r < 10 ? "0" : "") + r,
        s.timerWarning = ("Memo" === s.phase || "Recall" === s.phase) && Math.round(e) < 10,
        g = o(U, 1e3)
    }
    t = 0,
    s.highLevel = 6,
    s.now = Date.now(),
    function e() {
        s.user ? (s.user.custom || (s.user.custom = {}),
        s.user.custom.Words || (s.user.custom.Words = {
            items: s.user.ratings && s.user.ratings.Words ? s.user.ratings.Words.items.toString() : "",
            maxMemoTime: "60",
            maxRecallTime: "240"
        }),
        s.user.custom.Words.maxRecallTime || (s.user.custom.Words.maxRecallTime = 240),
        void 0 === s.user.custom.Words.autoAdvanceTotal && (s.user.custom.Words.autoAdvanceTotal = ""),
        s.$$phase || s.$apply()) : s.showSignin ? (a.path("home"),
        s.$$phase || s.$apply()) : setTimeout(e, 1e3)
    }(),
    s.showInstructions = function() {
        $(".ui.modal.instructions").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    s.showLevels = function() {
        $(".ui.modal.levels").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    window.trainingType = window.trainingType || {},
    $(".menu .item").tab().tab("change tab", window.trainingType.Words || "standard").tab({
        onVisible: function(e) {
            window.trainingType.Words = e
        }
    }),
    $(".ui.checkbox").checkbox(),
    s.hideTimerClick = function() {
        s.prefs.wordsHideTimer = !s.prefs.wordsHideTimer
    }
    ,
    s.showPreferences = function() {
        r.user && (s.prefs = {
            prepTime: r.user.prefs.prepTime || "20s",
            wordsHideTimer: r.user.prefs.wordsHideTimer || !1,
            wordsLanguage: r.user.prefs.wordsLanguage,
            wordsGroups: r.user.prefs.wordsGroups
        },
        $(".ui.modal.preferences").modal("setting", {
            onApprove: w
        }).modal("show"))
    }
    ,
    s.start = function(t) {
        var e, a;
        if (u = r.user && r.user.prefs && r.user.prefs.prepTime ? parseInt(r.user.prefs.prepTime, 10) : 20,
        "custom" === t) {
            if (!(0 < (p = parseInt(s.user.custom.Words.maxMemoTime, 10)) && p <= 1800))
                return void alert("Maximum memorization time must be a number between 1 and 1800.");
            if (s.user.custom.Words.autoAdvanceTotal && "" !== s.user.custom.Words.autoAdvanceTotal && (!(c = parseFloat(s.user.custom.Words.autoAdvanceTotal.replace(",", "."))) || !(5 <= c && c <= p)))
                return void alert("Auto advance total time must be either:\n   (i) blank, or\n   (ii) between 5 seconds and the maximum memorization time.");
            if (!(0 < (h = parseInt(s.user.custom.Words.maxRecallTime, 10)) && h <= 1800))
                return void alert("Maximum recall time must be a number between 1 and 1800.")
        }
        "standard" === t && (p = 60,
        h = 240,
        n = 0),
        s.loading = !0,
        e = {
            eventName: "Words",
            requestType: "train",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        },
        "custom" === t && (e.custom = s.user.custom.Words),
        a = firebase.database().ref("pending").push(e),
        firebase.database().ref("pending/" + a.key + "/trialId").on("value", function(e) {
            (b = e.val()) && (firebase.database().ref("pending/" + a.key + "/trialId").off(),
            a.remove(),
            firebase.database().ref("trials/" + b).once("value", function(e, a) {
                s.trial = e.val(),
                "custom" === t && c && (n = c / s.trial.info.groups.length),
                s.loading = !1,
                f = Date.now(),
                U()
            }))
        })
    }
    ,
    s.stopMemo = function(e) {
        e = e || Date.now(),
        s.trial.memoTime = Math.round((e - f) / 10) / 100 - u,
        s.trial.memoTime > p && (s.trial.memoTime = p),
        n && Math.abs(s.trial.memoTime - c) < .05 && (s.trial.memoTime = Math.round(100 * c) / 100),
        s.stopAutoAdvance(),
        s.phase = "PreRecall",
        e = u + p + v - (e - f) / 1e3,
        s.timerMin = Math.floor(Math.round(e) / 60),
        e = Math.round(e) % 60,
        s.timerSec = (e < 10 ? "0" : "") + e,
        s.$$phase || s.$apply()
    }
    ,
    s.memoPrev = function() {
        0 < s.trial.memoCursor && y(s.trial.memoCursor - 1)
    }
    ,
    s.memoNext = function() {
        s.trial.memoCursor === s.trial.info.groups.length - 1 ? i ? s.stopMemo(Date.now()) : Date.now() - t < 500 ? s.stopMemo(t) : t = Date.now() : y(s.trial.memoCursor + 1),
        s.$$phase || s.$apply()
    }
    ,
    s.memoReturn = function() {
        y(0)
    }
    ,
    s.stopAutoAdvance = function() {
        i && (clearInterval(i),
        n = 0)
    }
    ,
    $(document).keydown(k),
    $(document).keyup(N),
    $(document).keypress(A),
    $(window).blur(S),
    $(window).focus(R),
    s.skip = function() {
        var e, a = (Date.now() - f) / 1e3;
        switch (s.phase) {
        case "PreMemo":
            e = u - a;
            break;
        case "Memo":
            e = u + p - a;
            break;
        case "PreRecall":
            e = u + p + v - a;
            break;
        case "Recall":
            e = u + p + v + h - a,
            s.trial.recallTime = a - u - p - v,
            s.phase = "Completed"
        }
        f -= 1e3 * e,
        l += e,
        o.cancel(g),
        U(),
        $(".skip").blur()
    }
    ,
    s.memoClass = function(e) {
        return "Memo" !== s.phase || e >= s.trial.memo.length ? "" : s.trial.info.words[e].groupNum === s.trial.memoCursor ? "wordsMemoMid" + s.trial.info.words[e].posInGroup : s.trial.info.words[e].groupNum > s.trial.memoCursor ? "wordsMemoRight" + (e - s.trial.info.groups[0].size) : "wordsMemoLeft" + e
    }
    ,
    s.setRecallCursor = function(e) {
        s.trial.recallCursor = e
    }
    ,
    s.isCorrect = function(e, a) {
        return !(!a || !e) && P(e.toLowerCase()) === P(a.toLowerCase())
    }
    ,
    s.isIncorrect = function(e, a) {
        return !(!a || !e) && P(e.toLowerCase()) !== P(a.toLowerCase())
    }
    ,
    s.continueClick = function() {
        e.reload()
    }
    ,
    s.badWords = [];
    for (var L = 0; L < 6; L += 1)
        s.badWords.push({
            num: "",
            word: "",
            english: "",
            comments: ""
        });
    function _() {
        for (var e, a = 0; a < 6; a += 1)
            s.badWords[a].word && (firebase.database().ref("badWords").push({
                comments: s.badWords[a].comments,
                english: s.badWords[a].english,
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                userId: firebase.auth().currentUser.uid,
                word: s.badWords[a].word,
                wordsLanguage: r.user.prefs.wordsLanguage
            }),
            e = !0);
        e && $(".ui.modal.thanks").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    s.badWordsClick = function() {
        $(".ui.modal.badWords").modal("setting", {
            onApprove: _
        }).modal("show")
    }
    ,
    s.$on("$locationChangeStart", function(e) {
        s.phase && "Completed" !== s.phase && (m = !0,
        confirm("Are you sure you want to exit the trial?") || e.preventDefault())
    }),
    s.$on("$destroy", function() {
        $(".ui.modal.instructions").remove(),
        $(".ui.modal.levels").remove(),
        $(".ui.modal.preferences").remove(),
        $(".ui.modal.targetReached").remove(),
        $(".ui.modal.badWords").remove(),
        $(".ui.modal.thanks").remove(),
        o.cancel(g),
        $(document).off("keydown", k),
        $(document).off("keyup", N),
        $(document).off("keypress", A),
        $(window).off("blur", S),
        $(window).off("focus", R)
    })
}
]),
angular.module("myApp.view-cards", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/view-cards/:matchId/:tableNum", {
        templateUrl: "view-cards/view-cards.html",
        controller: "ViewCardsCtrl"
    }),
    e.when("/view-cards/:matchId/:tableNum/:swap", {
        templateUrl: "view-cards/view-cards.html",
        controller: "ViewCardsCtrl"
    }),
    e.when("/view-cards/:matchId", {
        templateUrl: "view-cards/view-cards.html",
        controller: "ViewCardsCtrl"
    })
}
]).controller("ViewCardsCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(s, o, a, c, t) {
    window.myscope = c;
    var r, i, m, n, l, p, u, h = 20, d = 60, f = 10, g = 240;
    function b() {
        !c.match.restricted || "Finished" === c.match.competitors[0].status && "Finished" === c.match.competitors[1].status || c.user && c.user.viewRestricted || firebase.auth().currentUser && (firebase.auth().currentUser.uid === c.match.competitors[0].userId && "Finished" === c.match.competitors[0].status || firebase.auth().currentUser.uid === c.match.competitors[1].userId && "Finished" === c.match.competitors[1].status) || s.path("home")
    }
    function v(e, a) {
        var t, r, s, o, i;
        if (!c.match || !c.match.competitors || !c.match.competitors[a])
            return "";
        switch (s = c.match.competitors[a],
        t = (i = c.match.competitors[a].userId === firebase.auth().currentUser.uid) ? "You" : s.realName || s.name,
        i = i ? "you " : "",
        e) {
        case a:
            o = '<span class="won">' + t + " won!</span>",
            r = " &nbsp;And ";
            break;
        case 1 - a:
            o = '<span class="lost">' + t + " lost!</span>",
            r = " &nbsp;But ";
            break;
        case 2:
            o = '<span class="drew">' + t + " drew!</span>",
            r = " &nbsp;And "
        }
        return c.match.surprise || (s.newLevel && s.skippedLevel ? o += r + i + "jumped to level " + s.newLevel + "!" : s.newLevel ? o += r + i + "reached level " + s.newLevel + "!" : s.newPR ? o += r + i + "got a new personal record!" : s.newRecentBest && (o += r + i + "got a top 5 recent score!"),
        "rating" !== s.matchType && "league" !== s.matchType && "slam" !== s.matchType || (o += '<span class="ratingWord">Rating:</span>',
        s.ratingChange < 0 && (o += '<span class="lost">' + s.ratingChange + "</span>"),
        0 === s.ratingChange && (o += "+0"),
        0 < s.ratingChange && (o += '<span class="won">+' + s.ratingChange + "</span>"),
        o += '<span class="ratingArrow">&rarr;</span>',
        o += '<span class="ui red horizontal label">' + (s.rating + s.ratingChange) + "</span>")),
        o
    }
    function w() {
        var e = (Date.now() - p) / 1e3 - n;
        e < h && (c.phase = "PreMemo",
        l = h - e),
        h <= e && e < h + d && (c.phase = "Memo",
        l = h + d - e),
        h + d <= e && e < h + d + f && (c.phase = "PreRecall",
        l = h + d + f - e),
        h + d + f <= e && e < h + d + f + g && (c.phase = "Recall",
        l = h + d + f + g - e),
        h + d + f + g < e || c.match.endTime ? c.phase = "Completed" : (c.timerMin = Math.floor(Math.round(l) / 60),
        e = Math.round(l) % 60,
        c.timerSec = (e < 10 ? "0" : "") + e,
        c.timerWarning = ("Memo" === c.phase || "Recall" === c.phase) && Math.round(l) < 10,
        u = t(w, 1e3))
    }
    i = o.matchId,
    n = 0,
    c.secMemo = d,
    c.comments = [],
    c.competitorData = {},
    c.countryNames = countryNames,
    c.modalId = "m" + (new Date).getTime(),
    c.now = new Date,
    m = [10, 11, 12, 23, 24, 25, 36, 37, 38, 49, 50, 51],
    c.ringOffset = [0, 0],
    c.site = window.site,
    c.zoomed = [!1, !1],
    function e() {
        c.user || c.showSignin ? r && b() : setTimeout(e, 1e3)
    }(),
    c.competitorClick = function(e, a, t, r) {
        var s, o;
        $(".ui.modal.competitorModal").modal("show"),
        c.competitorData = {
            competeName: t,
            flag: r,
            id: e,
            name: a
        },
        c.competitorLoading = !0,
        c.$$phase || c.$apply(),
        o = s = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            c.competitorData.ratings = e.val(),
            s = !0,
            o && (c.competitorLoading = !1,
            c.$$phase || c.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            c.competitorData.recentBest = e.val(),
            o = !0,
            s && (c.competitorLoading = !1,
            c.$$phase || c.$apply())
        })
    }
    ,
    c.challenge = function(e) {
        s.path("/compete/" + e + "/" + encodeURIComponent(c.competitorData.competeName))
    }
    ,
    c.resultsMessage = function() {
        var e;
        if (c.match && c.match.competitors)
            return e = v(e = c.winner(), c.a) + "<br>" + v(e, c.b),
            a.trustAsHtml(e)
    }
    ,
    firebase.database().ref("matches/" + i).on("value", function(e) {
        c.match = e.val(),
        r || (r = !0,
        (c.user || c.showSignin) && b(),
        "slam" === c.match.competitors[0].matchType && c.match.title && (c.slamMatch = !0),
        c.match.championshipId && (firebase.database().ref("championships/" + c.match.championshipId + "/commonConfig/title").on("value", function(e) {
            c.championshipTitle = e.val() || "",
            c.$$phase || c.$apply()
        }),
        firebase.database().ref("championships/" + c.match.championshipId + "/matchesSummary/" + c.match.matchKey).on("value", function(e) {
            c.matchSummary = e.val() || {},
            c.$$phase || c.$apply()
        }),
        o.tableNum && firebase.database().ref("championships/" + c.match.championshipId + "/matchesSummary").on("value", function(e) {
            for (var a = e.val() || {}, t = Object.keys(a), r = 0; r < t.length; r++)
                t[r] !== c.match.matchKey && a[t[r]].open && a[t[r]].tableNum === o.tableNum && a[t[r]].matchUrl && (s.path(a[t[r]].matchUrl.replace("compete", "view") + "/" + o.tableNum),
                c.$$phase || c.$apply()),
                t[r] === c.match.matchKey && "Not Started" === a[t[r]].status && (o.swap ? s.path("view-table/" + c.match.championshipId + "/" + o.tableNum + "/swap") : s.path("view-table/" + c.match.championshipId + "/" + o.tableNum),
                c.$$phase || c.$apply())
        }),
        "remote" !== c.match.championshipId.substring(0, 6) && "japan2020" !== c.match.championshipId && (n = 0)),
        c.match.arena2020 && (c.championshipTitle = "Arena of Memory"),
        c.isCompetitor = c.match.competitors[0].userId === firebase.auth().currentUser.uid || c.match.competitors[1].userId === firebase.auth().currentUser.uid,
        c.match.solo ? c.a = 0 : ((c.match.competitors[0].realName || c.match.competitors[0].name).toLowerCase() < (c.match.competitors[1].realName || c.match.competitors[1].name).toLowerCase() ? c.a = 0 : c.a = 1,
        !o.tableNum || "swap" !== o.tableNum.toLowerCase() && "swop" !== o.tableNum.toLowerCase() || (c.a = 1 - c.a)),
        c.b = 1 - c.a,
        c.match.endTime ? c.phase = "Completed" : c.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            p = c.match.startTime - e,
            w()
        }) : (c.phase = "Splash",
        firebase.database().ref("matches/" + i + "/startTime").on("value", function(e) {
            e.val() && (p = Date.now(),
            w())
        })),
        $(".competitorPopupController").popup({
            on: "click"
        })),
        c.match.ring && function() {
            var e, a, t, r, s, o, i;
            for (e = 0; e < 2; e++)
                for (r = c.match.competitors[e].memo,
                o = c.match.competitors[e].recall,
                s = t = 0; s < 25; s++) {
                    for (a = i = 0; a < 52; a++)
                        o[a] < 52 && (o[a] + s) % 25 === r[a] && (i += 1);
                    t < i && (t = i,
                    c.ringOffset[e] = s)
                }
            c.$$phase || c.$apply()
        }(),
        c.$$phase || c.$apply()
    }),
    firebase.database().ref("matchComments/" + i).on("child_added", function(e) {
        var a = document.getElementById("comments");
        c.comments.push(e.val()),
        a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
            a.scrollTop = a.scrollHeight
        }, 0),
        c.$$phase || c.$apply()
    }),
    c.memoClassPosition = function(e, a) {
        var t;
        return "Memo" === c.phase && c.match && c.match.competitors ? ((e = c.match.competitors[e]).info.cards[a].groupNum === e.memoCursor ? (t = "cardsMemoPos" + e.info.cards[a].posInGroup,
        "compact" === e.info.cardsSpacing && (t += "Compact")) : t = "cardsMemoPos" + (52 + e.memo[a] - e.info.groups[e.memoCursor].start - e.info.groups[e.memoCursor].size),
        t) : ""
    }
    ,
    c.memoClassCard = function(e, a) {
        var t, r;
        if ("Memo" !== c.phase || !c.match || !c.match.competitors)
            return "";
        switch (c.match.competitors[e].cardsStyle) {
        case "Arabic":
            t = c.match.single ? "cardsMemo_a card" + a % 13 + "_a" : c.match.red ? ((r = a) < 13 && (r += 13),
            39 <= r && (r -= 13),
            "cardsMemo_a card" + r + "_a") : c.match.aoo2022s2 ? 1 === a || 24 === a || 32 === a || 47 === a || 51 === a ? "cardsMemo_a card" + a + "_a" : "cardsMemo_a card21_a" : c.match.pictureCards ? "cardsMemo_a card" + m[a % 12] + "_a" : "cardsMemo_a card" + a + "_a";
            break;
        case "English":
            t = c.match.single ? "cardsMemo_e card" + a % 13 + "_e" : c.match.red ? ((r = a) < 13 && (r += 13),
            39 <= r && (r -= 13),
            "cardsMemo_e card" + r + "_e") : c.match.aoo2022s2 ? 1 === a || 24 === a || 32 === a || 47 === a || 51 === a ? "cardsMemo_e card" + a + "_e" : "cardsMemo_e card21_e" : c.match.pictureCards ? "cardsMemo_e card" + m[a % 12] + "_e" : "cardsMemo_e card" + a + "_e";
            break;
        case "FourColor":
            t = c.match.single ? "cardsMemo_f card" + a % 13 + "_f" : c.match.red ? ((r = a) < 13 && (r += 13),
            39 <= r && (r -= 13),
            "cardsMemo_f card" + r + "_f") : c.match.aoo2022s2 ? 1 === a || 24 === a || 32 === a || 47 === a || 51 === a ? "cardsMemo_f card" + a + "_f" : "cardsMemo_f card21_f" : c.match.pictureCards ? "cardsMemo_f card" + m[a % 12] + "_f" : "cardsMemo_f card" + a + "_f";
            break;
        case "German":
            t = c.match.single ? "cardsMemo_g card" + a % 13 + "_g" : c.match.red ? ((r = a) < 13 && (r += 13),
            39 <= r && (r -= 13),
            "cardsMemo_g card" + r + "_g") : c.match.aoo2022s2 ? 1 === a || 24 === a || 32 === a || 47 === a || 51 === a ? "cardsMemo_g card" + a + "_g" : "cardsMemo_g card21_g" : c.match.pictureCards ? "cardsMemo_g card" + m[a % 12] + "_g" : "cardsMemo_g card" + a + "_g";
            break;
        case "Swapped":
            t = "cardsMemo_s card" + a + "_s"
        }
        return c.match.shake && (t += " cardShake" + a),
        t
    }
    ,
    c.boxWidth = function(e) {
        var a;
        if ("Recall" !== c.phase && "Completed" !== c.phase || !c.match || !c.match.competitors)
            return "";
        switch (c.match.competitors[e].cardsStyle) {
        case "Arabic":
            a = "cardsBoxWidth_a";
            break;
        case "English":
            a = "cardsBoxWidth_e";
            break;
        case "FourColor":
            a = "cardsBoxWidth_f";
            break;
        case "German":
            a = "cardsBoxWidth_g";
            break;
        case "Swapped":
            a = "cardsBoxWidth_s"
        }
        return a
    }
    ,
    c.recallClass = function(e, a) {
        var t, r, s, o, i, n;
        if ("Recall" !== c.phase && "Completed" !== c.phase)
            return "";
        switch (c.match.competitors[e].cardsStyle) {
        case "Arabic":
            t = c.match.single ? "cardsRecallView_a card" + a % 13 + "_a" : c.match.red ? ((r = a) < 13 && (r += 13),
            39 <= r && (r -= 13),
            "cardsRecallView_a card" + r + "_a") : c.match.aoo2022s2 ? 1 === a || 24 === a || 32 === a || 47 === a || 51 === a ? "cardsRecallView_a card" + a + "_a" : "cardsRecallView_a card21_a" : c.match.pictureCards ? "cardsRecallView_a card" + m[a % 12] + "_a" : "cardsRecallView_a card" + a + "_a";
            break;
        case "English":
            t = c.match.single ? "cardsRecallView_e card" + a % 13 + "_e" : c.match.red ? ((r = a) < 13 && (r += 13),
            39 <= r && (r -= 13),
            "cardsRecallView_e card" + r + "_e") : c.match.aoo2022s2 ? 1 === a || 24 === a || 32 === a || 47 === a || 51 === a ? "cardsRecallView_e card" + a + "_e" : "cardsRecallView_e card21_e" : c.match.pictureCards ? "cardsRecallView_e card" + m[a % 12] + "_e" : "cardsRecallView_e card" + a + "_e";
            break;
        case "FourColor":
            t = c.match.single ? "cardsRecallView_f card" + a % 13 + "_f" : c.match.red ? ((r = a) < 13 && (r += 13),
            39 <= r && (r -= 13),
            "cardsRecallView_f card" + r + "_f") : c.match.aoo2022s2 ? 1 === a || 24 === a || 32 === a || 47 === a || 51 === a ? "cardsRecallView_f card" + a + "_f" : "cardsRecallView_f card21_f" : c.match.pictureCards ? "cardsRecallView_f card" + m[a % 12] + "_f" : "cardsRecallView_f card" + a + "_f";
            break;
        case "German":
            t = c.match.single ? "cardsRecallView_g card" + a % 13 + "_g" : c.match.red ? ((r = a) < 13 && (r += 13),
            39 <= r && (r -= 13),
            "cardsRecallView_g card" + r + "_g") : c.match.aoo2022s2 ? 1 === a || 24 === a || 32 === a || 47 === a || 51 === a ? "cardsRecallView_g card" + a + "_g" : "cardsRecallView_g card21_g" : c.match.pictureCards ? "cardsRecallView_g card" + m[a % 12] + "_g" : "cardsRecallView_g card" + a + "_g";
            break;
        case "Swapped":
            t = "cardsRecallView_s card" + a + "_s"
        }
        return t += " " + (s = e,
        o = a,
        51 < c.match.competitors[s].recall[o] ? "" : c.match.single ? (i = o % 13,
        c.match.competitors[s].recall[o] === c.match.competitors[s].memo[i] || c.match.competitors[s].recall[o] === c.match.competitors[s].memo[13 + i] || c.match.competitors[s].recall[o] === c.match.competitors[s].memo[26 + i] || c.match.competitors[s].recall[o] === c.match.competitors[s].memo[39 + i] ? "cardsCorrect" : "cardsIncorrect") : c.match.red ? (o < 13 && (n = o + 13),
        13 <= o && o < 26 && (n = o - 13),
        26 <= o && o < 39 && (n = o + 13),
        39 <= o && (n = o - 13),
        c.match.competitors[s].recall[o] === c.match.competitors[s].memo[o] || c.match.competitors[s].recall[o] === c.match.competitors[s].memo[n] ? "cardsCorrect" : "cardsIncorrect") : c.match.aoo2022s2 && 1 !== o && 24 !== o && 32 !== o && 47 !== o && 51 !== o ? c.match.competitors[s].recall[o] !== c.match.competitors[s].memo[1] && c.match.competitors[s].recall[o] !== c.match.competitors[s].memo[24] && c.match.competitors[s].recall[o] !== c.match.competitors[s].memo[32] && c.match.competitors[s].recall[o] !== c.match.competitors[s].memo[47] && c.match.competitors[s].recall[o] !== c.match.competitors[s].memo[51] ? "cardsCorrect" : "cardsIncorrect" : c.match.ring ? c.match.competitors[s].memo[o] === (c.match.competitors[s].recall[o] + c.ringOffset[s]) % 25 ? "cardsCorrect" : "cardsIncorrect" : c.match.pictureCards ? c.match.competitors[s].recall[o] === c.match.competitors[s].memo[o % 12] || c.match.competitors[s].recall[o] === c.match.competitors[s].memo[o % 12 + 12] || c.match.competitors[s].recall[o] === c.match.competitors[s].memo[o % 12 + 24] || c.match.competitors[s].recall[o] === c.match.competitors[s].memo[o % 12 + 36] || c.match.competitors[s].recall[o] === c.match.competitors[s].memo[o % 12 + 48] ? "cardsCorrect" : "cardsIncorrect" : c.match.competitors[s].memo[o] === c.match.competitors[s].recall[o] ? "cardsCorrect" : "cardsIncorrect"),
        t += " cardsRecallPos" + c.match.competitors[e].recall[a],
        c.match.shake && (t += " cardShake" + a),
        t
    }
    ,
    c.originalCard = function(e, a) {
        var t, r, s;
        if ("Recall" !== c.phase && "Completed" !== c.phase)
            return "";
        for (t = 0; t < 52; t += 1)
            if (c.match.ring) {
                if (c.match.competitors[e].memo[t] === (a + c.ringOffset[e]) % 25)
                    break
            } else if (c.match.competitors[e].memo[t] === a)
                break;
        return c.match.pictureCards && (t = m[t % 12]),
        r = 12 < t ? "♦" : "♣",
        25 < t && (r = "♥"),
        38 < t && (r = "♠"),
        c.match.single && (r = "♣"),
        c.match.red && ("♣" === r && (r = "♦"),
        "♠" === r && (r = "♥")),
        1 === (s = t % 13 + 1) && (s = "A"),
        11 === s && (s = "German" === c.match.competitors[e].cardsStyle ? "B" : "J"),
        12 === s && (s = "German" === c.match.competitors[e].cardsStyle ? "D" : "Q"),
        13 === s && (s = "K"),
        c.match.aoo2022s2 && 1 !== t && 24 !== t && 32 !== t && 47 !== t && 51 !== t && (s = 9,
        r = "D"),
        s + r
    }
    ,
    c.originalCardColor = function(e, a) {
        var t;
        if ("Recall" !== c.phase && "Completed" !== c.phase)
            return "";
        for (t = 0; t < 52; t++)
            if (c.match.ring) {
                if (c.match.competitors[e].memo[t] === (a + c.ringOffset[e]) % 25)
                    break
            } else if (c.match.competitors[e].memo[t] === a)
                break;
        return c.match.single ? "cardsBlack" : c.match.red ? "FourColor" === c.match.competitors[e].cardsStyle && t < 26 ? "cardsBlue" : "cardsRed" : c.match.aoo2022s2 && 1 !== t && 24 !== t && 32 !== t && 47 !== t && 51 !== t ? "FourColor" === c.match.competitors[e].cardsStyle ? "cardsBlue" : "cardsRed" : (c.match.pictureCards && (t = m[t % 12]),
        "FourColor" === c.match.competitors[e].cardsStyle ? t < 13 ? "cardsGreen" : t < 26 ? "cardsBlue" : t < 39 ? "cardsRed" : "cardsBlack" : "Swapped" === c.match.competitors[e].cardsStyle ? 12 < t && t < 39 ? "cardsBlack" : "cardsRed" : 12 < t && t < 39 ? "cardsRed" : "cardsBlack")
    }
    ,
    c.winner = function() {
        return c.match && c.match.competitors ? "rating" === c.match.competitors[0].matchType || "league" === c.match.competitors[0].matchType || "slam" === c.match.competitors[0].matchType ? 100 * c.match.competitors[0].score - c.match.competitors[0].memoTime > 100 * c.match.competitors[1].score - c.match.competitors[1].memoTime ? 0 : 100 * c.match.competitors[0].score - c.match.competitors[0].memoTime < 100 * c.match.competitors[1].score - c.match.competitors[1].memoTime ? 1 : 2 : c.match.competitors[0].score / c.match.competitors[0].items * 1e4 - c.match.competitors[0].memoTime > c.match.competitors[1].score / c.match.competitors[1].items * 1e4 - c.match.competitors[1].memoTime ? 0 : c.match.competitors[0].score / c.match.competitors[0].items * 1e4 - c.match.competitors[0].memoTime < c.match.competitors[1].score / c.match.competitors[1].items * 1e4 - c.match.competitors[1].memoTime ? 1 : 2 : ""
    }
    ,
    c.sendClick = function() {
        var e;
        c.comment.trim() && (e = {
            author: c.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: c.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        },
        c.match.competitors[0].userId === firebase.auth().currentUser.uid && c.match.competitors[0].realName && c.match.competitors[0].realName !== c.user.displayName && (e.author = c.match.competitors[0].realName,
        e.competeName = c.user.displayName),
        c.match.competitors[1].userId === firebase.auth().currentUser.uid && c.match.competitors[1].realName && c.match.competitors[1].realName !== c.user.displayName && (e.author = c.match.competitors[1].realName,
        e.competeName = c.user.displayName),
        c.user.flag && (e.flag = c.user.flag),
        firebase.database().ref("matchComments/" + i).push(e),
        "random" === c.comment.substring(0, 6).toLowerCase() && 9 < c.comment.length && firebase.database().ref("pending").push({
            comment: c.comment,
            matchId: i,
            requestType: "random",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        c.comment = "",
        c.$$phase || c.$apply())
    }
    ,
    c.zoomClick = function(e, a, t) {
        var r;
        c.zoomed[e] = !c.zoomed[e],
        c.zoomed[e] ? ((r = .7 * (a.pageX - $("#" + t).offset().left) / .3776 - 181.5) < 0 && (r = 0),
        (t = .7 * (a.pageY - $("#" + t).offset().top) / .3776 - 104.5) < 0 && (t = 0),
        310 < r && (r = 310),
        180 < t && (t = 180),
        c["transform" + e] = "translate(-" + r + "px,-" + t + "px) scale(0.7)") : c["transform" + e] = ""
    }
    ,
    c.$on("$destroy", function() {
        t.cancel(u),
        c.match && c.match.championshipId && firebase.database().ref("championships/" + c.match.championshipId + "/matchesSummary").off(),
        firebase.database().ref("matches/" + i).off(),
        firebase.database().ref("matchComments/" + i).off(),
        $(".ui.modal.competitorModal." + c.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + c.modalId).remove()
    })
}
]),
angular.module("myApp.view-images", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/view-images/:matchId/:tableNum", {
        templateUrl: "view-images/view-images.html",
        controller: "ViewImagesCtrl"
    }),
    e.when("/view-images/:matchId/:tableNum/:swap", {
        templateUrl: "view-images/view-images.html",
        controller: "ViewImagesCtrl"
    }),
    e.when("/view-images/:matchId", {
        templateUrl: "view-images/view-images.html",
        controller: "ViewImagesCtrl"
    })
}
]).controller("ViewImagesCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(s, o, a, n, t) {
    window.myscope = n;
    var r, i, c, m, l, p, u = 20, h = 60, d = 10, f = 240;
    function g() {
        !n.match.restricted || "Finished" === n.match.competitors[0].status && "Finished" === n.match.competitors[1].status || n.user && n.user.viewRestricted || firebase.auth().currentUser && (firebase.auth().currentUser.uid === n.match.competitors[0].userId && "Finished" === n.match.competitors[0].status || firebase.auth().currentUser.uid === n.match.competitors[1].userId && "Finished" === n.match.competitors[1].status) || s.path("home")
    }
    function b() {
        var e, a;
        for (r = !0,
        (n.user || n.showSignin) && g(),
        "slam" === n.match.competitors[0].matchType && n.match.title && (n.slamMatch = !0),
        n.match.championshipId && (firebase.database().ref("championships/" + n.match.championshipId + "/commonConfig/title").on("value", function(e) {
            n.championshipTitle = e.val() || "",
            n.$$phase || n.$apply()
        }),
        firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary/" + n.match.matchKey).on("value", function(e) {
            n.matchSummary = e.val() || {},
            n.$$phase || n.$apply()
        }),
        o.tableNum && firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary").on("value", function(e) {
            for (var a = e.val() || {}, t = Object.keys(a), r = 0; r < t.length; r++)
                t[r] !== n.match.matchKey && a[t[r]].open && a[t[r]].tableNum === o.tableNum && a[t[r]].matchUrl && (s.path(a[t[r]].matchUrl.replace("compete", "view") + "/" + o.tableNum),
                n.$$phase || n.$apply()),
                t[r] === n.match.matchKey && "Not Started" === a[t[r]].status && (o.swap ? s.path("view-table/" + n.match.championshipId + "/" + o.tableNum + "/swap") : s.path("view-table/" + n.match.championshipId + "/" + o.tableNum),
                n.$$phase || n.$apply())
        }),
        "remote" !== n.match.championshipId.substring(0, 6) && "japan2020" !== n.match.championshipId && (c = 0)),
        n.match.arena2020 && (n.championshipTitle = "Arena of Memory"),
        n.isCompetitor = n.match.competitors[0].userId === firebase.auth().currentUser.uid || n.match.competitors[1].userId === firebase.auth().currentUser.uid,
        n.match.solo ? n.a = 0 : ((n.match.competitors[0].realName || n.match.competitors[0].name).toLowerCase() < (n.match.competitors[1].realName || n.match.competitors[1].name).toLowerCase() ? n.a = 0 : n.a = 1,
        !o.tableNum || "swap" !== o.tableNum.toLowerCase() && "swop" !== o.tableNum.toLowerCase() || (n.a = 1 - n.a)),
        n.b = 1 - n.a,
        e = 0; e < 2; e++)
            for (a = 0; a < n.match.competitors[e].memo.length; a++)
                !function(a, t) {
                    firebase.storage().ref("images/" + n.match.competitors[a].memo[t]).getDownloadURL().then(function(e) {
                        n.urls[n.match.competitors[a].memo[t]] = e,
                        n.$$phase || n.$apply()
                    })
                }(e, a);
        n.match.endTime ? n.phase = "Completed" : n.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            l = n.match.startTime - e,
            w()
        }) : (n.phase = "Splash",
        firebase.database().ref("matches/" + i + "/startTime").on("value", function(e) {
            e.val() && (l = Date.now(),
            w())
        })),
        $(".competitorPopupController").popup({
            on: "click"
        })
    }
    function v(e, a) {
        var t, r, s, o, i;
        if (!n.match || !n.match.competitors || !n.match.competitors[a])
            return "";
        switch (s = n.match.competitors[a],
        t = (i = n.match.competitors[a].userId === firebase.auth().currentUser.uid) ? "You" : s.realName || s.name,
        i = i ? "you " : "",
        e) {
        case a:
            o = '<span class="won">' + t + " won!</span>",
            r = " &nbsp;And ";
            break;
        case 1 - a:
            o = '<span class="lost">' + t + " lost!</span>",
            r = " &nbsp;But ";
            break;
        case 2:
            o = '<span class="drew">' + t + " drew!</span>",
            r = " &nbsp;And "
        }
        return n.match.surprise || (s.newLevel && s.skippedLevel ? o += r + i + "jumped to level " + s.newLevel + "!" : s.newLevel ? o += r + i + "reached level " + s.newLevel + "!" : s.newPR ? o += r + i + "got a new personal record!" : s.newRecentBest && (o += r + i + "got a top 5 recent score!"),
        "rating" !== s.matchType && "league" !== s.matchType && "slam" !== s.matchType || (o += '<span class="ratingWord">Rating:</span>',
        s.ratingChange < 0 && (o += '<span class="lost">' + s.ratingChange + "</span>"),
        0 === s.ratingChange && (o += "+0"),
        0 < s.ratingChange && (o += '<span class="won">+' + s.ratingChange + "</span>"),
        o += '<span class="ratingArrow">&rarr;</span>',
        o += '<span class="ui yellow horizontal label">' + (s.rating + s.ratingChange) + "</span>")),
        o
    }
    function w() {
        var e = (Date.now() - l) / 1e3 - c;
        e < u && (n.phase = "PreMemo",
        m = u - e),
        u <= e && e < u + h && (n.phase = "Memo",
        m = u + h - e),
        u + h <= e && e < u + h + d && (n.phase = "PreRecall",
        m = u + h + d - e),
        u + h + d <= e && e < u + h + d + f && (n.phase = "Recall",
        m = u + h + d + f - e),
        u + h + d + f < e || n.match.endTime ? n.phase = "Completed" : (n.timerMin = Math.floor(Math.round(m) / 60),
        e = Math.round(m) % 60,
        n.timerSec = (e < 10 ? "0" : "") + e,
        n.timerWarning = ("Memo" === n.phase || "Recall" === n.phase) && Math.round(m) < 10,
        p = t(w, 1e3))
    }
    i = o.matchId,
    c = 0,
    n.secMemo = h,
    n.comments = [],
    n.competitorData = {},
    n.countryNames = countryNames,
    n.modalId = "m" + (new Date).getTime(),
    n.now = new Date,
    n.site = window.site,
    n.urls = {},
    n.zoomed = [!1, !1],
    function e() {
        n.user || n.showSignin ? r && g() : setTimeout(e, 1e3)
    }(),
    n.competitorClick = function(e, a, t, r) {
        var s, o;
        $(".ui.modal.competitorModal").modal("show"),
        n.competitorData = {
            competeName: t,
            flag: r,
            id: e,
            name: a
        },
        n.competitorLoading = !0,
        n.$$phase || n.$apply(),
        o = s = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            n.competitorData.ratings = e.val(),
            s = !0,
            o && (n.competitorLoading = !1,
            n.$$phase || n.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            n.competitorData.recentBest = e.val(),
            o = !0,
            s && (n.competitorLoading = !1,
            n.$$phase || n.$apply())
        })
    }
    ,
    n.challenge = function(e) {
        s.path("/compete/" + e + "/" + encodeURIComponent(n.competitorData.competeName))
    }
    ,
    n.memoClass = function(e, a) {
        return "Memo" !== n.phase ? "" : n.match.competitors[e].info ? n.match.competitors[e].info.images[a].groupNum === n.match.competitors[e].memoCursor ? "imagesMemoMid" + n.match.competitors[e].info.images[a].posInGroup : n.match.competitors[e].info.images[a].groupNum > n.match.competitors[e].memoCursor ? "imagesMemoRight" + (a - n.match.competitors[e].info.groups[0].size) : "imagesMemoLeft" + a : a === n.match.competitors[e].memoCursor ? "imagesMemoMid1Of1" : a > n.match.competitors[e].memoCursor ? "imagesMemoRight" + (a - 1) : "imagesMemoLeft" + a
    }
    ,
    n.resultsMessage = function() {
        var e;
        if (n.match && n.match.competitors)
            return e = v(e = n.winner(), n.a) + "<br>" + v(e, n.b),
            a.trustAsHtml(e)
    }
    ,
    n.spinClass = function(e) {
        return n.match && n.match.spin ? n.match.spinClasses[e] : ""
    }
    ,
    n.imageRecalled = function(e, a) {
        var t;
        if (!n.match || !n.match.spin)
            return !1;
        for (t = 0; t < n.match.competitors[e].memo.length; t++)
            if (n.match.competitors[e].recall[t] === a)
                return !0;
        return !1
    }
    ,
    firebase.database().ref("matches/" + i).on("value", function(e) {
        n.match = e.val(),
        r || b(),
        n.$$phase || n.$apply()
    }),
    firebase.database().ref("matchComments/" + i).on("child_added", function(e) {
        var a = document.getElementById("comments");
        n.comments.push(e.val()),
        a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
            a.scrollTop = a.scrollHeight
        }, 0),
        n.$$phase || n.$apply()
    }),
    n.winner = function() {
        return n.match && n.match.competitors ? "rating" === n.match.competitors[0].matchType || "league" === n.match.competitors[0].matchType || "slam" === n.match.competitors[0].matchType ? 100 * n.match.competitors[0].score - n.match.competitors[0].memoTime > 100 * n.match.competitors[1].score - n.match.competitors[1].memoTime ? 0 : 100 * n.match.competitors[0].score - n.match.competitors[0].memoTime < 100 * n.match.competitors[1].score - n.match.competitors[1].memoTime ? 1 : 2 : n.match.competitors[0].score / n.match.competitors[0].memo.length * 1e4 - n.match.competitors[0].memoTime > n.match.competitors[1].score / n.match.competitors[1].memo.length * 1e4 - n.match.competitors[1].memoTime ? 0 : n.match.competitors[0].score / n.match.competitors[0].memo.length * 1e4 - n.match.competitors[0].memoTime < n.match.competitors[1].score / n.match.competitors[1].memo.length * 1e4 - n.match.competitors[1].memoTime ? 1 : 2 : ""
    }
    ,
    n.sendClick = function() {
        var e;
        n.comment.trim() && (e = {
            author: n.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: n.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        },
        n.match.competitors[0].userId === firebase.auth().currentUser.uid && n.match.competitors[0].realName && n.match.competitors[0].realName !== n.user.displayName && (e.author = n.match.competitors[0].realName,
        e.competeName = n.user.displayName),
        n.match.competitors[1].userId === firebase.auth().currentUser.uid && n.match.competitors[1].realName && n.match.competitors[1].realName !== n.user.displayName && (e.author = n.match.competitors[1].realName,
        e.competeName = n.user.displayName),
        n.user.flag && (e.flag = n.user.flag),
        firebase.database().ref("matchComments/" + i).push(e),
        "random" === n.comment.substring(0, 6).toLowerCase() && 9 < n.comment.length && firebase.database().ref("pending").push({
            comment: n.comment,
            matchId: i,
            requestType: "random",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        n.comment = "",
        n.$$phase || n.$apply())
    }
    ,
    n.zoomClick = function(e, a, t) {
        var r;
        n.zoomed[e] = !n.zoomed[e],
        n.zoomed[e] ? ((r = .7 * (a.pageX - $("#" + t).offset().left) / .3776 - 181.5) < 0 && (r = 0),
        (t = .7 * (a.pageY - $("#" + t).offset().top) / .3776 - 104.5) < 0 && (t = 0),
        310 < r && (r = 310),
        180 < t && (t = 180),
        n["transform" + e] = "translate(-" + r + "px,-" + t + "px) scale(0.7)") : n["transform" + e] = ""
    }
    ,
    n.$on("$destroy", function() {
        t.cancel(p),
        n.match && n.match.championshipId && firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary").off(),
        firebase.database().ref("matches/" + i).off(),
        firebase.database().ref("matchComments/" + i).off(),
        $(".ui.modal.competitorModal." + n.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + n.modalId).remove()
    })
}
]),
angular.module("myApp.view-international", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/view-international/:matchId/:tableNum", {
        templateUrl: "view-international/view-international.html",
        controller: "ViewInternationalCtrl"
    }),
    e.when("/view-international/:matchId/:tableNum/:swap", {
        templateUrl: "view-international/view-international.html",
        controller: "ViewInternationalCtrl"
    }),
    e.when("/view-international/:matchId", {
        templateUrl: "view-international/view-international.html",
        controller: "ViewInternationalCtrl"
    })
}
]).controller("ViewInternationalCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(s, o, a, n, t) {
    window.myscope = n;
    var r, i, c, m, l, p, u = 20, h = 60, d = 10, f = 240;
    function g() {
        !n.match.restricted || "Finished" === n.match.competitors[0].status && "Finished" === n.match.competitors[1].status || n.user && n.user.viewRestricted || firebase.auth().currentUser && (firebase.auth().currentUser.uid === n.match.competitors[0].userId && "Finished" === n.match.competitors[0].status || firebase.auth().currentUser.uid === n.match.competitors[1].userId && "Finished" === n.match.competitors[1].status) || s.path("home")
    }
    function b() {
        var e, a;
        for (r = !0,
        (n.user || n.showSignin) && g(),
        "slam" === n.match.competitors[0].matchType && n.match.title && (n.slamMatch = !0),
        n.match.championshipId && (firebase.database().ref("championships/" + n.match.championshipId + "/commonConfig/title").on("value", function(e) {
            n.championshipTitle = e.val() || "",
            n.$$phase || n.$apply()
        }),
        firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary/" + n.match.matchKey).on("value", function(e) {
            n.matchSummary = e.val() || {},
            n.$$phase || n.$apply()
        }),
        o.tableNum && firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary").on("value", function(e) {
            for (var a = e.val() || {}, t = Object.keys(a), r = 0; r < t.length; r++)
                t[r] !== n.match.matchKey && a[t[r]].open && a[t[r]].tableNum === o.tableNum && a[t[r]].matchUrl && (s.path(a[t[r]].matchUrl.replace("compete", "view") + "/" + o.tableNum),
                n.$$phase || n.$apply()),
                t[r] === n.match.matchKey && "Not Started" === a[t[r]].status && (o.swap ? s.path("view-table/" + n.match.championshipId + "/" + o.tableNum + "/swap") : s.path("view-table/" + n.match.championshipId + "/" + o.tableNum),
                n.$$phase || n.$apply())
        }),
        "remote" !== n.match.championshipId.substring(0, 6) && "japan2020" !== n.match.championshipId && (c = 0)),
        n.match.arena2020 && (n.championshipTitle = "Arena of Memory"),
        n.isCompetitor = n.match.competitors[0].userId === firebase.auth().currentUser.uid || n.match.competitors[1].userId === firebase.auth().currentUser.uid,
        n.match.solo ? n.a = 0 : ((n.match.competitors[0].realName || n.match.competitors[0].name).toLowerCase() < (n.match.competitors[1].realName || n.match.competitors[1].name).toLowerCase() ? n.a = 0 : n.a = 1,
        !o.tableNum || "swap" !== o.tableNum.toLowerCase() && "swop" !== o.tableNum.toLowerCase() || (n.a = 1 - n.a)),
        n.b = 1 - n.a,
        e = 0; e < 2; e++)
            for (a = 0; a < n.match.competitors[e].memo.length; a++)
                !function(a, t) {
                    firebase.storage().ref("names/" + n.match.competitors[a].memo[t].photo).getDownloadURL().then(function(e) {
                        n.urls[n.match.competitors[a].memo[t].photo] = e,
                        n.$$phase || n.$apply()
                    })
                }(e, a);
        n.match.endTime ? n.phase = "Completed" : n.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            l = n.match.startTime - e,
            y()
        }) : (n.phase = "Splash",
        firebase.database().ref("matches/" + i + "/startTime").on("value", function(e) {
            e.val() && (l = Date.now(),
            y())
        })),
        $(".competitorPopupController").popup({
            on: "click"
        })
    }
    function v(e, a) {
        var t, r, s, o, i;
        if (!n.match || !n.match.competitors || !n.match.competitors[a])
            return "";
        switch (s = n.match.competitors[a],
        t = (i = n.match.competitors[a].userId === firebase.auth().currentUser.uid) ? "You" : s.realName || s.name,
        i = i ? "you " : "",
        e) {
        case a:
            o = '<span class="won">' + t + " won!</span>",
            r = " &nbsp;And ";
            break;
        case 1 - a:
            o = '<span class="lost">' + t + " lost!</span>",
            r = " &nbsp;But ";
            break;
        case 2:
            o = '<span class="drew">' + t + " drew!</span>",
            r = " &nbsp;And "
        }
        return n.match.surprise || (s.newLevel && s.skippedLevel ? o += r + i + "jumped to level " + s.newLevel + "!" : s.newLevel ? o += r + i + "reached level " + s.newLevel + "!" : s.newPR ? o += r + i + "got a new personal record!" : s.newRecentBest && (o += r + i + "got a top 5 recent score!"),
        "rating" !== s.matchType && "league" !== s.matchType && "slam" !== s.matchType || (o += '<span class="ratingWord">Rating:</span>',
        s.ratingChange < 0 && (o += '<span class="lost">' + s.ratingChange + "</span>"),
        0 === s.ratingChange && (o += "+0"),
        0 < s.ratingChange && (o += '<span class="won">+' + s.ratingChange + "</span>"),
        o += '<span class="ratingArrow">&rarr;</span>',
        o += '<span class="ui olive horizontal label">' + (s.rating + s.ratingChange) + "</span>")),
        o
    }
    function w(e) {
        return e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = e.replace(/ß/g, "ss")).replace(/à/g, "a")).replace(/á/g, "a")).replace(/â/g, "a")).replace(/ã/g, "a")).replace(/ä/g, "a")).replace(/å/g, "a")).replace(/æ/g, "ae")).replace(/ç/g, "c")).replace(/ð/g, "d")).replace(/đ/g, "d")).replace(/è/g, "e")).replace(/é/g, "e")).replace(/ê/g, "e")).replace(/ë/g, "e")).replace(/ё/g, "e")).replace(/ė/g, "e")).replace(/е/g, "e")).replace(/ə/g, "e")).replace(/ğ/g, "g")).replace(/ì/g, "i")).replace(/í/g, "i")).replace(/î/g, "i")).replace(/ï/g, "i")).replace(/ı/g, "i")).replace(/i̇/g, "i")).replace(/ñ/g, "n")).replace(/ò/g, "o")).replace(/ó/g, "o")).replace(/ô/g, "o")).replace(/ö/g, "o")).replace(/ø/g, "o")).replace(/ù/g, "u")).replace(/ú/g, "u")).replace(/û/g, "u")).replace(/ü/g, "u")).replace(/ă/g, "a")).replace(/ą/g, "a")).replace(/ć/g, "c")).replace(/č/g, "c")).replace(/ę/g, "e")).replace(/ě/g, "e")).replace(/ł/g, "l")).replace(/ń/g, "n")).replace(/ő/g, "o")).replace(/œ/g, "oe")).replace(/ś/g, "s")).replace(/š/g, "s")).replace(/ű/g, "u")).replace(/ū/g, "u")).replace(/ź/g, "z")).replace(/ż/g, "z")).replace(/ž/g, "z")).replace(/ș/g, "s")).replace(/ş/g, "s")).replace(/ț/g, "t")).replace(/إ/g, "ا")).replace(/آ/g, "ا")).replace(/أ/g, "ا")).replace(/ي/g, "ى")).replace(/ة/g, "ه")).replace(/^ال/, "")).replace(/ά/g, "α")).replace(/έ/g, "ε")).replace(/ή/g, "η")).replace(/ϊ/g, "ι")).replace(/ΐ/g, "ι")).replace(/ί/g, "ι")).replace(/ό/g, "ο")).replace(/ώ/g, "ω")).replace(/ύ/g, "υ")).replace(/ΰ/g, "υ")).replace(/ϋ/g, "υ")).replace(/ς/g, "σ")).replace(/अं/g, "अन्")).replace(/जं/g, "जन्")).replace(/फ़/g, "फ")).replace(/ज़/g, "ज")).replace(/सं/g, "सन्")).replace(/यां/g, "यान्")).replace(/रबड़/g, "रबर")).replace(/बां/g, "बाँ")).replace(/बूं/g, "बूँ")).replace(/’/g, "'")
    }
    function y() {
        var e = (Date.now() - l) / 1e3 - c;
        e < u && (n.phase = "PreMemo",
        m = u - e),
        u <= e && e < u + h && (n.phase = "Memo",
        m = u + h - e),
        u + h <= e && e < u + h + d && (n.phase = "PreRecall",
        m = u + h + d - e),
        u + h + d <= e && e < u + h + d + f && (n.phase = "Recall",
        m = u + h + d + f - e),
        u + h + d + f < e || n.match.endTime ? n.phase = "Completed" : (n.timerMin = Math.floor(Math.round(m) / 60),
        e = Math.round(m) % 60,
        n.timerSec = (e < 10 ? "0" : "") + e,
        n.timerWarning = ("Memo" === n.phase || "Recall" === n.phase) && Math.round(m) < 10,
        p = t(y, 1e3))
    }
    i = o.matchId,
    c = 0,
    n.secMemo = h,
    n.comments = [],
    n.competitorData = {},
    n.countryNames = countryNames,
    n.modalId = "m" + (new Date).getTime(),
    n.now = new Date,
    n.site = window.site,
    n.urls = {},
    n.zoomed = [!1, !1],
    function e() {
        n.user || n.showSignin ? r && g() : setTimeout(e, 1e3)
    }(),
    n.competitorClick = function(e, a, t, r) {
        var s, o;
        $(".ui.modal.competitorModal").modal("show"),
        n.competitorData = {
            competeName: t,
            flag: r,
            id: e,
            name: a
        },
        n.competitorLoading = !0,
        n.$$phase || n.$apply(),
        o = s = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            n.competitorData.ratings = e.val(),
            s = !0,
            o && (n.competitorLoading = !1,
            n.$$phase || n.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            n.competitorData.recentBest = e.val(),
            o = !0,
            s && (n.competitorLoading = !1,
            n.$$phase || n.$apply())
        })
    }
    ,
    n.challenge = function(e) {
        s.path("/compete/" + e + "/" + encodeURIComponent(n.competitorData.competeName))
    }
    ,
    n.memoClassPhoto = function(e, a) {
        return "Memo" !== n.phase ? "" : a == n.match.competitors[e].memoCursor ? "namesMemoPhotoMid" : a > n.match.competitors[e].memoCursor ? "namesMemoRight" + (a - 1) : "namesMemoLeft" + a
    }
    ,
    n.memoClassName = function(e, a) {
        return "Memo" !== n.phase ? "" : a == n.match.competitors[e].memoCursor ? "namesMemoNameMid namesViewMemoNameMid" : a > n.match.competitors[e].memoCursor ? "namesViewMemoNonMid namesMemoRight" + (a - 1) : "namesViewMemoNonMid namesMemoLeft" + a
    }
    ,
    n.resultsMessage = function() {
        var e;
        if (n.match && n.match.competitors)
            return e = v(e = n.winner(), n.a) + "<br>" + v(e, n.b),
            a.trustAsHtml(e)
    }
    ,
    firebase.database().ref("matches/" + i).on("value", function(e) {
        n.match = e.val(),
        r || b(),
        n.$$phase || n.$apply()
    }),
    firebase.database().ref("matchComments/" + i).on("child_added", function(e) {
        var a = document.getElementById("comments");
        n.comments.push(e.val()),
        a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
            a.scrollTop = a.scrollHeight
        }, 0),
        n.$$phase || n.$apply()
    }),
    n.winner = function() {
        return n.match && n.match.competitors ? "rating" === n.match.competitors[0].matchType || "league" === n.match.competitors[0].matchType || "slam" === n.match.competitors[0].matchType ? 100 * n.match.competitors[0].score - n.match.competitors[0].memoTime > 100 * n.match.competitors[1].score - n.match.competitors[1].memoTime ? 0 : 100 * n.match.competitors[0].score - n.match.competitors[0].memoTime < 100 * n.match.competitors[1].score - n.match.competitors[1].memoTime ? 1 : 2 : n.match.competitors[0].score / n.match.competitors[0].memo.length * 1e4 - n.match.competitors[0].memoTime > n.match.competitors[1].score / n.match.competitors[1].memo.length * 1e4 - n.match.competitors[1].memoTime ? 0 : n.match.competitors[0].score / n.match.competitors[0].memo.length * 1e4 - n.match.competitors[0].memoTime < n.match.competitors[1].score / n.match.competitors[1].memo.length * 1e4 - n.match.competitors[1].memoTime ? 1 : 2 : ""
    }
    ,
    n.isCorrect = function(e, a) {
        return !(!a || !e) && w(e.toLowerCase()) === w(a.toLowerCase())
    }
    ,
    n.isIncorrect = function(e, a) {
        return !(!a || !e) && w(e.toLowerCase()) !== w(a.toLowerCase())
    }
    ,
    n.sendClick = function() {
        var e;
        n.comment.trim() && (e = {
            author: n.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: n.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        },
        n.match.competitors[0].userId === firebase.auth().currentUser.uid && n.match.competitors[0].realName && n.match.competitors[0].realName !== n.user.displayName && (e.author = n.match.competitors[0].realName,
        e.competeName = n.user.displayName),
        n.match.competitors[1].userId === firebase.auth().currentUser.uid && n.match.competitors[1].realName && n.match.competitors[1].realName !== n.user.displayName && (e.author = n.match.competitors[1].realName,
        e.competeName = n.user.displayName),
        n.user.flag && (e.flag = n.user.flag),
        firebase.database().ref("matchComments/" + i).push(e),
        "random" === n.comment.substring(0, 6).toLowerCase() && 9 < n.comment.length && firebase.database().ref("pending").push({
            comment: n.comment,
            matchId: i,
            requestType: "random",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        n.comment = "",
        n.$$phase || n.$apply())
    }
    ,
    n.zoomClick = function(e, a, t) {
        var r;
        n.zoomed[e] = !n.zoomed[e],
        n.zoomed[e] ? ((r = .7 * (a.pageX - $("#" + t).offset().left) / .3776 - 181.5) < 0 && (r = 0),
        (t = .7 * (a.pageY - $("#" + t).offset().top) / .3776 - 104.5) < 0 && (t = 0),
        310 < r && (r = 310),
        180 < t && (t = 180),
        n["transform" + e] = "translate(-" + r + "px,-" + t + "px) scale(0.7)") : n["transform" + e] = ""
    }
    ,
    n.$on("$destroy", function() {
        t.cancel(p),
        n.match && n.match.championshipId && firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary").off(),
        firebase.database().ref("matches/" + i).off(),
        firebase.database().ref("matchComments/" + i).off(),
        $(".ui.modal.competitorModal." + n.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + n.modalId).remove()
    })
}
]),
angular.module("myApp.view-names", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/view-names/:matchId/:tableNum", {
        templateUrl: "view-names/view-names.html",
        controller: "ViewNamesCtrl"
    }),
    e.when("/view-names/:matchId/:tableNum/:swap", {
        templateUrl: "view-names/view-names.html",
        controller: "ViewNamesCtrl"
    }),
    e.when("/view-names/:matchId", {
        templateUrl: "view-names/view-names.html",
        controller: "ViewNamesCtrl"
    })
}
]).controller("ViewNamesCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(s, o, a, n, t) {
    window.myscope = n;
    var r, i, c, m, l, p, u = 20, h = 60, d = 10, f = 240;
    function g() {
        !n.match.restricted || "Finished" === n.match.competitors[0].status && "Finished" === n.match.competitors[1].status || n.user && n.user.viewRestricted || firebase.auth().currentUser && (firebase.auth().currentUser.uid === n.match.competitors[0].userId && "Finished" === n.match.competitors[0].status || firebase.auth().currentUser.uid === n.match.competitors[1].userId && "Finished" === n.match.competitors[1].status) || s.path("home")
    }
    function b() {
        var e, a;
        for (r = !0,
        (n.user || n.showSignin) && g(),
        "slam" === n.match.competitors[0].matchType && n.match.title && (n.slamMatch = !0),
        n.match.championshipId && (firebase.database().ref("championships/" + n.match.championshipId + "/commonConfig/title").on("value", function(e) {
            n.championshipTitle = e.val() || "",
            n.$$phase || n.$apply()
        }),
        firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary/" + n.match.matchKey).on("value", function(e) {
            n.matchSummary = e.val() || {},
            n.$$phase || n.$apply()
        }),
        o.tableNum && firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary").on("value", function(e) {
            for (var a = e.val() || {}, t = Object.keys(a), r = 0; r < t.length; r++)
                t[r] !== n.match.matchKey && a[t[r]].open && a[t[r]].tableNum === o.tableNum && a[t[r]].matchUrl && (s.path(a[t[r]].matchUrl.replace("compete", "view") + "/" + o.tableNum),
                n.$$phase || n.$apply()),
                t[r] === n.match.matchKey && "Not Started" === a[t[r]].status && (o.swap ? s.path("view-table/" + n.match.championshipId + "/" + o.tableNum + "/swap") : s.path("view-table/" + n.match.championshipId + "/" + o.tableNum),
                n.$$phase || n.$apply())
        }),
        "remote" !== n.match.championshipId.substring(0, 6) && "japan2020" !== n.match.championshipId && (c = 0)),
        n.match.arena2020 && (n.championshipTitle = "Arena of Memory"),
        n.isCompetitor = n.match.competitors[0].userId === firebase.auth().currentUser.uid || n.match.competitors[1].userId === firebase.auth().currentUser.uid,
        n.match.solo ? n.a = 0 : ((n.match.competitors[0].realName || n.match.competitors[0].name).toLowerCase() < (n.match.competitors[1].realName || n.match.competitors[1].name).toLowerCase() ? n.a = 0 : n.a = 1,
        !o.tableNum || "swap" !== o.tableNum.toLowerCase() && "swop" !== o.tableNum.toLowerCase() || (n.a = 1 - n.a)),
        n.b = 1 - n.a,
        e = 0; e < 2; e++)
            for (a = 0; a < n.match.competitors[e].memo.length; a++)
                !function(a, t) {
                    firebase.storage().ref("names/" + n.match.competitors[a].memo[t].photo).getDownloadURL().then(function(e) {
                        n.urls[n.match.competitors[a].memo[t].photo] = e,
                        n.$$phase || n.$apply()
                    })
                }(e, a);
        n.match.endTime ? n.phase = "Completed" : n.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            l = n.match.startTime - e,
            y()
        }) : (n.phase = "Splash",
        firebase.database().ref("matches/" + i + "/startTime").on("value", function(e) {
            e.val() && (l = Date.now(),
            y())
        })),
        $(".competitorPopupController").popup({
            on: "click"
        })
    }
    function v(e, a) {
        var t, r, s, o, i;
        if (!n.match || !n.match.competitors || !n.match.competitors[a])
            return "";
        switch (s = n.match.competitors[a],
        t = (i = n.match.competitors[a].userId === firebase.auth().currentUser.uid) ? "You" : s.realName || s.name,
        i = i ? "you " : "",
        e) {
        case a:
            o = '<span class="won">' + t + " won!</span>",
            r = " &nbsp;And ";
            break;
        case 1 - a:
            o = '<span class="lost">' + t + " lost!</span>",
            r = " &nbsp;But ";
            break;
        case 2:
            o = '<span class="drew">' + t + " drew!</span>",
            r = " &nbsp;And "
        }
        return n.match.surprise || (s.newLevel && s.skippedLevel ? o += r + i + "jumped to level " + s.newLevel + "!" : s.newLevel ? o += r + i + "reached level " + s.newLevel + "!" : s.newPR ? o += r + i + "got a new personal record!" : s.newRecentBest && (o += r + i + "got a top 5 recent score!"),
        "rating" !== s.matchType && "league" !== s.matchType && "slam" !== s.matchType || (o += '<span class="ratingWord">Rating:</span>',
        s.ratingChange < 0 && (o += '<span class="lost">' + s.ratingChange + "</span>"),
        0 === s.ratingChange && (o += "+0"),
        0 < s.ratingChange && (o += '<span class="won">+' + s.ratingChange + "</span>"),
        o += '<span class="ratingArrow">&rarr;</span>',
        o += '<span class="ui green horizontal label">' + (s.rating + s.ratingChange) + "</span>")),
        o
    }
    function w(e) {
        return e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = e.replace(/ß/g, "ss")).replace(/à/g, "a")).replace(/á/g, "a")).replace(/â/g, "a")).replace(/ã/g, "a")).replace(/ä/g, "a")).replace(/å/g, "a")).replace(/æ/g, "ae")).replace(/ç/g, "c")).replace(/ð/g, "d")).replace(/đ/g, "d")).replace(/è/g, "e")).replace(/é/g, "e")).replace(/ê/g, "e")).replace(/ë/g, "e")).replace(/ё/g, "e")).replace(/ė/g, "e")).replace(/е/g, "e")).replace(/ə/g, "e")).replace(/ğ/g, "g")).replace(/ì/g, "i")).replace(/í/g, "i")).replace(/î/g, "i")).replace(/ï/g, "i")).replace(/ı/g, "i")).replace(/i̇/g, "i")).replace(/ñ/g, "n")).replace(/ò/g, "o")).replace(/ó/g, "o")).replace(/ô/g, "o")).replace(/ö/g, "o")).replace(/ø/g, "o")).replace(/ù/g, "u")).replace(/ú/g, "u")).replace(/û/g, "u")).replace(/ü/g, "u")).replace(/ă/g, "a")).replace(/ą/g, "a")).replace(/ć/g, "c")).replace(/č/g, "c")).replace(/ę/g, "e")).replace(/ě/g, "e")).replace(/ł/g, "l")).replace(/ń/g, "n")).replace(/ő/g, "o")).replace(/œ/g, "oe")).replace(/ś/g, "s")).replace(/š/g, "s")).replace(/ű/g, "u")).replace(/ū/g, "u")).replace(/ź/g, "z")).replace(/ż/g, "z")).replace(/ž/g, "z")).replace(/ș/g, "s")).replace(/ş/g, "s")).replace(/ț/g, "t")).replace(/إ/g, "ا")).replace(/آ/g, "ا")).replace(/أ/g, "ا")).replace(/ي/g, "ى")).replace(/ة/g, "ه")).replace(/^ال/, "")).replace(/ά/g, "α")).replace(/έ/g, "ε")).replace(/ή/g, "η")).replace(/ϊ/g, "ι")).replace(/ΐ/g, "ι")).replace(/ί/g, "ι")).replace(/ό/g, "ο")).replace(/ώ/g, "ω")).replace(/ύ/g, "υ")).replace(/ΰ/g, "υ")).replace(/ϋ/g, "υ")).replace(/ς/g, "σ")).replace(/अं/g, "अन्")).replace(/जं/g, "जन्")).replace(/फ़/g, "फ")).replace(/ज़/g, "ज")).replace(/सं/g, "सन्")).replace(/यां/g, "यान्")).replace(/रबड़/g, "रबर")).replace(/बां/g, "बाँ")).replace(/बूं/g, "बूँ")).replace(/’/g, "'")
    }
    function y() {
        var e = (Date.now() - l) / 1e3 - c;
        e < u && (n.phase = "PreMemo",
        m = u - e),
        u <= e && e < u + h && (n.phase = "Memo",
        m = u + h - e),
        u + h <= e && e < u + h + d && (n.phase = "PreRecall",
        m = u + h + d - e),
        u + h + d <= e && e < u + h + d + f && (n.phase = "Recall",
        m = u + h + d + f - e),
        u + h + d + f < e || n.match.endTime ? n.phase = "Completed" : (n.timerMin = Math.floor(Math.round(m) / 60),
        e = Math.round(m) % 60,
        n.timerSec = (e < 10 ? "0" : "") + e,
        n.timerWarning = ("Memo" === n.phase || "Recall" === n.phase) && Math.round(m) < 10,
        p = t(y, 1e3))
    }
    i = o.matchId,
    c = 0,
    n.secMemo = h,
    n.comments = [],
    n.competitorData = {},
    n.countryNames = countryNames,
    n.modalId = "m" + (new Date).getTime(),
    n.now = new Date,
    n.site = window.site,
    n.urls = {},
    n.zoomed = [!1, !1],
    function e() {
        n.user || n.showSignin ? r && g() : setTimeout(e, 1e3)
    }(),
    n.pokerRecallClass = function(e, a) {
        var t, r;
        return !n.match || !n.match.poker || "Recall" !== n.phase && "Completed" !== n.phase ? "" : (t = "cardsRecallView_e card" + a + "_e",
        n.match.competitors[e].recall.cards[a] < 52 ? t += " pokerViewRecallPos" + n.match.competitors[e].recall.cards[a] : t += " pokerRecallPosBottom" + (n.match.competitors[e].recall.cards[a] - 52),
        t += " " + (r = e,
        e = a,
        51 < n.match.competitors[r].recall.cards[e] ? "" : (a = Math.floor(n.match.competitors[r].recall.cards[e] / 5),
        a = n.match.competitors[r].inverseRecallSeqs[a],
        n.match.competitors[r].memo[a].cards[n.match.competitors[r].recall.cards[e] % 5] === e ? "cardsCorrect" : "cardsIncorrect")))
    }
    ,
    n.competitorClick = function(e, a, t, r) {
        var s, o;
        $(".ui.modal.competitorModal").modal("show"),
        n.competitorData = {
            competeName: t,
            flag: r,
            id: e,
            name: a
        },
        n.competitorLoading = !0,
        n.$$phase || n.$apply(),
        o = s = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            n.competitorData.ratings = e.val(),
            s = !0,
            o && (n.competitorLoading = !1,
            n.$$phase || n.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            n.competitorData.recentBest = e.val(),
            o = !0,
            s && (n.competitorLoading = !1,
            n.$$phase || n.$apply())
        })
    }
    ,
    n.challenge = function(e) {
        s.path("/compete/" + e + "/" + encodeURIComponent(n.competitorData.competeName))
    }
    ,
    n.memoClassPhoto = function(e, a) {
        return "Memo" !== n.phase ? "" : a == n.match.competitors[e].memoCursor ? "namesMemoPhotoMid" : a > n.match.competitors[e].memoCursor ? "namesMemoRight" + (a - 1) : "namesMemoLeft" + a
    }
    ,
    n.memoClassName = function(e, a) {
        return "Memo" !== n.phase ? "" : a == n.match.competitors[e].memoCursor ? "namesMemoNameMid namesViewMemoNameMid" : a > n.match.competitors[e].memoCursor ? "namesViewMemoNonMid namesMemoRight" + (a - 1) : "namesViewMemoNonMid namesMemoLeft" + a
    }
    ,
    n.resultsMessage = function() {
        var e;
        if (n.match && n.match.competitors)
            return e = v(e = n.winner(), n.a) + "<br>" + v(e, n.b),
            a.trustAsHtml(e)
    }
    ,
    firebase.database().ref("matches/" + i).on("value", function(e) {
        n.match = e.val(),
        r || b(),
        n.$$phase || n.$apply()
    }),
    firebase.database().ref("matchComments/" + i).on("child_added", function(e) {
        var a = document.getElementById("comments");
        n.comments.push(e.val()),
        a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
            a.scrollTop = a.scrollHeight
        }, 0),
        n.$$phase || n.$apply()
    }),
    n.winner = function() {
        return n.match && n.match.competitors ? "rating" === n.match.competitors[0].matchType || "league" === n.match.competitors[0].matchType || "slam" === n.match.competitors[0].matchType ? 100 * n.match.competitors[0].score - n.match.competitors[0].memoTime > 100 * n.match.competitors[1].score - n.match.competitors[1].memoTime ? 0 : 100 * n.match.competitors[0].score - n.match.competitors[0].memoTime < 100 * n.match.competitors[1].score - n.match.competitors[1].memoTime ? 1 : 2 : n.match.competitors[0].score / n.match.competitors[0].memo.length * 1e4 - n.match.competitors[0].memoTime > n.match.competitors[1].score / n.match.competitors[1].memo.length * 1e4 - n.match.competitors[1].memoTime ? 0 : n.match.competitors[0].score / n.match.competitors[0].memo.length * 1e4 - n.match.competitors[0].memoTime < n.match.competitors[1].score / n.match.competitors[1].memo.length * 1e4 - n.match.competitors[1].memoTime ? 1 : 2 : ""
    }
    ,
    n.isCorrect = function(e, a) {
        return !(!a || !e) && w(e.toLowerCase()) === w(a.toLowerCase())
    }
    ,
    n.isIncorrect = function(e, a) {
        return !(!a || !e) && w(e.toLowerCase()) !== w(a.toLowerCase())
    }
    ,
    n.sendClick = function() {
        var e;
        n.comment.trim() && (e = {
            author: n.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: n.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        },
        n.match.competitors[0].userId === firebase.auth().currentUser.uid && n.match.competitors[0].realName && n.match.competitors[0].realName !== n.user.displayName && (e.author = n.match.competitors[0].realName,
        e.competeName = n.user.displayName),
        n.match.competitors[1].userId === firebase.auth().currentUser.uid && n.match.competitors[1].realName && n.match.competitors[1].realName !== n.user.displayName && (e.author = n.match.competitors[1].realName,
        e.competeName = n.user.displayName),
        n.user.flag && (e.flag = n.user.flag),
        firebase.database().ref("matchComments/" + i).push(e),
        "random" === n.comment.substring(0, 6).toLowerCase() && 9 < n.comment.length && firebase.database().ref("pending").push({
            comment: n.comment,
            matchId: i,
            requestType: "random",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        n.comment = "",
        n.$$phase || n.$apply())
    }
    ,
    n.zoomClick = function(e, a, t) {
        var r;
        n.zoomed[e] = !n.zoomed[e],
        n.zoomed[e] ? ((r = .7 * (a.pageX - $("#" + t).offset().left) / .3776 - 181.5) < 0 && (r = 0),
        (t = .7 * (a.pageY - $("#" + t).offset().top) / .3776 - 104.5) < 0 && (t = 0),
        310 < r && (r = 310),
        180 < t && (t = 180),
        n["transform" + e] = "translate(-" + r + "px,-" + t + "px) scale(0.7)") : n["transform" + e] = ""
    }
    ,
    n.$on("$destroy", function() {
        t.cancel(p),
        n.match && n.match.championshipId && firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary").off(),
        firebase.database().ref("matches/" + i).off(),
        firebase.database().ref("matchComments/" + i).off(),
        $(".ui.modal.competitorModal." + n.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + n.modalId).remove()
    })
}
]),
angular.module("myApp.view-numbers", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/view-numbers/:matchId/:tableNum", {
        templateUrl: "view-numbers/view-numbers.html",
        controller: "ViewNumbersCtrl"
    }),
    e.when("/view-numbers/:matchId/:tableNum/:swap", {
        templateUrl: "view-numbers/view-numbers.html",
        controller: "ViewNumbersCtrl"
    }),
    e.when("/view-numbers/:matchId", {
        templateUrl: "view-numbers/view-numbers.html",
        controller: "ViewNumbersCtrl"
    })
}
]).controller("ViewNumbersCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(s, o, r, n, a) {
    window.myscope = n;
    var i, c, m, t, l, p, u = 20, h = 60, d = 10, f = 240;
    function g() {
        !n.match.restricted || "Finished" === n.match.competitors[0].status && "Finished" === n.match.competitors[1].status || n.user && n.user.viewRestricted || firebase.auth().currentUser && (firebase.auth().currentUser.uid === n.match.competitors[0].userId && "Finished" === n.match.competitors[0].status || firebase.auth().currentUser.uid === n.match.competitors[1].userId && "Finished" === n.match.competitors[1].status) || s.path("home")
    }
    function b(e, a) {
        var t, r, s, o, i;
        if (!n.match || !n.match.competitors || !n.match.competitors[a])
            return "";
        switch (s = n.match.competitors[a],
        t = (i = n.match.competitors[a].userId === firebase.auth().currentUser.uid) ? "You" : s.realName || s.name,
        i = i ? "you " : "",
        e) {
        case a:
            o = '<span class="won">' + t + " won!</span>",
            r = " &nbsp;And ";
            break;
        case 1 - a:
            o = '<span class="lost">' + t + " lost!</span>",
            r = " &nbsp;But ";
            break;
        case 2:
            o = '<span class="drew">' + t + " drew!</span>",
            r = " &nbsp;And "
        }
        return n.match.surprise || (s.newLevel && s.skippedLevel ? o += r + i + "jumped to level " + s.newLevel + "!" : s.newLevel ? o += r + i + "reached level " + s.newLevel + "!" : s.newPR ? o += r + i + "got a new personal record!" : s.newRecentBest && (o += r + i + "got a top 5 recent score!"),
        "rating" !== s.matchType && "league" !== s.matchType && "slam" !== s.matchType || (o += '<span class="ratingWord">Rating:</span>',
        s.ratingChange < 0 && (o += '<span class="lost">' + s.ratingChange + "</span>"),
        0 === s.ratingChange && (o += "+0"),
        0 < s.ratingChange && (o += '<span class="won">+' + s.ratingChange + "</span>"),
        o += '<span class="ratingArrow">&rarr;</span>',
        o += '<span class="ui blue horizontal label">' + (s.rating + s.ratingChange) + "</span>")),
        o
    }
    function v() {
        var e = (Date.now() - l) / 1e3 - m;
        e < u && (n.phase = "PreMemo",
        t = u - e),
        u <= e && e < u + h && (n.phase = "Memo",
        t = u + h - e),
        u + h <= e && e < u + h + d && (n.phase = "PreRecall",
        t = u + h + d - e),
        u + h + d <= e && e < u + h + d + f && (n.phase = "Recall",
        t = u + h + d + f - e),
        u + h + d + f < e || n.match.endTime ? n.phase = "Completed" : (n.timerMin = Math.floor(Math.round(t) / 60),
        e = Math.round(t) % 60,
        n.timerSec = (e < 10 ? "0" : "") + e,
        n.timerWarning = ("Memo" === n.phase || "Recall" === n.phase) && Math.round(t) < 10,
        p = a(v, 1e3))
    }
    c = o.matchId,
    m = 0,
    n.secMemo = h,
    n.comments = [],
    n.competitorData = {},
    n.countryNames = countryNames,
    n.modalId = "m" + (new Date).getTime(),
    n.now = new Date,
    n.site = window.site,
    n.zoomed = [!1, !1],
    function e() {
        n.user || n.showSignin ? i && g() : setTimeout(e, 1e3)
    }(),
    n.competitorClick = function(e, a, t, r) {
        var s, o;
        $(".ui.modal.competitorModal").modal("show"),
        n.competitorData = {
            competeName: t,
            flag: r,
            id: e,
            name: a
        },
        n.competitorLoading = !0,
        n.$$phase || n.$apply(),
        o = s = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            n.competitorData.ratings = e.val(),
            s = !0,
            o && (n.competitorLoading = !1,
            n.$$phase || n.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            n.competitorData.recentBest = e.val(),
            o = !0,
            s && (n.competitorLoading = !1,
            n.$$phase || n.$apply())
        })
    }
    ,
    n.challenge = function(e) {
        s.path("/compete/" + e + "/" + encodeURIComponent(n.competitorData.competeName))
    }
    ,
    n.memoClass = function(e, a) {
        return "Memo" !== n.phase ? "" : a === n.match.competitors[e].memoCursor ? "numbersMemoMid numbersViewMemoMid" : a > n.match.competitors[e].memoCursor ? "numbersMemoRight" + n.match.competitors[e].info.groups[a].position : "numbersMemoLeft" + n.match.competitors[e].info.groups[a].position
    }
    ,
    n.resultsMessage = function() {
        var e;
        if (n.match && n.match.competitors)
            return e = b(e = n.winner(), n.a) + "<br>" + b(e, n.b),
            r.trustAsHtml(e)
    }
    ,
    firebase.database().ref("matches/" + c).on("value", function(e) {
        var a, t;
        for (n.match = e.val(),
        a = 0; a < 2; a++)
            for (t = 0; t < n.match.competitors[a].info.groupCount; t += 1)
                n.match.competitors[a].info.groups[t].contents = r.trustAsHtml(n.match.competitors[a].info.groups[t].contents);
        i || (i = !0,
        (n.user || n.showSignin) && g(),
        "slam" === n.match.competitors[0].matchType && n.match.title && (n.slamMatch = !0),
        n.match.championshipId && (firebase.database().ref("championships/" + n.match.championshipId + "/commonConfig/title").on("value", function(e) {
            n.championshipTitle = e.val() || "",
            n.$$phase || n.$apply()
        }),
        firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary/" + n.match.matchKey).on("value", function(e) {
            n.matchSummary = e.val() || {},
            n.$$phase || n.$apply()
        }),
        o.tableNum && firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary").on("value", function(e) {
            for (var a = e.val() || {}, t = Object.keys(a), r = 0; r < t.length; r++)
                t[r] !== n.match.matchKey && a[t[r]].open && a[t[r]].tableNum === o.tableNum && a[t[r]].matchUrl && (s.path(a[t[r]].matchUrl.replace("compete", "view") + "/" + o.tableNum),
                n.$$phase || n.$apply()),
                t[r] === n.match.matchKey && "Not Started" === a[t[r]].status && (o.swap ? s.path("view-table/" + n.match.championshipId + "/" + o.tableNum + "/swap") : s.path("view-table/" + n.match.championshipId + "/" + o.tableNum),
                n.$$phase || n.$apply())
        }),
        "remote" !== n.match.championshipId.substring(0, 6) && "japan2020" !== n.match.championshipId && (m = 0)),
        n.match.arena2020 && (n.championshipTitle = "Arena of Memory"),
        n.isCompetitor = n.match.competitors[0].userId === firebase.auth().currentUser.uid || n.match.competitors[1].userId === firebase.auth().currentUser.uid,
        n.match.solo ? n.a = 0 : ((n.match.competitors[0].realName || n.match.competitors[0].name).toLowerCase() < (n.match.competitors[1].realName || n.match.competitors[1].name).toLowerCase() ? n.a = 0 : n.a = 1,
        !o.tableNum || "swap" !== o.tableNum.toLowerCase() && "swop" !== o.tableNum.toLowerCase() || (n.a = 1 - n.a)),
        n.b = 1 - n.a,
        n.match.endTime ? n.phase = "Completed" : n.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            l = n.match.startTime - e,
            v()
        }) : (n.phase = "Splash",
        firebase.database().ref("matches/" + c + "/startTime").on("value", function(e) {
            e.val() && (l = Date.now(),
            v())
        })),
        $(".competitorPopupController").popup({
            on: "click"
        })),
        n.$$phase || n.$apply()
    }),
    firebase.database().ref("matchComments/" + c).on("child_added", function(e) {
        var a = document.getElementById("comments");
        n.comments.push(e.val()),
        a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
            a.scrollTop = a.scrollHeight
        }, 0),
        n.$$phase || n.$apply()
    }),
    n.winner = function() {
        return n.match && n.match.competitors ? "rating" === n.match.competitors[0].matchType || "league" === n.match.competitors[0].matchType || "slam" === n.match.competitors[0].matchType ? 100 * n.match.competitors[0].score - n.match.competitors[0].memoTime > 100 * n.match.competitors[1].score - n.match.competitors[1].memoTime ? 0 : 100 * n.match.competitors[0].score - n.match.competitors[0].memoTime < 100 * n.match.competitors[1].score - n.match.competitors[1].memoTime ? 1 : 2 : n.match.competitors[0].score / n.match.competitors[0].memo.length * 1e4 - n.match.competitors[0].memoTime > n.match.competitors[1].score / n.match.competitors[1].memo.length * 1e4 - n.match.competitors[1].memoTime ? 0 : n.match.competitors[0].score / n.match.competitors[0].memo.length * 1e4 - n.match.competitors[0].memoTime < n.match.competitors[1].score / n.match.competitors[1].memo.length * 1e4 - n.match.competitors[1].memoTime ? 1 : 2 : ""
    }
    ,
    n.sendClick = function() {
        var e;
        n.comment.trim() && (e = {
            author: n.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: n.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        },
        n.match.competitors[0].userId === firebase.auth().currentUser.uid && n.match.competitors[0].realName && n.match.competitors[0].realName !== n.user.displayName && (e.author = n.match.competitors[0].realName,
        e.competeName = n.user.displayName),
        n.match.competitors[1].userId === firebase.auth().currentUser.uid && n.match.competitors[1].realName && n.match.competitors[1].realName !== n.user.displayName && (e.author = n.match.competitors[1].realName,
        e.competeName = n.user.displayName),
        n.user.flag && (e.flag = n.user.flag),
        firebase.database().ref("matchComments/" + c).push(e),
        "random" === n.comment.substring(0, 6).toLowerCase() && 9 < n.comment.length && firebase.database().ref("pending").push({
            comment: n.comment,
            matchId: c,
            requestType: "random",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        n.comment = "",
        n.$$phase || n.$apply())
    }
    ,
    n.zoomClick = function(e, a, t) {
        var r;
        n.zoomed[e] = !n.zoomed[e],
        n.zoomed[e] ? ((r = .7 * (a.pageX - $("#" + t).offset().left) / .3776 - 181.5) < 0 && (r = 0),
        (a = .7 * (a.pageY - $("#" + t).offset().top) / .3776 - 104.5) < 0 && (a = 0),
        310 < r && (r = 310),
        180 < a && (a = 180),
        n["transform" + e] = "viewContainerMemo0" === t || "viewContainerMemo1" === t ? "translate(-" + r + "px,-" + a + "px) scale(0.7)" : "translate(-" + r + "px,-" + a + "px) scale(1.854)") : n["transform" + e] = ""
    }
    ,
    n.$on("$destroy", function() {
        a.cancel(p),
        n.match && n.match.championshipId && firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary").off(),
        firebase.database().ref("matches/" + c).off(),
        firebase.database().ref("matchComments/" + c).off(),
        $(".ui.modal.competitorModal." + n.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + n.modalId).remove()
    })
}
]),
angular.module("myApp.view-table", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/view-table/:championshipId/:tableNum", {
        templateUrl: "view-table/view-table.html",
        controller: "ViewTableCtrl"
    }),
    e.when("/view-table/:championshipId/:tableNum/:swap", {
        templateUrl: "view-table/view-table.html",
        controller: "ViewTableCtrl"
    })
}
]).controller("ViewTableCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(s, o, e, i, a) {
    (window.myscope = i).tableNum = o.tableNum,
    firebase.database().ref("championships/" + o.championshipId + "/commonConfig/title").once("value", function(e) {
        i.championshipTitle = e.val(),
        i.$$phase || i.$apply()
    }),
    firebase.database().ref("championships/" + o.championshipId + "/matchesSummary").on("value", function(e) {
        for (var a = e.val() || {}, t = Object.keys(a), r = 0; r < t.length; r++)
            a[t[r]].open && a[t[r]].tableNum === o.tableNum && a[t[r]].matchUrl && (o.swap ? s.path(a[t[r]].matchUrl.replace("compete", "view") + "/" + o.tableNum + "/swap") : s.path(a[t[r]].matchUrl.replace("compete", "view") + "/" + o.tableNum),
            i.$$phase || i.$apply())
    }),
    i.$on("$destroy", function() {
        firebase.database().ref("championships/" + o.championshipId + "/matchesSummary").off()
    })
}
]),
angular.module("myApp.view-words", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/view-words/:matchId/:tableNum", {
        templateUrl: "view-words/view-words.html",
        controller: "ViewWordsCtrl"
    }),
    e.when("/view-words/:matchId/:tableNum/:swap", {
        templateUrl: "view-words/view-words.html",
        controller: "ViewWordsCtrl"
    }),
    e.when("/view-words/:matchId", {
        templateUrl: "view-words/view-words.html",
        controller: "ViewWordsCtrl"
    })
}
]).controller("ViewWordsCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(s, o, a, n, t) {
    window.myscope = n;
    var r, i, c, m, l, p, u = 20, h = 60, d = 10, f = 240;
    function g() {
        !n.match.restricted || "Finished" === n.match.competitors[0].status && "Finished" === n.match.competitors[1].status || n.user && n.user.viewRestricted || firebase.auth().currentUser && (firebase.auth().currentUser.uid === n.match.competitors[0].userId && "Finished" === n.match.competitors[0].status || firebase.auth().currentUser.uid === n.match.competitors[1].userId && "Finished" === n.match.competitors[1].status) || s.path("home")
    }
    function b(e, a) {
        var t, r, s, o, i;
        if (!n.match || !n.match.competitors || !n.match.competitors[a])
            return "";
        switch (s = n.match.competitors[a],
        t = (i = n.match.competitors[a].userId === firebase.auth().currentUser.uid) ? "You" : s.realName || s.name,
        i = i ? "you " : "",
        e) {
        case a:
            o = '<span class="won">' + t + " won!</span>",
            r = " &nbsp;And ";
            break;
        case 1 - a:
            o = '<span class="lost">' + t + " lost!</span>",
            r = " &nbsp;But ";
            break;
        case 2:
            o = '<span class="drew">' + t + " drew!</span>",
            r = " &nbsp;And "
        }
        return n.match.surprise || (s.newLevel && s.skippedLevel ? o += r + i + "jumped to level " + s.newLevel + "!" : s.newLevel ? o += r + i + "reached level " + s.newLevel + "!" : s.newPR ? o += r + i + "got a new personal record!" : s.newRecentBest && (o += r + i + "got a top 5 recent score!"),
        "rating" !== s.matchType && "league" !== s.matchType && "slam" !== s.matchType || (o += '<span class="ratingWord">Rating:</span>',
        s.ratingChange < 0 && (o += '<span class="lost">' + s.ratingChange + "</span>"),
        0 === s.ratingChange && (o += "+0"),
        0 < s.ratingChange && (o += '<span class="won">+' + s.ratingChange + "</span>"),
        o += '<span class="ratingArrow">&rarr;</span>',
        o += '<span class="ui purple horizontal label">' + (s.rating + s.ratingChange) + "</span>")),
        o
    }
    function v(e) {
        return e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = (e = e.replace(/ß/g, "ss")).replace(/à/g, "a")).replace(/á/g, "a")).replace(/â/g, "a")).replace(/ã/g, "a")).replace(/ä/g, "a")).replace(/å/g, "a")).replace(/æ/g, "ae")).replace(/ç/g, "c")).replace(/ð/g, "d")).replace(/đ/g, "d")).replace(/è/g, "e")).replace(/é/g, "e")).replace(/ê/g, "e")).replace(/ë/g, "e")).replace(/ё/g, "e")).replace(/ė/g, "e")).replace(/е/g, "e")).replace(/ə/g, "e")).replace(/ğ/g, "g")).replace(/ì/g, "i")).replace(/í/g, "i")).replace(/î/g, "i")).replace(/ï/g, "i")).replace(/ı/g, "i")).replace(/i̇/g, "i")).replace(/ñ/g, "n")).replace(/ò/g, "o")).replace(/ó/g, "o")).replace(/ô/g, "o")).replace(/ö/g, "o")).replace(/ø/g, "o")).replace(/ù/g, "u")).replace(/ú/g, "u")).replace(/û/g, "u")).replace(/ü/g, "u")).replace(/ă/g, "a")).replace(/ą/g, "a")).replace(/ć/g, "c")).replace(/č/g, "c")).replace(/ę/g, "e")).replace(/ě/g, "e")).replace(/ł/g, "l")).replace(/ń/g, "n")).replace(/ő/g, "o")).replace(/œ/g, "oe")).replace(/ś/g, "s")).replace(/š/g, "s")).replace(/ű/g, "u")).replace(/ū/g, "u")).replace(/ź/g, "z")).replace(/ż/g, "z")).replace(/ž/g, "z")).replace(/ș/g, "s")).replace(/ş/g, "s")).replace(/ț/g, "t")).replace(/إ/g, "ا")).replace(/آ/g, "ا")).replace(/أ/g, "ا")).replace(/ي/g, "ى")).replace(/ة/g, "ه")).replace(/^ال/, "")).replace(/ά/g, "α")).replace(/έ/g, "ε")).replace(/ή/g, "η")).replace(/ϊ/g, "ι")).replace(/ΐ/g, "ι")).replace(/ί/g, "ι")).replace(/ό/g, "ο")).replace(/ώ/g, "ω")).replace(/ύ/g, "υ")).replace(/ΰ/g, "υ")).replace(/ϋ/g, "υ")).replace(/ς/g, "σ")).replace(/अं/g, "अन्")).replace(/जं/g, "जन्")).replace(/फ़/g, "फ")).replace(/ज़/g, "ज")).replace(/सं/g, "सन्")).replace(/यां/g, "यान्")).replace(/रबड़/g, "रबर")).replace(/बां/g, "बाँ")).replace(/बूं/g, "बूँ")).replace(/’/g, "'")
    }
    function w() {
        var e = (Date.now() - l) / 1e3 - c;
        e < u && (n.phase = "PreMemo",
        m = u - e),
        u <= e && e < u + h && (n.phase = "Memo",
        m = u + h - e),
        u + h <= e && e < u + h + d && (n.phase = "PreRecall",
        m = u + h + d - e),
        u + h + d <= e && e < u + h + d + f && (n.phase = "Recall",
        m = u + h + d + f - e),
        u + h + d + f < e || n.match.endTime ? n.phase = "Completed" : (n.timerMin = Math.floor(Math.round(m) / 60),
        e = Math.round(m) % 60,
        n.timerSec = (e < 10 ? "0" : "") + e,
        n.timerWarning = ("Memo" === n.phase || "Recall" === n.phase) && Math.round(m) < 10,
        p = t(w, 1e3))
    }
    i = o.matchId,
    c = 0,
    n.secMemo = h,
    n.comments = [],
    n.competitorData = {},
    n.countryNames = countryNames,
    n.modalId = "m" + (new Date).getTime(),
    n.now = new Date,
    n.site = window.site,
    n.zoomed = [!1, !1],
    function e() {
        n.user || n.showSignin ? r && g() : setTimeout(e, 1e3)
    }(),
    n.competitorClick = function(e, a, t, r) {
        var s, o;
        $(".ui.modal.competitorModal").modal("show"),
        n.competitorData = {
            competeName: t,
            flag: r,
            id: e,
            name: a
        },
        n.competitorLoading = !0,
        n.$$phase || n.$apply(),
        o = s = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            n.competitorData.ratings = e.val(),
            s = !0,
            o && (n.competitorLoading = !1,
            n.$$phase || n.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            n.competitorData.recentBest = e.val(),
            o = !0,
            s && (n.competitorLoading = !1,
            n.$$phase || n.$apply())
        })
    }
    ,
    n.challenge = function(e) {
        s.path("/compete/" + e + "/" + encodeURIComponent(n.competitorData.competeName))
    }
    ,
    n.memoClass = function(e, a) {
        return "Memo" !== n.phase || a >= n.match.competitors[e].memo.length ? "" : n.match.competitors[e].info.words[a].groupNum === n.match.competitors[e].memoCursor ? "wordsViewMemoMid wordsMemoMid" + n.match.competitors[e].info.words[a].posInGroup : n.match.competitors[e].info.words[a].groupNum > n.match.competitors[e].memoCursor ? "wordsViewMemoNonMid wordsMemoRight" + (a - n.match.competitors[e].info.groups[0].size) : "wordsViewMemoNonMid wordsMemoLeft" + a
    }
    ,
    n.resultsMessage = function() {
        var e;
        if (n.match && n.match.competitors)
            return e = b(e = n.winner(), n.a) + "<br>" + b(e, n.b),
            a.trustAsHtml(e)
    }
    ,
    firebase.database().ref("matches/" + i).on("value", function(e) {
        n.match = e.val(),
        r || (r = !0,
        (n.user || n.showSignin) && g(),
        "slam" === n.match.competitors[0].matchType && n.match.title && (n.slamMatch = !0),
        n.match.championshipId && (firebase.database().ref("championships/" + n.match.championshipId + "/commonConfig/title").on("value", function(e) {
            n.championshipTitle = e.val() || "",
            n.$$phase || n.$apply()
        }),
        firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary/" + n.match.matchKey).on("value", function(e) {
            n.matchSummary = e.val() || {},
            n.$$phase || n.$apply()
        }),
        o.tableNum && firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary").on("value", function(e) {
            for (var a = e.val() || {}, t = Object.keys(a), r = 0; r < t.length; r++)
                t[r] !== n.match.matchKey && a[t[r]].open && a[t[r]].tableNum === o.tableNum && a[t[r]].matchUrl && (s.path(a[t[r]].matchUrl.replace("compete", "view") + "/" + o.tableNum),
                n.$$phase || n.$apply()),
                t[r] === n.match.matchKey && "Not Started" === a[t[r]].status && (o.swap ? s.path("view-table/" + n.match.championshipId + "/" + o.tableNum + "/swap") : s.path("view-table/" + n.match.championshipId + "/" + o.tableNum),
                n.$$phase || n.$apply())
        }),
        "remote" !== n.match.championshipId.substring(0, 6) && "japan2020" !== n.match.championshipId && (c = 0)),
        n.match.arena2020 && (n.championshipTitle = "Arena of Memory"),
        n.isCompetitor = n.match.competitors[0].userId === firebase.auth().currentUser.uid || n.match.competitors[1].userId === firebase.auth().currentUser.uid,
        n.isCompetitor && (n.match.competitors[0].userId === firebase.auth().currentUser.uid ? n.currentCompetitor = 0 : n.currentCompetitor = 1),
        n.match.solo ? n.a = 0 : ((n.match.competitors[0].realName || n.match.competitors[0].name).toLowerCase() < (n.match.competitors[1].realName || n.match.competitors[1].name).toLowerCase() ? n.a = 0 : n.a = 1,
        !o.tableNum || "swap" !== o.tableNum.toLowerCase() && "swop" !== o.tableNum.toLowerCase() || (n.a = 1 - n.a)),
        n.b = 1 - n.a,
        n.match.endTime ? n.phase = "Completed" : n.match.startTime ? firebase.database().ref(".info/serverTimeOffset").once("value", function(e) {
            e = e.val();
            l = n.match.startTime - e,
            w()
        }) : (n.phase = "Splash",
        firebase.database().ref("matches/" + i + "/startTime").on("value", function(e) {
            e.val() && (l = Date.now(),
            w())
        })),
        $(".competitorPopupController").popup({
            on: "click"
        })),
        n.$$phase || n.$apply()
    }),
    firebase.database().ref("matchComments/" + i).on("child_added", function(e) {
        var a = document.getElementById("comments");
        n.comments.push(e.val()),
        a.scrollHeight - a.clientHeight <= a.scrollTop + 10 && setTimeout(function() {
            a.scrollTop = a.scrollHeight
        }, 0),
        n.$$phase || n.$apply()
    }),
    n.winner = function() {
        return n.match && n.match.competitors ? "rating" === n.match.competitors[0].matchType || "league" === n.match.competitors[0].matchType || "slam" === n.match.competitors[0].matchType ? 100 * n.match.competitors[0].score - n.match.competitors[0].memoTime > 100 * n.match.competitors[1].score - n.match.competitors[1].memoTime ? 0 : 100 * n.match.competitors[0].score - n.match.competitors[0].memoTime < 100 * n.match.competitors[1].score - n.match.competitors[1].memoTime ? 1 : 2 : n.match.competitors[0].score / n.match.competitors[0].memo.length * 1e4 - n.match.competitors[0].memoTime > n.match.competitors[1].score / n.match.competitors[1].memo.length * 1e4 - n.match.competitors[1].memoTime ? 0 : n.match.competitors[0].score / n.match.competitors[0].memo.length * 1e4 - n.match.competitors[0].memoTime < n.match.competitors[1].score / n.match.competitors[1].memo.length * 1e4 - n.match.competitors[1].memoTime ? 1 : 2 : ""
    }
    ,
    n.flightsIsCorrect = function(e, a) {
        return !(!a || !e) && e.toString().replace(/\D/g, "") === a.toString().replace(/\D/g, "")
    }
    ,
    n.flightsIsIncorrect = function(e, a) {
        return !(!a || !e) && e.toString().replace(/\D/g, "") !== a.toString().replace(/\D/g, "")
    }
    ,
    n.isCorrect = function(e, a) {
        return !(!a || !e) && v(e.toLowerCase()) === v(a.toLowerCase())
    }
    ,
    n.isIncorrect = function(e, a) {
        return !(!(a || n.match && n.match.blankWords) || !e) && v(e.toLowerCase()) !== v(a.toLowerCase())
    }
    ,
    n.badWords = [];
    for (var e = 0; e < 6; e += 1)
        n.badWords.push({
            num: "",
            word: "",
            english: "",
            comments: ""
        });
    function y() {
        for (var e, a = 0; a < 6; a += 1)
            n.badWords[a].word && (firebase.database().ref("badWords").push({
                comments: n.badWords[a].comments,
                english: n.badWords[a].english,
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                userId: firebase.auth().currentUser.uid,
                word: n.badWords[a].word,
                wordsLanguage: n.match.competitors[n.currentCompetitor].wordsLanguage
            }),
            e = !0);
        e && $(".ui.modal.thanks").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    n.badWordsClick = function() {
        $(".ui.modal.badWords").modal("setting", {
            onApprove: y
        }).modal("show")
    }
    ,
    n.sendClick = function() {
        var e;
        n.comment.trim() && (e = {
            author: n.user.displayName,
            authorId: firebase.auth().currentUser.uid,
            comment: n.comment,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        },
        n.match.competitors[0].userId === firebase.auth().currentUser.uid && n.match.competitors[0].realName && n.match.competitors[0].realName !== n.user.displayName && (e.author = n.match.competitors[0].realName,
        e.competeName = n.user.displayName),
        n.match.competitors[1].userId === firebase.auth().currentUser.uid && n.match.competitors[1].realName && n.match.competitors[1].realName !== n.user.displayName && (e.author = n.match.competitors[1].realName,
        e.competeName = n.user.displayName),
        n.user.flag && (e.flag = n.user.flag),
        firebase.database().ref("matchComments/" + i).push(e),
        "random" === n.comment.substring(0, 6).toLowerCase() && 9 < n.comment.length && firebase.database().ref("pending").push({
            comment: n.comment,
            matchId: i,
            requestType: "random",
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser.uid
        }),
        n.comment = "",
        n.$$phase || n.$apply())
    }
    ,
    n.zoomClick = function(e, a, t) {
        var r;
        n.zoomed[e] = !n.zoomed[e],
        n.zoomed[e] ? ((r = .7 * (a.pageX - $("#" + t).offset().left) / .3776 - 181.5) < 0 && (r = 0),
        (t = .7 * (a.pageY - $("#" + t).offset().top) / .3776 - 104.5) < 0 && (t = 0),
        310 < r && (r = 310),
        180 < t && (t = 180),
        n["transform" + e] = "translate(-" + r + "px,-" + t + "px) scale(0.7)") : n["transform" + e] = ""
    }
    ,
    n.$on("$destroy", function() {
        t.cancel(p),
        n.match && n.match.championshipId && firebase.database().ref("championships/" + n.match.championshipId + "/matchesSummary").off(),
        firebase.database().ref("matches/" + i).off(),
        firebase.database().ref("matchComments/" + i).off(),
        $(".ui.modal.competitorModal." + n.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + n.modalId).remove()
    })
}
]),
angular.module("myApp.world-rankings", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/world-rankings", {
        templateUrl: "world-rankings/world-rankings.html",
        controller: "WorldRankingsCtrl"
    }),
    e.when("/world-rankings/:param1", {
        templateUrl: "world-rankings/world-rankings.html",
        controller: "WorldRankingsCtrl"
    })
}
]).controller("WorldRankingsCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(r, e, a, o, t) {
    (window.myscope = o).countryNames = countryNames,
    o.modalId = "m" + (new Date).getTime(),
    o.userInfo = {
        aomUsername: "",
        parentEmail: "",
        realName: ""
    },
    setTimeout(function() {
        $(".ui.checkbox").checkbox()
    }, 1e3);
    var s = "2024";
    o.year = s,
    "2022" <= e.param1 && e.param1 < s && (o.year = e.param1),
    setTimeout(function() {
        $("#year").dropdown("set selected", o.year),
        $("#year").dropdown({
            onChange: function(e, a, t) {
                (e === s ? r.path("world-rankings") : r.path("world-rankings/" + e)).replace(),
                o.$$phase || o.$apply()
            }
        }),
        o.$$phase || o.$apply()
    }, 1),
    firebase.database().ref("worldRankings/" + o.year).on("value", function(e) {
        o.worldRankings = e.val(),
        o.ready = !0,
        o.$$phase || o.$apply()
    }),
    o.competitorClick = function(e, a, t) {
        var r, s;
        $(".ui.modal.competitorModal").modal("show"),
        o.competitorData = {
            flag: t,
            id: e,
            name: a
        },
        o.competitorLoading = !0,
        o.$$phase || o.$apply(),
        s = r = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            o.competitorData.ratings = e.val(),
            r = !0,
            s && (o.competitorLoading = !1,
            o.$$phase || o.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            o.competitorData.recentBest = e.val(),
            s = !0,
            r && (o.competitorLoading = !1,
            o.$$phase || o.$apply())
        })
    }
    ,
    o.userId = function() {
        return firebase.auth().currentUser ? firebase.auth().currentUser.uid : ""
    }
    ,
    o.$on("$destroy", function() {
        firebase.database().ref("worldRankings/" + o.year).off(),
        $(".ui.modal.competitorModal." + o.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + o.modalId).remove()
    })
}
]),
angular.module("myApp.world-tour", ["ngRoute"]).config(["$routeProvider", function(e) {
    e.when("/world-tour", {
        templateUrl: "world-tour/world-tour.html",
        controller: "WorldTourCtrl"
    }),
    e.when("/world-tour/:param1", {
        templateUrl: "world-tour/world-tour.html",
        controller: "WorldTourCtrl"
    }),
    e.when("/world-tour/:param1/:param2", {
        templateUrl: "world-tour/world-tour.html",
        controller: "WorldTourCtrl"
    }),
    e.when("/world-tour/:param1/:param2/:param3", {
        templateUrl: "world-tour/world-tour.html",
        controller: "WorldTourCtrl"
    })
}
]).controller("WorldTourCtrl", ["$location", "$routeParams", "$sce", "$scope", "$timeout", function(e, a, t, o, r) {
    (window.myscope = o).countryNames = countryNames,
    o.modalId = "m" + (new Date).getTime(),
    o.userInfo = {
        aomUsername: "",
        parentEmail: "",
        realName: ""
    };
    var s = "season13";
    "register" === a.param1 ? o.register = !0 : ("2021" <= a.param1 && a.param1 <= "2999" && (o.year = a.param1,
    o.tab = a.param2 || "overview",
    "season-scores" === o.tab && (o.season = a.param3 || s)),
    o.tab || ("rules" === a.param1 || "tournaments" === a.param1 || "season-scores" === a.param1 || "points" === a.param1 || "world-rankings" === a.param1 ? (o.tab = a.param1,
    "points" === o.tab && (o.tab = "world-rankings"),
    "season-scores" === o.tab && (o.season = s)) : ("registered" === a.param1 && (window.mlregaeo2022 = !0),
    o.tab = "overview"))),
    o.mlregaeo2022 = window.mlregaeo2022,
    setTimeout(function() {
        $(".ui.checkbox").checkbox()
    }, 1e3),
    "season-scores" === o.tab && firebase.database().ref("seasonScoresLeaderboard/" + o.season).on("value", function(e) {
        o.seasonScoresLeaderboard = e.val(),
        o.ready = !0,
        o.$$phase || o.$apply()
    }),
    "world-rankings" === o.tab && firebase.database().ref("worldRankings").on("value", function(e) {
        o.worldRankings = e.val(),
        o.ready = !0,
        o.$$phase || o.$apply()
    }),
    o.competitorClick = function(e, a, t) {
        var r, s;
        $(".ui.modal.competitorModal").modal("show"),
        o.competitorData = {
            flag: t,
            id: e,
            name: a
        },
        o.competitorLoading = !0,
        o.$$phase || o.$apply(),
        s = r = !1,
        firebase.database().ref("users/" + e + "/ratings").once("value", function(e) {
            o.competitorData.ratings = e.val(),
            r = !0,
            s && (o.competitorLoading = !1,
            o.$$phase || o.$apply())
        }),
        firebase.database().ref("users/" + e + "/recentBest").once("value", function(e) {
            o.competitorData.recentBest = e.val(),
            s = !0,
            r && (o.competitorLoading = !1,
            o.$$phase || o.$apply())
        })
    }
    ,
    o.seasonScoreClick = function(e, a) {
        var t = a.toLowerCase().split(" ")[0];
        e[t + "Level"] && (o.details = {
            eventName: a,
            eventNameLower: t,
            flag: e.flag,
            level1: e[t + "Level1"],
            level2: e[t + "Level2"] || "",
            name: e.name,
            score1: e[t + "Score1"],
            score2: e[t + "Score2"] || "",
            time1: e[t + "Time1"] + "s",
            time2: e[t + "Time2"] ? e[t + "Time2"] + "s" : ""
        },
        $(".ui.modal.seasonScoreDetails").modal("show"))
    }
    ,
    o.userId = function() {
        return firebase.auth().currentUser ? firebase.auth().currentUser.uid : ""
    }
    ,
    o.realNameChanged = function() {
        var e;
        firebase.auth().currentUser && o.userInfo.realName && (e = firebase.auth().currentUser.uid,
        firebase.database().ref("userInfo/" + e).update({
            realName: o.userInfo.realName,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        }))
    }
    ,
    o.aomUsernameChanged = function() {
        var e;
        firebase.auth().currentUser && o.userInfo.aomUsername && (e = firebase.auth().currentUser.uid,
        firebase.database().ref("userInfo/" + e).update({
            aomUsername: o.userInfo.aomUsername,
            timestamp: firebase.database.ServerValue.TIMESTAMP
        }))
    }
    ,
    o.rulesAcceptedClick = function() {
        o.rulesAccepted = !o.rulesAccepted
    }
    ,
    o.availableForPreSlamClick = function() {
        o.availableForPreSlam = !o.availableForPreSlam
    }
    ,
    o.availableForSlamClick = function() {
        o.availableForSlam = !o.availableForSlam
    }
    ,
    o.videoAcceptedClick = function() {
        o.videoAccepted = !o.videoAccepted
    }
    ,
    o.minorSubmit = function() {
        o.minorSubmitting = !0,
        firebase.database().ref("minorRegistration").push({
            parentEmail: o.userInfo.parentEmail,
            realName: o.userInfo.realName,
            timestamp: firebase.database.ServerValue.TIMESTAMP,
            userId: firebase.auth().currentUser ? firebase.auth().currentUser.uid : ""
        }, function() {
            o.minorSubmitting = !1,
            o.minorSubmitted = !0,
            o.$$phase || o.$apply()
        })
    }
    ,
    o.showLevels = function() {
        $(".ui.modal.sslLevels").modal("setting", {
            onApprove: function() {}
        }).modal("show")
    }
    ,
    o.$on("$destroy", function() {
        firebase.database().ref("seasonScoresLeaderboard/" + o.season).off(),
        firebase.database().ref("worldRankings").off(),
        $(".ui.modal.competitorModal." + o.modalId).modal("hide"),
        $(".ui.modal.seasonScoreDetails." + o.modalId).modal("hide"),
        $(".ui.modal.sslLevels." + o.modalId).modal("hide"),
        $(".ui.modal.competitorModal." + o.modalId).remove(),
        $(".ui.modal.seasonScoreDetails." + o.modalId).remove(),
        $(".ui.modal.sslLevels." + o.modalId).remove()
    })
}
]),
angular.module("myApp.version", ["myApp.version.interpolate-filter", "myApp.version.version-directive"]).value("version", "0.1"),
angular.module("myApp.version.version-directive", []).directive("appVersion", ["version", function(r) {
    return function(e, a, t) {
        a.text(r)
    }
}
]),
angular.module("myApp.version.interpolate-filter", []).filter("interpolate", ["version", function(a) {
    return function(e) {
        return String(e).replace(/\%VERSION\%/gm, a)
    }
}
]);
